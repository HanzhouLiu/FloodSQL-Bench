{"id": "L0_0001", "question": "In Harris County, Texas (identified by GEOID starting with 48201), how many NFIP claims have a dateOfLoss on or after 2010-01-01?", "sql": "SELECT COUNT(*) AS num_claims FROM claims WHERE GEOID LIKE '48201%' AND dateOfLoss >= DATE '2010-01-01';", "elapsed": 0.054, "row_count": 1, "result": [[75192]]}
{"id": "L0_0002", "question": "What is the total area of valid FEMA Flood Hazard Zone polygons in Florida (STATEFP = '12') labeled as AE?", "sql": "SELECT SUM(ST_Area(geometry)) AS total_ae_area FROM floodplain WHERE STATEFP='12' AND FLD_ZONE='AE' AND ST_IsValid(geometry);", "elapsed": 2.033, "row_count": 1, "result": [[2.4131283024771886]]}
{"id": "L0_0003", "question": "Return the total number of NFIP claims recorded in Texas (identified by GEOID starting with 48).", "sql": "SELECT COUNT(*) AS num_claims FROM claims WHERE GEOID LIKE '48%';", "elapsed": 0.01, "row_count": 1, "result": [[381244]]}
{"id": "L0_0004", "question": "Return the average non-null insurance payout amount (in USD) for structural building damage among all NFIP claims in Louisiana (identified by GEOID starting with 22).", "sql": "SELECT AVG(CAST(amountPaidOnBuildingClaim AS DOUBLE)) AS avg_building_payout FROM claims WHERE GEOID LIKE '22%' AND amountPaidOnBuildingClaim IS NOT NULL;", "elapsed": 0.018, "row_count": 1, "result": [[43386.06609139753]]}
{"id": "L0_0005", "question": "Return the maximum non-null NFIP Insurance payout amount (in USD) for damage to building contents observed across all claims in Florida (identified by GEOID starting with 12).", "sql": "SELECT MAX(CAST(amountPaidOnContentsClaim AS DOUBLE)) AS max_contents_payout FROM claims WHERE GEOID LIKE '12%' AND amountPaidOnContentsClaim IS NOT NULL;", "elapsed": 0.02, "row_count": 1, "result": [[500000.0]]}
{"id": "L0_0006", "question": "Return the number of NFIP claims in Texas (identified by GEOID starting with 48) with zero insurance payout amount (in USD) for Increased Cost of Compliance (ICC).", "sql": "SELECT COUNT(*) AS num_zero_icc FROM claims WHERE GEOID LIKE '48%' AND amountPaidOnIncreasedCostOfComplianceClaim IS NOT NULL AND CAST(amountPaidOnIncreasedCostOfComplianceClaim AS DOUBLE) = 0;", "elapsed": 0.013, "row_count": 1, "result": [[305496]]}
{"id": "L0_0007", "question": "What is the earliest recorded NFIP claim date in Florida (identified by GEOID starting with 12)?", "sql": "SELECT MIN(dateOfLoss) AS earliest_date FROM claims WHERE GEOID LIKE '12%';", "elapsed": 0.009, "row_count": 1, "result": [["1978-01-01"]]}
{"id": "L0_0008", "question": "What is the total sum of non-null NFIP Insurance payout amount (in USD) for structural building damage across all claims in Louisiana (identified by GEOID starting with 22)?", "sql": "SELECT SUM(CAST(amountPaidOnBuildingClaim AS DOUBLE)) AS total_building FROM claims WHERE GEOID LIKE '22%' AND amountPaidOnBuildingClaim IS NOT NULL;", "elapsed": 0.017, "row_count": 1, "result": [[16361840016.52002]]}
{"id": "L0_0009", "question": "What is the total non-null expected annual loss for buildings caused by riverine flooding in Harris County, TX (identified by GEOID starting with 48201)?", "sql": "SELECT SUM(CAST(RFLD_EALB AS DOUBLE)) AS total_riverine_loss FROM nri WHERE GEOID LIKE '48201%' AND RFLD_EALB IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[648371644.6639426]]}
{"id": "L0_0010", "question": "List the top 5 census tracts in Louisiana (identified by GEOID starting with 22) with the largest CRE modeling population. Return their GEOIDs.", "sql": "SELECT GEOID FROM cre WHERE GEOID LIKE '22%' AND POPUNI IS NOT NULL ORDER BY CAST(POPUNI AS DOUBLE) DESC LIMIT 5;", "elapsed": 0.063, "row_count": 5, "result": [["22019001700"], ["22103040309"], ["22015011122"], ["22063040812"], ["22105954601"]]}
{"id": "L0_0011", "question": "Return the total area of FEMA floodplain polygons labeled as AE in Florida (STATEFP = '12').", "sql": "SELECT SUM(ST_Area(geometry)) AS total_ae_area FROM floodplain WHERE STATEFP = '12' AND FLD_ZONE = 'AE' AND ST_IsValid(geometry);", "elapsed": 1.804, "row_count": 1, "result": [[2.4131283024771886]]}
{"id": "L0_0012", "question": "What is the largest FEMA topologically valid floodplain polygon area in Louisiana (identified by STATEFP 22)?", "sql": "SELECT MAX(ST_Area(geometry)) AS max_area FROM floodplain WHERE STATEFP = '22' AND ST_IsValid(geometry);", "elapsed": 5.534, "row_count": 1, "result": [[0.3991437929961159]]}
{"id": "L0_0013", "question": "Which county in Louisiana (STATEFP = '22') has the largest number of census tracts? Return its COUNTYFP.", "sql": "SELECT COUNTYFP FROM census_tracts WHERE STATEFP='22' GROUP BY COUNTYFP ORDER BY COUNT(*) DESC LIMIT 1;", "elapsed": 1.419, "row_count": 1, "result": [["071"]]}
{"id": "L0_0014", "question": "Return the average area of topologically valid census tracts in Leon County, FL (identified by COUNTYFP = '073' and STATEFP = '12').", "sql": "SELECT AVG(ST_Area(geometry)) AS avg_area FROM census_tracts WHERE STATEFP = '12' AND COUNTYFP = '073' AND ST_IsValid(geometry);", "elapsed": 0.084, "row_count": 1, "result": [[0.002160875154886079]]}
{"id": "L0_0015", "question": "Return the fraction (0-1) of Texas census tracts (identified by GEOID starting with 48) where the non-null estimated percent of population with no Internet access is greater than 20%.", "sql": "SELECT SUM(CASE WHEN EP_NOINT > 20 THEN 1 ELSE 0 END) * 1.0 / COUNT(*) AS frac_high_no_internet FROM svi WHERE GEOID LIKE '48%' AND EP_NOINT IS NOT NULL;", "elapsed": 0.193, "row_count": 1, "result": [[0.22080185938407904]]}
{"id": "L0_0016", "question": "What is the average non-null percentage with three plus components of social vulnerability all tracts in Texas (identified by GEOID starting with 48)?", "sql": "SELECT AVG(PRED3_PE) AS avg_pred3_pe FROM cre WHERE GEOID LIKE '48%' AND PRED3_PE IS NOT NULL;", "elapsed": 0.006, "row_count": 1, "result": [[22.813239559164746]]}
{"id": "L0_0017", "question": "Return the maximum non-null estimated number of individuals with one or two components of social vulnerability in Florida (identified by GEOID starting with 12).", "sql": "SELECT MAX(CAST(PRED12_E AS DOUBLE)) AS max_pred12_e FROM cre WHERE GEOID LIKE '12%' AND PRED12_E IS NOT NULL;", "elapsed": 0.002, "row_count": 1, "result": [[11560.0]]}
{"id": "L0_0018", "question": "What percentage of census tracts composed completely of water in Monroe County, Florida (identified by GEOID starting with 12087)?", "sql": "SELECT 100.0 * SUM(CASE WHEN WATER_TRACT = 1 THEN 1 ELSE 0 END) / COUNT(*) AS pct_with_water FROM cre WHERE LEFT(GEOID, 5) = '12087';", "elapsed": 0.133, "row_count": 1, "result": [[3.4482758620689653]]}
{"id": "L0_0019", "question": "Return the average non-null annual frequency of riverine flood events in Texas (identified by GEOID starting with 48).", "sql": "SELECT AVG(RFLD_AFREQ) AS avg_flood_frequency FROM nri WHERE GEOID LIKE '48%' AND RFLD_AFREQ IS NOT NULL;", "elapsed": 0.06, "row_count": 1, "result": [[3.0601375369266424]]}
{"id": "L0_0020", "question": "List the top 3 most frequent riverine flood risk rating categories in Louisiana (identified by GEOID starting with 22).", "sql": "SELECT RFLD_RISKR FROM nri WHERE GEOID LIKE '22%' GROUP BY RFLD_RISKR ORDER BY COUNT(*) DESC LIMIT 3;", "elapsed": 0.007, "row_count": 3, "result": [["Relatively Moderate"], ["Relatively High"], ["Relatively Low"]]}
{"id": "L0_0021", "question": "What is the total non-null estimated number of households in Florida (identified by GEOID starting with '12')?", "sql": "SELECT SUM(CAST(E_HH AS DOUBLE)) AS total_households FROM svi WHERE CAST(FIPS AS VARCHAR) LIKE '12%' AND E_HH IS NOT NULL;", "elapsed": 0.05, "row_count": 1, "result": [[8353441.0]]}
{"id": "L0_0022", "question": "Return the maximum non-null estimated total population count in Louisiana (identified by GEOID starting with 22) according to the SVI table.", "sql": "SELECT MAX(CAST(E_TOTPOP AS DOUBLE)) AS max_pop FROM svi WHERE GEOID LIKE '22%' AND E_TOTPOP IS NOT NULL;", "elapsed": 0.003, "row_count": 1, "result": [[11689.0]]}
{"id": "L0_0023", "question": "What is the number of records in the SVI dataset for Texas (identified by GEOID starting with 48)?", "sql": "SELECT COUNT(*) AS num_records FROM svi WHERE GEOID LIKE '48%';", "elapsed": 0.003, "row_count": 1, "result": [[6884]]}
{"id": "L0_0024", "question": "Return the number of ZCTAs in Louisiana (identified by STATEFP 22).", "sql": "SELECT COUNT(*) AS num_zctas FROM zcta WHERE STATEFP = '22';", "elapsed": 0.048, "row_count": 1, "result": [[1819]]}
{"id": "L0_0025", "question": "How many ZCTAs in Texas (STATEFP = '48') have a geometry area greater than 0.5?", "sql": "SELECT COUNT(*) AS num_large_zctas FROM zcta WHERE STATEFP = '48' AND ST_Area(geometry) > 0.5 AND ST_IsValid(geometry);", "elapsed": 0.116, "row_count": 1, "result": [[4]]}
{"id": "L0_0026", "question": "Return the average area of topologically valid ZCTAs in Florida (identified by STATEFP 12).", "sql": "SELECT AVG(ST_Area(geometry)) AS avg_area FROM zcta WHERE STATEFP = '12' AND ST_IsValid(geometry);", "elapsed": 0.06, "row_count": 1, "result": [[0.013502219027391179]]}
{"id": "L0_0027", "question": "What is the average non-null expected annual loss for population due to coastal flooding in Galveston County, TX (identified by GEOID starting with 48167)?", "sql": "SELECT AVG(CAST(CFLD_EALP AS DOUBLE)) AS avg_cfld_ealp FROM nri WHERE GEOID LIKE '48167%' AND CFLD_EALP IS NOT NULL;", "elapsed": 0.003, "row_count": 1, "result": [[0.00011290147991909902]]}
{"id": "L0_0028", "question": "How many hospitals are located west of longitude -92.0 in Louisiana (identified by STATEFP = '22')?", "sql": "SELECT COUNT(*) AS num_hospitals_west FROM hospitals WHERE STATEFP = '22' AND LON < -92.0 AND LON IS NOT NULL;", "elapsed": 0.011, "row_count": 1, "result": [[133]]}
{"id": "L0_0029", "question": "How many schools with valid latitude in Florida (identified by STATEFP = '12') are located south of latitude 27.5?", "sql": "SELECT COUNT(*) AS num_schools_south FROM schools WHERE STATEFP = '12' AND LAT < 27.5 AND LAT IS NOT NULL;", "elapsed": 0.008, "row_count": 1, "result": [[2768]]}
{"id": "L0_0030", "question": "What is the westernmost longitude of schools in Texas (identified by STATEFP = '48')?", "sql": "SELECT MIN(LON) AS min_lon FROM schools WHERE STATEFP = '48' AND LON IS NOT NULL;", "elapsed": 0.002, "row_count": 1, "result": [[-106.62416140199996]]}
{"id": "L0_0031", "question": "How many counties in Florida with valid geometry (STATEFP = '12') have their entire geometry west of longitude -82?", "sql": "SELECT COUNT(*) AS num_west_counties FROM county WHERE STATEFP = '12' AND ST_XMax(geometry) < -82 AND ST_IsValid(geometry);", "elapsed": 0.114, "row_count": 1, "result": [[36]]}
{"id": "L0_0032", "question": "Return the average land area of topologically valid counties in Texas (identified by STATEFP 48).", "sql": "SELECT AVG(ST_Area(geometry)) AS avg_area FROM county WHERE STATEFP = '48' AND ST_IsValid(geometry);", "elapsed": 0.061, "row_count": 1, "result": [[0.2600587858137559]]}
{"id": "L0_0033", "question": "How many distinct cities have hospitals recorded in Louisiana (STATEFP = '22')?", "sql": "SELECT COUNT(DISTINCT CITY) AS num_cities FROM hospitals WHERE STATEFP='22' AND CITY IS NOT NULL;", "elapsed": 0.005, "row_count": 1, "result": [[99]]}
{"id": "L0_0034", "question": "What is the average population universe for all tracts in Louisiana (identified by GEOID starting with '22')?", "sql": "SELECT AVG(POPUNI) AS average_popuni FROM cre WHERE GEOID LIKE '22%';", "elapsed": 0.002, "row_count": 1, "result": [[3234.023054755043]]}
{"id": "L0_0035", "question": "Return the number of NFIP claims filed before 1990 in Texas (identified by GEOID starting with 48).", "sql": "SELECT COUNT(*) AS num_old_claims FROM claims WHERE GEOID LIKE '48%' AND dateOfLoss < DATE '1990-01-01';", "elapsed": 0.139, "row_count": 1, "result": [[73533]]}
{"id": "L0_0036", "question": "What is the total number of unique FEMA Flood Hazard Zone codes in the floodplain table (any type of labels is accepted even if it is invalid or X)?", "sql": "SELECT COUNT(DISTINCT FLD_ZONE) AS num_zones FROM floodplain;", "elapsed": 0.006, "row_count": 1, "result": [[10]]}
{"id": "L0_0037", "question": "What percentage of Texas census tracts (GEOID starting with '48') are composed completely of water?", "sql": "SELECT 100.0 * COUNT(DISTINCT CASE WHEN WATER_TRACT = 1 THEN GEOID END) / COUNT(DISTINCT GEOID) AS pct_with_water FROM cre WHERE GEOID LIKE '48%';", "elapsed": 0.004, "row_count": 1, "result": [[0.18851508120649652]]}
{"id": "L0_0038", "question": "What is the northernmost latitude (maximum LAT) of hospitals in Florida (identified by STATEFP = '12')?", "sql": "SELECT MAX(LAT) AS max_lat FROM hospitals WHERE STATEFP = '12' AND LAT IS NOT NULL;", "elapsed": 0.002, "row_count": 1, "result": [[30.970393840000042]]}
{"id": "L0_0039", "question": "Return the average ratio of non-null building payout to contents payout for NFIP claims in Louisiana (GEOID starting with 22). Only include records where contents payout is positive.", "sql": "SELECT AVG(CAST(amountPaidOnBuildingClaim AS DOUBLE) / CAST(amountPaidOnContentsClaim AS DOUBLE)) AS avg_ratio FROM claims WHERE GEOID LIKE '22%' AND amountPaidOnBuildingClaim IS NOT NULL AND amountPaidOnContentsClaim IS NOT NULL AND CAST(amountPaidOnContentsClaim AS DOUBLE) > 0;", "elapsed": 0.181, "row_count": 1, "result": [[6.982129213458387]]}
{"id": "L0_0040", "question": "Which census tract in Louisiana (STATEFP = '22') has the smallest geometry area? Return its 11-digit GEOID", "sql": "SELECT GEOID FROM census_tracts WHERE STATEFP = '22' ORDER BY ST_Area(geometry) ASC LIMIT 1;", "elapsed": 0.143, "row_count": 1, "result": [["22071001600"]]}
{"id": "L0_0041", "question": "Return the average area of topologically valid census tracts across all the three states in the tract table.", "sql": "SELECT AVG(ST_Area(geometry)) AS avg_area FROM census_tracts WHERE ST_IsValid(geometry);", "elapsed": 0.214, "row_count": 1, "result": [[0.007133059974340702]]}
{"id": "L0_0042", "question": "What is the average non-null estimated total population for Texas (GEOID starting with 48) across SVI tracts for each state?", "sql": "SELECT AVG(CAST(E_TOTPOP AS DOUBLE)) AS avg_pop FROM svi WHERE GEOID LIKE '48%' AND E_TOTPOP IS NOT NULL;", "elapsed": 0.004, "row_count": 1, "result": [[4248.015979081929]]}
{"id": "L0_0043", "question": "Return the total area of all topologically valid floodplain polygons in Texas (identified by STATEFP 48).", "sql": "SELECT SUM(ST_Area(geometry)) AS total_area FROM floodplain WHERE STATEFP = '48' AND ST_IsValid(geometry);", "elapsed": 2.66, "row_count": 1, "result": [[30.507730887912004]]}
{"id": "L0_0044", "question": "What is the number of schools with missing (null) coordinates in Louisiana (identified by STATEFP 22)?", "sql": "SELECT COUNT(*) AS num_missing FROM schools WHERE STATEFP = '22' AND (LAT IS NULL OR LON IS NULL);", "elapsed": 0.006, "row_count": 1, "result": [[0]]}
{"id": "L0_0045", "question": "What is the average non-null coastal flood risk score in Florida (identified by GEOID starting with 12)?", "sql": "SELECT AVG(CFLD_RISKS) AS avg_coastal_risk FROM nri WHERE GEOID LIKE '12%' AND CFLD_RISKS IS NOT NULL;", "elapsed": 0.02, "row_count": 1, "result": [[46.48883877774816]]}
{"id": "L0_0046", "question": "Which state (identified by STATEFP) contains the largest number of topologically valid FEMA floodplain polygons overall? Return its STATEFP code.", "sql": "SELECT STATEFP FROM floodplain WHERE ST_IsValid(geometry) GROUP BY STATEFP ORDER BY COUNT(*) DESC LIMIT 1;", "elapsed": 3.129, "row_count": 1, "result": [["12"]]}
{"id": "L0_0047", "question": "How many NFIP claims in Louisiana (identified by GEOID starting with 22) with missing dateOfLoss values?", "sql": "SELECT COUNT(*) AS num_missing_date FROM claims WHERE GEOID LIKE '22%' AND dateOfLoss IS NULL;", "elapsed": 0.088, "row_count": 1, "result": [[0]]}
{"id": "L0_0048", "question": "Return the average non-null percentage of individuals with one or two components of social vulnerability across all tracts in Florida (identified by GEOID starting with 12).", "sql": "SELECT AVG(PRED12_PE) AS avg_pred12_pe FROM cre WHERE GEOID LIKE '12%' AND PRED12_PE IS NOT NULL;", "elapsed": 0.041, "row_count": 1, "result": [[46.18204069767448]]}
{"id": "L0_0049", "question": "Which city across all states has the largest number of colleges recorded in the schools table? Return its city name in uppercase.", "sql": "SELECT CITY FROM schools WHERE TYPE = 'COLLEGE' GROUP BY CITY ORDER BY COUNT(*) DESC LIMIT 1;", "elapsed": 0.017, "row_count": 1, "result": [["HOUSTON"]]}
{"id": "L0_0050", "question": "What is the average non-null NFIP building payout across all claims in all three states?", "sql": "SELECT AVG(CAST(amountPaidOnBuildingClaim AS DOUBLE)) AS avg_payout FROM claims WHERE amountPaidOnBuildingClaim IS NOT NULL;", "elapsed": 0.258, "row_count": 1, "result": [[44330.971228179544]]}
{"id": "L1_0001", "question": "Which non-null year had the highest total number of NFIP flood claims in Louisiana (STATEFP 22), based on a key-based join between claims and county tables? Return the year.", "sql": "SELECT STRFTIME('%Y', cl.dateOfLoss) AS year FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND cl.dateOfLoss IS NOT NULL GROUP BY year ORDER BY COUNT(*) DESC LIMIT 1;", "elapsed": 0.112, "row_count": 1, "result": [["2005"]]}
{"id": "L1_0002", "question": "Return the average non-null Normalized coastal flood risk score among unique Texas tracts (STATEFP 48) that have NFIP claims after 2000-01-01 and non-null NRI risk scores.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '48' AND dateOfLoss >= DATE '2000-01-01') SELECT AVG(n.CFLD_RISKS) AS avg_coastal_risk FROM claim_tracts t JOIN nri n ON t.GEOID = n.GEOID WHERE n.CFLD_RISKS IS NOT NULL;", "elapsed": 0.019, "row_count": 1, "result": [[32.19418255613956]]}
{"id": "L1_0003", "question": "How many non-null ZIP codes in Florida (STATEFP 12) contain both at least one school and one hospital?", "sql": "SELECT COUNT(DISTINCT s.ZIP) AS num_zip_with_both FROM schools s JOIN hospitals h ON s.ZIP = h.ZIP WHERE s.STATEFP = '12' AND h.STATEFP = '12' AND s.ZIP IS NOT NULL;", "elapsed": 0.006, "row_count": 1, "result": [[269]]}
{"id": "L1_0004", "question": "Which 3 Texas counties (STATEFP 48) have the highest non-null percentage of individuals with zero vulnerability components?", "sql": "SELECT c.NAME AS county_name FROM cre cr JOIN county c ON LEFT(cr.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' AND cr.PRED0_PE IS NOT NULL GROUP BY c.NAME ORDER BY AVG(cr.PRED0_PE) DESC LIMIT 3;", "elapsed": 0.006, "row_count": 3, "result": [["Kent"], ["Sterling"], ["Hartley"]]}
{"id": "L1_0005", "question": "In East Baton Rouge Parish, LA (GEOID prefix 22033), how many NFIP claims occurred in tracts where at least 20% of the population lacks a high-school diploma (non-null value)?", "sql": "SELECT COUNT(*) AS num_claims FROM claims cl JOIN svi s ON cl.GEOID = s.GEOID WHERE cl.GEOID LIKE '22033%' AND s.EP_NOHSDP IS NOT NULL AND s.EP_NOHSDP >= 20;", "elapsed": 0.009, "row_count": 1, "result": [[1610]]}
{"id": "L1_0006", "question": "Which Louisiana census tract (STATEFP 22) has the highest average non-null expected annual loss for buildings from riverine flooding according to NRI data? Return its 11-digit GEOID.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN nri n ON t.GEOID = n.GEOID WHERE t.STATEFP = '22' AND n.RFLD_EALB IS NOT NULL GROUP BY t.GEOID ORDER BY AVG(n.RFLD_EALB) DESC LIMIT 1;", "elapsed": 0.078, "row_count": 1, "result": [["22033004021"]]}
{"id": "L1_0007", "question": "List the top 3 riverine flood risk rating categories in Hidalgo County, Texas (GEOID prefix 48215), ranked by total non-null expected annual population loss (USD).", "sql": "SELECT n.RFLD_RISKR FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.GEOID = '48215' AND n.RFLD_EALP IS NOT NULL GROUP BY n.RFLD_RISKR ORDER BY SUM(n.RFLD_EALP) DESC LIMIT 3;", "elapsed": 0.021, "row_count": 3, "result": [["Relatively High"], ["Relatively Moderate"], ["Relatively Low"]]}
{"id": "L1_0008", "question": "Return the 2nd highest Louisiana county (STATEFP 22) ranked by total non-null payout amount (USD) for building structure damage.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND cl.amountPaidOnBuildingClaim IS NOT NULL GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 1 OFFSET 1;", "elapsed": 0.032, "row_count": 1, "result": [["Jefferson"]]}
{"id": "L1_0009", "question": "Return the average non-null percentage of individuals with zero components of social vulnerability in Florida (STATEFP 12) census tracts that have NFIP claims since 2020-01-01.", "sql": "SELECT AVG(cr.PRED0_PE) AS avg_resilience FROM cre cr JOIN claims cl ON cr.GEOID = cl.GEOID WHERE cl.STATEFP = '12' AND cl.dateOfLoss >= DATE '2020-01-01' AND cr.PRED0_PE IS NOT NULL;", "elapsed": 0.015, "row_count": 1, "result": [[27.916328723332295]]}
{"id": "L1_0010", "question": "List the top 2 Florida census tracts (STATEFP 12) with the highest non-null normalized coastal flood risk scores based on NRI data. Return their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN nri n ON t.GEOID = n.GEOID WHERE t.STATEFP = '12' AND n.CFLD_RISKS IS NOT NULL ORDER BY n.CFLD_RISKS DESC LIMIT 2;", "elapsed": 0.012, "row_count": 2, "result": [["12109020708"], ["12029970201"]]}
{"id": "L1_0011", "question": "In Jefferson Parish, LA (GEOID prefix 22051), how many NFIP claims occurred in tracts where at least 15% of the population is without health insurance?", "sql": "SELECT COUNT(*) AS num_claims FROM claims cl JOIN svi s ON cl.GEOID = s.GEOID WHERE cl.GEOID LIKE '22051%' AND s.EP_UNINSUR >= 15;", "elapsed": 0.012, "row_count": 1, "result": [[19188]]}
{"id": "L1_0012", "question": "Which ZIP code in Texas (STATEFP 48) contains the largest number of schools and hospitals combined? Return the 5-digit ZIP code.", "sql": "SELECT s.ZIP AS zip_code FROM schools s JOIN hospitals h ON s.ZIP = h.ZIP WHERE s.STATEFP = '48' AND h.STATEFP = '48' GROUP BY s.ZIP ORDER BY (COUNT(DISTINCT s.SCHOOL_ID) + COUNT(DISTINCT h.HOSPITAL_ID)) DESC LIMIT 1;", "elapsed": 0.051, "row_count": 1, "result": [["78539"]]}
{"id": "L1_0013", "question": "Return the Louisiana county (STATEFP 22) with the highest number of 'CRITICAL ACCESS' hospitals.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID WHERE h.STATEFP = '22' AND h.TYPE = 'CRITICAL ACCESS' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 1;", "elapsed": 0.004, "row_count": 1, "result": [["Concordia"]]}
{"id": "L1_0014", "question": "In Florida (STATEFP 12), what is the average non-null expected exposure value of buildings to coastal flooding among tracts that have NFIP claims?", "sql": "SELECT AVG(n.CFLD_EXPB) AS avg_building_exposure FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID WHERE cl.STATEFP = '12' AND n.CFLD_EXPB IS NOT NULL;", "elapsed": 0.019, "row_count": 1, "result": [[530198604.3821732]]}
{"id": "L1_0015", "question": "List the top 4 most common coastal flood risk rating categories in St. Bernard Parish, LA (GEOID prefix 22087), ranked by the number of NFIP claims.", "sql": "SELECT n.CFLD_RISKR FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID WHERE cl.GEOID LIKE '22087%' GROUP BY n.CFLD_RISKR ORDER BY COUNT(*) DESC LIMIT 4;", "elapsed": 0.01, "row_count": 2, "result": [["Relatively Low"], ["Relatively High"]]}
{"id": "L1_0016", "question": "What is the average of county-level ratios of water-only census tracts across Florida (STATEFP 12)?", "sql": "SELECT AVG(water_ratio) AS avg_water_tract_ratio FROM (SELECT c.NAME, AVG(CASE WHEN cr.WATER_TRACT = 1 THEN 1 ELSE 0 END) AS water_ratio FROM cre cr JOIN county c ON LEFT(cr.GEOID, 5) = c.GEOID WHERE c.STATEFP = '12' GROUP BY c.NAME);", "elapsed": 0.011, "row_count": 1, "result": [[0.030183211258131823]]}
{"id": "L1_0017", "question": "Which 3 Louisiana counties (STATEFP 22) have the highest total non-null NFIP claim payouts for buildings? Return their county names.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND cl.amountPaidOnBuildingClaim IS NOT NULL GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 3;", "elapsed": 0.032, "row_count": 3, "result": [["Orleans"], ["Jefferson"], ["St. Bernard"]]}
{"id": "L1_0018", "question": "In Texas (STATEFP 48), which ZIP code area has the highest combined number of schools and hospitals? Return the ZIP code.", "sql": "SELECT s.ZIP AS zip_code FROM schools s JOIN hospitals h ON s.ZIP = h.ZIP WHERE s.STATEFP = '48' AND h.STATEFP = '48' GROUP BY s.ZIP ORDER BY (COUNT(DISTINCT s.SCHOOL_ID) + COUNT(DISTINCT h.HOSPITAL_ID)) DESC LIMIT 1;", "elapsed": 0.01, "row_count": 1, "result": [["78539"]]}
{"id": "L1_0019", "question": "In Florida (STATEFP 12), how many hospitals are located in ZIP codes starting with '33'?", "sql": "SELECT COUNT(DISTINCT h.HOSPITAL_ID) AS num_hospitals FROM hospitals h JOIN county c ON LEFT(h.COUNTYFIPS, 5) = c.GEOID WHERE c.STATEFP = '12' AND h.ZIP LIKE '33%';", "elapsed": 0.004, "row_count": 1, "result": [[161]]}
{"id": "L1_0020", "question": "Which 3 Louisiana counties (STATEFP 22) contain the highest number of hospitals? Return their names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON LEFT(h.COUNTYFIPS, 5) = c.GEOID WHERE c.STATEFP = '22' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 3;", "elapsed": 0.004, "row_count": 3, "result": [["East Baton Rouge"], ["Lafayette"], ["Caddo"]]}
{"id": "L1_0021", "question": "Which Louisiana county (STATEFP 22) contains the largest number of census tracts? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM county c JOIN census_tracts t ON LEFT(t.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' GROUP BY c.NAME ORDER BY COUNT(DISTINCT t.GEOID) DESC LIMIT 1;", "elapsed": 0.006, "row_count": 1, "result": [["Orleans"]]}
{"id": "L1_0022", "question": "Which Louisiana county (STATEFP 22) has the largest resilience gap, difference between non-null percentage of individuals with zero components of social vulnerability and non-null percentage of individuals with three plus components of social vulnerability? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM cre cr JOIN county c ON LEFT(cr.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND cr.PRED0_PE IS NOT NULL AND cr.PRED3_PE IS NOT NULL GROUP BY c.NAME ORDER BY AVG(cr.PRED0_PE - cr.PRED3_PE) DESC LIMIT 1;", "elapsed": 0.009, "row_count": 1, "result": [["West Baton Rouge"]]}
{"id": "L1_0023", "question": "Which Louisiana county (STATEFP 22) had the largest number of NFIP flood claims in 2003? Return the county name.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND cl.dateOfLoss >= DATE '2003-01-01' AND cl.dateOfLoss < DATE '2004-01-01' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 1;", "elapsed": 0.01, "row_count": 1, "result": [["Orleans"]]}
{"id": "L1_0024", "question": "Which 3 Texas counties (STATEFP 48) have the largest number of hospitals? Return their county names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON LEFT(h.COUNTYFIPS, 5) = c.GEOID WHERE c.STATEFP = '48' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 3;", "elapsed": 0.003, "row_count": 3, "result": [["Harris"], ["Tarrant"], ["Bexar"]]}
{"id": "L1_0025", "question": "Return the Louisiana county name (STATEFP 22) with the highest average non-null percentage of individuals with one to two components of social vulnerability.", "sql": "SELECT c.NAME AS county_name FROM cre cr JOIN county c ON LEFT(cr.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND cr.PRED12_PE IS NOT NULL GROUP BY c.NAME ORDER BY AVG(cr.PRED12_PE) DESC LIMIT 1;", "elapsed": 0.006, "row_count": 1, "result": [["West Feliciana"]]}
{"id": "L1_0026", "question": "In Texas (STATEFP 48), which ZIP code area has the highest proportion of COLLEGE-type schools relative to total schools and hospitals combined? Return the ZIP code.", "sql": "SELECT s.ZIP AS zip_code FROM schools s JOIN hospitals h ON s.ZIP = h.ZIP WHERE s.STATEFP = '48' AND h.STATEFP = '48' GROUP BY s.ZIP HAVING COUNT(DISTINCT s.SCHOOL_ID) > 0 ORDER BY (SUM(CASE WHEN s.TYPE = 'COLLEGE' THEN 1 ELSE 0 END) * 1.0 / (COUNT(DISTINCT s.SCHOOL_ID) + COUNT(DISTINCT h.HOSPITAL_ID))) DESC LIMIT 1;", "elapsed": 0.077, "row_count": 1, "result": [["78229"]]}
{"id": "L1_0027", "question": "Which Louisiana county (STATEFP 22) has the highest average unemployment? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM svi s JOIN county c ON LEFT(s.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND s.E_UNEMP IS NOT NULL GROUP BY c.NAME ORDER BY AVG(s.E_UNEMP) DESC LIMIT 1;", "elapsed": 0.006, "row_count": 1, "result": [["St. Helena"]]}
{"id": "L1_0028", "question": "Which 3 Florida counties (STATEFP 12) have the highest average non-null riverine flood risk score?", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.STATEFP = '12' AND n.RFLD_RISKS IS NOT NULL GROUP BY c.NAME ORDER BY AVG(n.RFLD_RISKS) DESC LIMIT 3;", "elapsed": 0.005, "row_count": 3, "result": [["Calhoun"], ["Lafayette"], ["Dixie"]]}
{"id": "L1_0029", "question": "Which 5 Texas counties (STATEFP 48) have the highest average non-null estimated population below 150% of the poverty line?", "sql": "SELECT c.NAME AS county_name FROM svi s JOIN county c ON LEFT(s.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' AND s.E_POV150 IS NOT NULL GROUP BY c.NAME ORDER BY AVG(s.E_POV150) DESC LIMIT 5;", "elapsed": 0.006, "row_count": 5, "result": [["Starr"], ["Dimmit"], ["Hidalgo"], ["Maverick"], ["Walker"]]}
{"id": "L1_0030", "question": "Which Florida county (STATEFP 12) has the highest average non-null building exposure to coastal flooding?", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.STATEFP = '12' AND n.CFLD_EXPB IS NOT NULL GROUP BY c.NAME ORDER BY AVG(n.CFLD_EXPB) DESC LIMIT 1;", "elapsed": 0.005, "row_count": 1, "result": [["Monroe"]]}
{"id": "L1_0031", "question": "Average coastal flood risk score among tracts with claims in Texas (identified by STATEFP 48) after 2010-01-01.", "sql": "SELECT AVG(n.CFLD_RISKS) AS avg_coastal_risk FROM nri n JOIN (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '48' AND dateOfLoss >= DATE '2010-01-01') cl ON n.GEOID = cl.GEOID WHERE n.CFLD_RISKS IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[32.45436831840361]]}
{"id": "L1_0032", "question": "Top 2 Florida census tracts (identified by STATEFP 12) with the highest non-null estimated number of households with high housing cost burden. List their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN svi s ON t.GEOID = s.GEOID WHERE t.STATEFP = '12' AND s.E_HBURD IS NOT NULL ORDER BY s.E_HBURD DESC LIMIT 2;", "elapsed": 0.005, "row_count": 2, "result": [["12095017022"], ["12011110354"]]}
{"id": "L1_0033", "question": "Average percentage of individuals with zero components of social vulnerability in Louisiana tracts (identified by STATEFP 22) with claims since 2017-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '22' AND dateOfLoss >= DATE '2017-01-01') SELECT AVG(cr.PRED0_PE) AS avg_resilience FROM cre cr JOIN claim_tracts t ON cr.GEOID = t.GEOID;", "elapsed": 0.012, "row_count": 1, "result": [[31.270158870255955]]}
{"id": "L1_0034", "question": "How many Louisiana census tracts (identified by GEOID starting with 22) with NFIP claims have an estimated number of households with high housing cost burden greater than 1000?", "sql": "SELECT COUNT(*) AS num_high_housing_burden FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '22%') cl ON s.GEOID = cl.GEOID WHERE s.E_HBURD > 1000;", "elapsed": 0.01, "row_count": 1, "result": [[16]]}
{"id": "L1_0035", "question": "Average non-null coastal flood expected annual population loss among tracts with claims in Florida (identified by STATEFP 12) after 2005-01-01.", "sql": "SELECT AVG(CAST(n.CFLD_EALP AS DOUBLE)) AS avg_eal_population FROM nri n JOIN (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='12' AND dateOfLoss >= DATE '2005-01-01') cl ON n.GEOID = cl.GEOID WHERE n.CFLD_EALP IS NOT NULL;", "elapsed": 0.014, "row_count": 1, "result": [[0.00012642065015815664]]}
{"id": "L1_0036", "question": "Top 3 Florida counties (identified by STATEFP 12) with the highest non-null payout amount for building structure damage. List their county names.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '12' AND cl.amountPaidOnBuildingClaim IS NOT NULL GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 3;", "elapsed": 0.029, "row_count": 3, "result": [["Lee"], ["Pinellas"], ["Collier"]]}
{"id": "L1_0037", "question": "Which Texas county (identified by STATEFP = '48') has the highest average difference between non-null percentage of individuals with one-two components of social vulnerability and non-null percentage of individuals with zero components of social vulnerability among its tracts, based on CRE records? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM cre r JOIN county c ON LEFT(r.GEOID,5)=c.GEOID WHERE c.STATEFP='48' AND r.PRED12_PE IS NOT NULL AND r.PRED0_PE IS NOT NULL GROUP BY c.NAME ORDER BY AVG(r.PRED12_PE - r.PRED0_PE) DESC LIMIT 1;", "elapsed": 0.005, "row_count": 1, "result": [["Lipscomb"]]}
{"id": "L1_0038", "question": "Between Texas (STATEFP = '48') and Louisiana (STATEFP = '22'), which state shows a higher average production of non-null estimated percent without health insurance and coastal flood risk score? Return its 2-digit STATEFP code.", "sql": "SELECT LEFT(s.GEOID, 2) AS STATEFP FROM svi s JOIN nri n ON s.GEOID = n.GEOID WHERE LEFT(s.GEOID, 2) IN ('48','22') AND s.EP_UNINSUR IS NOT NULL AND n.CFLD_RISKS IS NOT NULL GROUP BY LEFT(s.GEOID, 2) ORDER BY AVG(s.EP_UNINSUR * n.CFLD_RISKS) DESC LIMIT 1;", "elapsed": 0.009, "row_count": 1, "result": [["48"]]}
{"id": "L1_0039", "question": "Average non-null percentage of population aged 65 and older in Lee, FL (identified by GEOID starting with 12071) tracts with claims.", "sql": "SELECT AVG(s.EP_AGE65) AS avg_elderly_pct FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '12071%') cl ON s.GEOID = cl.GEOID WHERE s.EP_AGE65 IS NOT NULL;", "elapsed": 0.008, "row_count": 1, "result": [[34.92562814070352]]}
{"id": "L1_0040", "question": "Average non-null percentage of population aged 65 and older in Florida tracts (identified by STATEFP 12) with NFIP claims since 2022-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '12' AND dateOfLoss >= DATE '2022-01-01') SELECT AVG(s.EP_AGE65) AS avg_elderly_pct FROM svi s JOIN claim_tracts t ON s.GEOID = t.GEOID WHERE s.EP_AGE65 IS NOT NULL;", "elapsed": 0.011, "row_count": 1, "result": [[24.16898305084746]]}
{"id": "L1_0041", "question": "Lowest riverine flood risk rating category in Dallas County, TX (identified by GEOID starting with 48113), ranked by total NFIP claims.", "sql": "SELECT n.RFLD_RISKR FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID WHERE cl.GEOID LIKE '48113%' GROUP BY n.RFLD_RISKR ORDER BY COUNT(*) ASC LIMIT 1;", "elapsed": 0.008, "row_count": 1, "result": [["Relatively High"]]}
{"id": "L1_0042", "question": "In Hidalgo, TX (identified by GEOID starting with 48215), how many NFIP claims occurred in tracts with NRI riverine risk rating 'Very High'?", "sql": "SELECT COUNT(*) AS num_claims FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID WHERE cl.GEOID LIKE '48215%' AND n.RFLD_RISKR = 'Very High';", "elapsed": 0.007, "row_count": 1, "result": [[0]]}
{"id": "L1_0043", "question": "Average non-null percentage of population without health insurance in Florida (identified by GEOID starting with 12) tracts with claims since 2005-01-01.", "sql": "SELECT AVG(s.EP_UNINSUR) AS avg_uninsured_pct FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '12%' AND dateOfLoss >= DATE '2005-01-01') cl ON s.GEOID = cl.GEOID WHERE s.EP_UNINSUR IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[11.639308548425289]]}
{"id": "L1_0044", "question": "Average non-null estimated number of single-parent households among Louisiana tracts (identified by STATEFP 22) with NFIP claims since 2005-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='22' AND dateOfLoss >= DATE '2005-01-01') SELECT AVG(s.E_SNGPNT) AS avg_single_parent FROM svi s JOIN claim_tracts t ON s.GEOID=t.GEOID WHERE s.E_SNGPNT IS NOT NULL;", "elapsed": 0.014, "row_count": 1, "result": [[108.28337236533957]]}
{"id": "L1_0045", "question": "Top 3 Texas census tracts (identified by STATEFP 48) with the highest non-null NRI riverine expected annual building loss. List their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN nri n ON t.GEOID = n.GEOID WHERE t.STATEFP = '48' AND n.RFLD_EALB IS NOT NULL ORDER BY CAST(n.RFLD_EALB AS DOUBLE) DESC LIMIT 3;", "elapsed": 0.004, "row_count": 3, "result": [["48167724000"], ["48167723900"], ["48361020300"]]}
{"id": "L1_0046", "question": "Which Texas county (STATEFP 48) whose entire area lies west of longitude -97 has the highest total non-null payout amount for building structure damage? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' AND cl.amountPaidOnBuildingClaim IS NOT NULL AND ST_XMax(c.geometry) < -97 GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 1;", "elapsed": 0.09, "row_count": 1, "result": [["Cameron"]]}
{"id": "L1_0047", "question": "Top 3 Louisiana counties (identified by STATEFP 22) with the highest number of hospitals whose names include 'Medical Center'. Return the county names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID WHERE h.STATEFP = '22' AND h.NAME ILIKE '%Medical Center%' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 3;", "elapsed": 0.008, "row_count": 3, "result": [["East Baton Rouge"], ["Orleans"], ["Caddo"]]}
{"id": "L1_0048", "question": "In Travis, TX (identified by GEOID starting with 48453), how many NFIP claims occurred in tracts where at least 10% of the population has limited English proficiency?", "sql": "SELECT COUNT(*) AS num_claims FROM claims cl JOIN svi s ON cl.GEOID = s.GEOID WHERE cl.GEOID LIKE '48453%' AND s.EP_LIMENG >= 10;", "elapsed": 0.008, "row_count": 1, "result": [[225]]}
{"id": "L1_0049", "question": "Top 3 Texas census tracts (identified by STATEFP 48) with the highest positive NRI coastal flood risk scores. List their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN nri n ON t.GEOID = n.GEOID WHERE t.STATEFP = '48' AND n.CFLD_RISKS > 0 ORDER BY n.CFLD_RISKS DESC LIMIT 3;", "elapsed": 0.005, "row_count": 3, "result": [["48061012305"], ["48061012304"], ["48007950400"]]}
{"id": "L1_0050", "question": "Top 2 most common NRI riverine risk rating categories in Duval County, Florida (identified by GEOID starting with 12031), ranked by number of NFIP claims.", "sql": "SELECT n.RFLD_RISKR FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID WHERE cl.GEOID LIKE '12031%' GROUP BY n.RFLD_RISKR ORDER BY COUNT(*) DESC LIMIT 2;", "elapsed": 0.009, "row_count": 2, "result": [["Relatively Moderate"], ["Relatively High"]]}
{"id": "L1_0051", "question": "Average non-null NRI coastal flood expected annual building loss among tracts with claims in Texas (identified by STATEFP 48) after 2010-01-01.", "sql": "SELECT AVG(CAST(n.CFLD_EALB AS DOUBLE)) AS avg_eal_building FROM nri n JOIN (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '48' AND dateOfLoss >= DATE '2010-01-01') cl ON n.GEOID = cl.GEOID WHERE n.CFLD_EALB IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[26269.277961191197]]}
{"id": "L1_0052", "question": "The 5th highest Texas census tract (identified by STATEFP 48) by non-null estimated percentage of households with no vehicle available. List their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN svi s ON t.GEOID = s.GEOID WHERE t.STATEFP = '48' AND s.EP_NOVEH IS NOT NULL ORDER BY s.EP_NOVEH DESC LIMIT 1 OFFSET 4;", "elapsed": 0.005, "row_count": 1, "result": [["48201312400"]]}
{"id": "L1_0053", "question": "Top 5 Texas counties (identified by STATEFP 48) with the largest number of hospitals. List their county names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID WHERE h.STATEFP = '48' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 5;", "elapsed": 0.004, "row_count": 5, "result": [["Harris"], ["Tarrant"], ["Bexar"], ["Dallas"], ["Collin"]]}
{"id": "L1_0054", "question": "Top 5 Louisiana census tracts (identified by STATEFP 22) with the highest average non-null coastal flood risk scores. List their 11-digit GEOIDs.", "sql": "SELECT n.GEOID FROM nri n JOIN census_tracts t ON n.GEOID = t.GEOID WHERE t.STATEFP = '22' AND n.CFLD_RISKS IS NOT NULL GROUP BY n.GEOID ORDER BY AVG(n.CFLD_RISKS) DESC LIMIT 5;", "elapsed": 0.006, "row_count": 5, "result": [["22051027903"], ["22089063100"], ["22089062800"], ["22099021000"], ["22051027904"]]}
{"id": "L1_0055", "question": "Top 3 Louisiana counties (identified by STATEFP 22) with the highest Payout amount for building structure damage. List their county names.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 3;", "elapsed": 0.032, "row_count": 3, "result": [["Orleans"], ["Jefferson"], ["St. Bernard"]]}
{"id": "L1_0056", "question": "Top 3 Texas counties (identified by STATEFP 48) with the highest number of 'GENERAL ACUTE CARE' hospitals. Return their county names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID WHERE h.STATEFP = '48' AND h.TYPE = 'GENERAL ACUTE CARE' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 3;", "elapsed": 0.004, "row_count": 3, "result": [["Harris"], ["Tarrant"], ["Dallas"]]}
{"id": "L1_0057", "question": "Top 5 Louisiana census tracts (identified by STATEFP 22) with the highest non-null percentage of population without a high school diploma. List their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN svi s ON t.GEOID = s.GEOID WHERE t.STATEFP = '22' AND s.EP_NOHSDP IS NOT NULL ORDER BY s.EP_NOHSDP DESC LIMIT 5;", "elapsed": 0.005, "row_count": 5, "result": [["22109001302"], ["22065960400"], ["22075050700"], ["22031950400"], ["22071014500"]]}
{"id": "L1_0058", "question": "Average non-null percentage of individuals with one to two components of social vulnerability in Texas tracts (identified by STATEFP 48) with claims since 2015-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='48' AND dateOfLoss >= DATE '2015-01-01') SELECT AVG(cr.PRED12_PE) AS avg_mid_resilience FROM cre cr JOIN claim_tracts t ON cr.GEOID=t.GEOID WHERE cr.PRED12_PE IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[46.407776273022755]]}
{"id": "L1_0059", "question": "In Cameron, TX (identified by GEOID starting with 48061), how many NFIP claims occurred in tracts with riverine flood risk rating 'Very Low'?", "sql": "SELECT COUNT(*) AS num_claims FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID WHERE cl.GEOID LIKE '48061%' AND n.RFLD_RISKR = 'Very Low';", "elapsed": 0.007, "row_count": 1, "result": [[27]]}
{"id": "L1_0060", "question": "The 4th highest Texas census tract (identified by STATEFP 48) by non-null percentage of population with disabilities. List their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN svi s ON t.GEOID = s.GEOID WHERE t.STATEFP = '48' AND s.EP_DISABL IS NOT NULL ORDER BY s.EP_DISABL DESC LIMIT 1 OFFSET 3;", "elapsed": 0.005, "row_count": 1, "result": [["48289950301"]]}
{"id": "L1_0061", "question": "Which tract in Hidalgo, TX (identified by GEOID starting with 48215) with NFIP claims has the highest non-null margin of error for estimated disabled population? Return its 11-digit GEOID.", "sql": "SELECT s.GEOID AS tract_geoid FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '48215%') cl ON s.GEOID = cl.GEOID WHERE s.M_DISABL IS NOT NULL ORDER BY s.M_DISABL DESC LIMIT 1;", "elapsed": 0.006, "row_count": 1, "result": [["48215023526"]]}
{"id": "L1_0062", "question": "How many Louisiana counties (identified by STATEFP 22) have at least one hospital record?", "sql": "SELECT COUNT(DISTINCT c.GEOID) AS num_counties_with_hospitals FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID WHERE h.STATEFP = '22';", "elapsed": 0.003, "row_count": 1, "result": [[59]]}
{"id": "L1_0063", "question": "Average share of water-only tracts among Florida tracts (STATEFP 12) that have at least one NFIP claim since 2022-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='12' AND dateOfLoss >= DATE '2022-01-01') SELECT AVG(CASE WHEN cr.WATER_TRACT = 1 THEN 1 ELSE 0 END) AS avg_water_fraction FROM cre cr JOIN claim_tracts t ON cr.GEOID = t.GEOID;", "elapsed": 0.015, "row_count": 1, "result": [[0.00033886818027787193]]}
{"id": "L1_0064", "question": "Top 5 Texas counties (STATEFP 48) with the highest average share of water-only tracts according to CRE data. List their county names.", "sql": "SELECT c.NAME AS county_name FROM cre cr JOIN county c ON LEFT(cr.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' GROUP BY c.NAME ORDER BY AVG(CASE WHEN cr.WATER_TRACT = 1 THEN 1 ELSE 0 END) DESC LIMIT 5;", "elapsed": 0.005, "row_count": 5, "result": [["Kenedy"], ["Willacy"], ["Chambers"], ["Calhoun"], ["Kleberg"]]}
{"id": "L1_0065", "question": "How many Louisiana tracts (identified by GEOID starting with 22) with NFIP claims since 2015-01-01 have an estimated population with no Internet access greater than 300?", "sql": "SELECT COUNT(*) AS num_low_internet FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '22%' AND dateOfLoss >= DATE '2015-01-01') cl ON s.GEOID = cl.GEOID WHERE s.E_NOINT > 300;", "elapsed": 0.012, "row_count": 1, "result": [[293]]}
{"id": "L1_0066", "question": "In Texas (identified by GEOID starting with 48), average estimated population below 150% poverty line among tracts with claims since 2000-01-01.", "sql": "SELECT AVG(s.E_POV150) AS avg_poverty FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '48%' AND dateOfLoss >= DATE '2000-01-01') cl ON s.GEOID = cl.GEOID;", "elapsed": 0.011, "row_count": 1, "result": [[1003.8878881251482]]}
{"id": "L1_0067", "question": "Top 3 Texas counties (identified by STATEFP 48) with the highest Payout amount for building structure damage. List their county names.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 3;", "elapsed": 0.03, "row_count": 3, "result": [["Harris"], ["Galveston"], ["Jefferson"]]}
{"id": "L1_0068", "question": "Average non-null population universe used in tract-level resilience estimation among Texas tracts (identified by STATEFP 48) with NFIP claims since 2022-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='48' AND dateOfLoss >= DATE '2022-01-01') SELECT AVG(cr.POPUNI) AS avg_model_population FROM cre cr JOIN claim_tracts t ON cr.GEOID=t.GEOID WHERE cr.POPUNI IS NOT NULL;", "elapsed": 0.011, "row_count": 1, "result": [[4615.327322404371]]}
{"id": "L1_0069", "question": "Top 5 Louisiana tracts (identified by STATEFP 22) with the highest non-null expected annual building loss due to riverine flooding. List their 11-digit GEOIDs.", "sql": "SELECT n.GEOID AS tract_geoid FROM nri n JOIN census_tracts t ON n.GEOID = t.GEOID WHERE t.STATEFP = '22' AND n.RFLD_EALB IS NOT NULL ORDER BY CAST(n.RFLD_EALB AS DOUBLE) DESC LIMIT 5;", "elapsed": 0.004, "row_count": 5, "result": [["22033004021"], ["22105954200"], ["22055001904"], ["22033003807"], ["22033004022"]]}
{"id": "L1_0070", "question": "Top 3 Florida counties (identified by STATEFP 12) with the highest number of hospitals located in ZIP codes starting with '33'. Return their county names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID WHERE h.STATEFP = '12' AND h.ZIP LIKE '33%' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 3;", "elapsed": 0.003, "row_count": 3, "result": [["Miami-Dade"], ["Broward"], ["Hillsborough"]]}
{"id": "L1_0071", "question": "Among Louisiana counties (STATEFP 22) north of latitude 31.0, which has the highest non-null average payout per NFIP claim for building contents? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND cl.amountPaidOnContentsClaim IS NOT NULL AND ST_Y(ST_Centroid(c.geometry)) > 31.0 GROUP BY c.NAME ORDER BY AVG(CAST(cl.amountPaidOnContentsClaim AS DOUBLE)) DESC LIMIT 1;", "elapsed": 0.031, "row_count": 1, "result": [["Claiborne"]]}
{"id": "L1_0072", "question": "How many Louisiana tracts (identified by GEOID starting with 22) with NFIP claims have an estimated limited English proficiency population greater than 500?", "sql": "SELECT COUNT(*) AS num_high_limited_english FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '22%') cl ON s.GEOID = cl.GEOID WHERE s.E_LIMENG > 500;", "elapsed": 0.01, "row_count": 1, "result": [[15]]}
{"id": "L1_0073", "question": "Average non-null coastal flood risk score among Texas tracts (identified by STATEFP 48) that have at least one NFIP claim.", "sql": "SELECT AVG(n.CFLD_RISKS) AS avg_coastal_risk FROM nri n JOIN (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '48') cl ON n.GEOID = cl.GEOID WHERE n.CFLD_RISKS IS NOT NULL;", "elapsed": 0.01, "row_count": 1, "result": [[32.27938111092227]]}
{"id": "L1_0074", "question": "In Miami-Dade, FL (identified by GEOID starting with 12086), how many NFIP claims occurred in tracts where at least 20% of households have no vehicle available?", "sql": "SELECT COUNT(*) AS num_claims FROM claims cl JOIN svi s ON cl.GEOID = s.GEOID WHERE cl.GEOID LIKE '12086%' AND s.EP_NOVEH >= 20;", "elapsed": 0.009, "row_count": 1, "result": [[2951]]}
{"id": "L1_0075", "question": "Average non-null estimated percent of minority population in Texas tracts (identified by STATEFP 48) with NFIP claims since 2015-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='48' AND dateOfLoss >= DATE '2015-01-01') SELECT AVG(s.EP_MINRTY) AS avg_minority_pct FROM svi s JOIN claim_tracts t ON s.GEOID=t.GEOID WHERE s.EP_MINRTY IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[57.01335319609967]]}
{"id": "L1_0076", "question": "Top 10 Louisiana counties (identified by STATEFP 22) with the highest total non-null riverine flood expected building exposure. List their county names.", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND n.RFLD_EXPB IS NOT NULL GROUP BY c.NAME ORDER BY SUM(CAST(n.RFLD_EXPB AS DOUBLE)) DESC LIMIT 10;", "elapsed": 0.006, "row_count": 10, "result": [["Jefferson"], ["East Baton Rouge"], ["Livingston"], ["St. Tammany"], ["Orleans"], ["Ascension"], ["Lafayette"], ["Calcasieu"], ["Terrebonne"], ["Lafourche"]]}
{"id": "L1_0077", "question": "Top 3 Florida tracts (identified by STATEFP 12) with the highest non-null coastal flood expected annual building loss. List their 11-digit GEOIDs.", "sql": "SELECT n.GEOID AS tract_geoid FROM nri n JOIN census_tracts t ON n.GEOID = t.GEOID WHERE t.STATEFP = '12' AND n.CFLD_EALB IS NOT NULL ORDER BY CAST(n.CFLD_EALB AS DOUBLE) DESC LIMIT 3;", "elapsed": 0.005, "row_count": 3, "result": [["12109020708"], ["12127082704"], ["12029970201"]]}
{"id": "L1_0078", "question": "In St. Bernard Parish, LA (identified by GEOID starting with 22087), how many NFIP claims occurred in tracts where at least 35% of individuals have three or more components of social vulnerability?", "sql": "SELECT COUNT(*) AS num_claims FROM claims cl JOIN cre cr ON cl.GEOID = cr.GEOID WHERE cl.GEOID LIKE '22087%' AND cr.PRED3_PE >= 35;", "elapsed": 0.008, "row_count": 1, "result": [[1228]]}
{"id": "L1_0079", "question": "Top 10 Florida counties (identified by STATEFP 12) with the highest Payout amount for building structure damage. List their county names.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '12' GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 10;", "elapsed": 0.031, "row_count": 10, "result": [["Lee"], ["Pinellas"], ["Collier"], ["Hillsborough"], ["Sarasota"], ["Miami-Dade"], ["Monroe"], ["Escambia"], ["Pasco"], ["Manatee"]]}
{"id": "L1_0080", "question": "Top 10 Texas counties (identified by STATEFP 48) with the highest total non-null expected building exposure value for coastal flooding. List their county names.", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' AND n.CFLD_EXPB IS NOT NULL GROUP BY c.NAME ORDER BY SUM(CAST(n.CFLD_EXPB AS DOUBLE)) DESC LIMIT 10;", "elapsed": 0.005, "row_count": 10, "result": [["Harris"], ["Galveston"], ["Brazoria"], ["Orange"], ["Nueces"], ["Cameron"], ["Aransas"], ["Matagorda"], ["Calhoun"], ["Chambers"]]}
{"id": "L1_0081", "question": "The 4th highest Florida county (identified by STATEFP 12) by Payout amount for building structure damage. List the county name.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '12' GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 1 OFFSET 3;", "elapsed": 0.032, "row_count": 1, "result": [["Hillsborough"]]}
{"id": "L1_0082", "question": "Average CRE percentage of individuals with one to two components of social vulnerability in Florida tracts (identified by STATEFP 12) with NFIP claims since 2015-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '12' AND dateOfLoss >= DATE '2015-01-01') SELECT AVG(cr.PRED12_PE) AS avg_mid_resilience FROM cre cr JOIN claim_tracts t ON cr.GEOID = t.GEOID WHERE cr.PRED12_PE IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[46.72292338709677]]}
{"id": "L1_0083", "question": "Top 3 Duval County, FL (identified by GEOID starting with 12031) tracts with NFIP claims ranked by the largest non-null margin of error for percent of youth population aged 17 and younger. List their 11-digit GEOIDs.", "sql": "SELECT s.GEOID AS tract_geoid FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '12031%') cl ON s.GEOID = cl.GEOID WHERE s.MP_AGE17 IS NOT NULL ORDER BY s.MP_AGE17 DESC LIMIT 3;", "elapsed": 0.007, "row_count": 3, "result": [["12031014702"], ["12031016001"], ["12031015927"]]}
{"id": "L1_0084", "question": "Among East Baton Rouge Parish, LA (identified by GEOID starting with 22033) tracts with NFIP claims, which tract has the smallest non-null tract area in square miles? Return its 11-digit GEOID.", "sql": "SELECT s.GEOID AS tract_geoid FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '22033%') cl ON s.GEOID = cl.GEOID WHERE s.AREA_SQMI IS NOT NULL ORDER BY s.AREA_SQMI ASC LIMIT 1;", "elapsed": 0.007, "row_count": 1, "result": [["22033002200"]]}
{"id": "L1_0085", "question": "How many Texas tracts (identified by GEOID starting with 48) with NFIP claims since 2020-01-01 have an estimated number of households with no vehicle available greater than 200?", "sql": "SELECT COUNT(*) AS num_no_vehicle FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '48%' AND dateOfLoss >= DATE '2020-01-01') cl ON s.GEOID = cl.GEOID WHERE s.E_NOVEH > 200;", "elapsed": 0.01, "row_count": 1, "result": [[229]]}
{"id": "L1_0086", "question": "How many Texas tracts (identified by STATEFP 48) have an estimated number of single-parent households greater than 500?", "sql": "SELECT COUNT(*) AS num_single_parent_high FROM census_tracts t JOIN svi s ON t.GEOID = s.GEOID WHERE t.STATEFP = '48' AND s.E_SNGPNT > 500;", "elapsed": 0.005, "row_count": 1, "result": [[44]]}
{"id": "L1_0087", "question": "Top 5 Louisiana counties (identified by STATEFP 22) ranked by total expected population exposure to coastal flooding. List their county names.", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND n.CFLD_EXPP IS NOT NULL GROUP BY c.NAME ORDER BY SUM(CAST(n.CFLD_EXPP AS DOUBLE)) DESC LIMIT 5;", "elapsed": 0.005, "row_count": 5, "result": [["Jefferson"], ["Orleans"], ["East Baton Rouge"], ["Ascension"], ["Calcasieu"]]}
{"id": "L1_0088", "question": "Which Florida county (identified by STATEFP 12) has the fewest hospitals? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID WHERE c.STATEFP = '12' GROUP BY c.NAME ORDER BY COUNT(*) ASC LIMIT 1;", "elapsed": 0.003, "row_count": 1, "result": [["Gulf"]]}
{"id": "L1_0089", "question": "Top 4 Texas census tracts (identified by STATEFP 48) with the highest non-null riverine expected annual building loss. List their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN nri n ON t.GEOID = n.GEOID WHERE t.STATEFP = '48' AND n.RFLD_EALB IS NOT NULL ORDER BY CAST(n.RFLD_EALB AS DOUBLE) DESC LIMIT 4;", "elapsed": 0.005, "row_count": 4, "result": [["48167724000"], ["48167723900"], ["48361020300"], ["48201420900"]]}
{"id": "L1_0090", "question": "How many Texas tracts (identified by GEOID starting with 48) with NFIP claims since 2020-01-01 have an estimated number of households with high housing cost burden greater than 800?", "sql": "SELECT COUNT(*) AS num_high_housing_burden FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '48%' AND dateOfLoss >= DATE '2020-01-01') cl ON s.GEOID = cl.GEOID WHERE s.E_HBURD > 800;", "elapsed": 0.011, "row_count": 1, "result": [[182]]}
{"id": "L1_0091", "question": "Average proportion of water-only census tracts (where WATER_TRACT = 1) among Louisiana tracts (STATEFP 22) that have at least one NFIP claim.", "sql": "SELECT AVG(CASE WHEN cr.WATER_TRACT = 1 THEN 1 ELSE 0 END) AS avg_water_tract_ratio FROM cre cr JOIN (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='22') cl ON cr.GEOID = cl.GEOID;", "elapsed": 0.01, "row_count": 1, "result": [[0.0007668711656441718]]}
{"id": "L1_0092", "question": "Top 5 Texas counties (identified by STATEFP 48) ranked by average CRE percentage of individuals with zero components of social vulnerability. List their county names.", "sql": "SELECT c.NAME AS county_name FROM cre cr JOIN county c ON LEFT(cr.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' GROUP BY c.NAME ORDER BY AVG(cr.PRED0_PE) DESC LIMIT 5;", "elapsed": 0.005, "row_count": 5, "result": [["Kent"], ["Sterling"], ["Hartley"], ["Collin"], ["Denton"]]}
{"id": "L1_0093", "question": "Average non-null riverine flood expected annual land loss among Florida tracts (identified by STATEFP 12) with NFIP claims.", "sql": "SELECT AVG(CAST(n.RFLD_EALA AS DOUBLE)) AS avg_land_loss FROM nri n JOIN (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='12') cl ON n.GEOID = cl.GEOID WHERE n.RFLD_EALA IS NOT NULL;", "elapsed": 0.178, "row_count": 1, "result": [[6730.55884630826]]}
{"id": "L1_0094", "question": "Top 3 Louisiana tracts (identified by STATEFP 22) with the highest non-null percent of elderly population (aged 65 and older). List their 11-digit GEOIDs.", "sql": "SELECT s.GEOID AS tract_geoid FROM svi s JOIN census_tracts t ON s.GEOID = t.GEOID WHERE t.STATEFP = '22' AND s.EP_AGE65 IS NOT NULL ORDER BY s.EP_AGE65 DESC LIMIT 3;", "elapsed": 0.045, "row_count": 3, "result": [["22071003800"], ["22017020600"], ["22017025200"]]}
{"id": "L1_0095", "question": "Average non-null percentage of individuals with three plus components of social vulnerability with three or more vulnerability components in Florida tracts (identified by STATEFP 12) with claims since 2010-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '12' AND dateOfLoss >= DATE '2010-01-01') SELECT AVG(cr.PRED3_PE) AS avg_vulnerable_pct FROM cre cr JOIN claim_tracts t ON cr.GEOID = t.GEOID WHERE cr.PRED3_PE IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[22.806010211524434]]}
{"id": "L1_0096", "question": "Top 5 Texas counties (identified by STATEFP 48) with the highest average non-null coastal flood expected population exposure. List their county names.", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' AND n.CFLD_EXPPE IS NOT NULL GROUP BY c.NAME ORDER BY AVG(CAST(n.CFLD_EXPPE AS DOUBLE)) DESC LIMIT 5;", "elapsed": 0.006, "row_count": 5, "result": [["Orange"], ["Galveston"], ["Brazoria"], ["Chambers"], ["Matagorda"]]}
{"id": "L1_0097", "question": "How many Orleans Parish, LA (identified by GEOID starting with 22071) tracts with NFIP claims have an estimated minority percentage greater than 70?", "sql": "SELECT COUNT(*) AS num_high_minority FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '22071%') cl ON s.GEOID = cl.GEOID WHERE s.EP_MINRTY > 70;", "elapsed": 0.007, "row_count": 1, "result": [[97]]}
{"id": "L1_0098", "question": "Top 3 Florida tracts (identified by STATEFP 12) with the highest population universe used in tract-level resilience estimation. List their 11-digit GEOIDs.", "sql": "SELECT cr.GEOID AS tract_geoid FROM cre cr JOIN census_tracts t ON cr.GEOID = t.GEOID WHERE t.STATEFP = '12' AND cr.POPUNI IS NOT NULL ORDER BY cr.POPUNI DESC LIMIT 3;", "elapsed": 0.004, "row_count": 3, "result": [["12011010503"], ["12109020605"], ["12057013916"]]}
{"id": "L1_0099", "question": "Average non-null coastal flood expected building exposure for coastal flooding among Texas tracts (identified by STATEFP 48) that experienced NFIP claims since 2015.", "sql": "SELECT AVG(CAST(n.CFLD_EXPB AS DOUBLE)) AS avg_exposure FROM nri n JOIN (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='48' AND dateOfLoss >= DATE '2015-01-01') cl ON n.GEOID = cl.GEOID WHERE n.CFLD_EXPB IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[83875366.21823588]]}
{"id": "L1_0100", "question": "Top 5 Louisiana tracts (identified by STATEFP 22) with the highest non-null percent of population without health insurance (EP_UNINSUR). List their 11-digit GEOIDs.", "sql": "SELECT s.GEOID AS tract_geoid FROM svi s JOIN census_tracts t ON s.GEOID = t.GEOID WHERE t.STATEFP = '22' AND s.EP_UNINSUR IS NOT NULL ORDER BY s.EP_UNINSUR DESC LIMIT 5;", "elapsed": 0.005, "row_count": 5, "result": [["22033001103"], ["22073010203"], ["22063040700"], ["22033001104"], ["22071002700"]]}
{"id": "L2_0001", "question": "How many census_tracts in Duval County, FL (identified by GEOID starting with 12031) intersect floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.GEOID LIKE '12031%' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.964, "row_count": 1, "result": [[219]]}
{"id": "L2_0002", "question": "How many schools in San Antonio, TX (identified by CITY = 'SAN ANTONIO' and STATEFP = '48') fall inside floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP = '48' AND a.CITY = 'SAN ANTONIO' AND ST_IsValid(b.geometry);", "elapsed": 2.491, "row_count": 1, "result": [[668]]}
{"id": "L2_0003", "question": "Which census_tract in Hillsborough County, FL (identified by STATEFP = '12' and COUNTYFP = '057') has the largest total overlap area with all zcta polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tracts_id FROM census_tracts a JOIN zcta b ON ST_Overlaps(a.geometry, b.geometry) WHERE a.STATEFP = '12' AND a.COUNTYFP = '057' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry, b.geometry))) DESC LIMIT 1;", "elapsed": 0.453, "row_count": 1, "result": [["12057013903"]]}
{"id": "L2_0004", "question": "Top 1 census_tract in Austin, TX (identified by CITY = 'AUSTIN' and STATEFP = '48') by number of schools located within it (return the 11-digit GEOID only).", "sql": "SELECT b.GEOID AS census_tracts_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP = '48' AND a.CITY = 'AUSTIN' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.231, "row_count": 1, "result": [["48453002411"]]}
{"id": "L2_0005", "question": "Top 1 census_tract in Orleans Parish, LA (identified by COUNTYFIPS = '071') by number of hospitals located within it (return the 11-digit GEOID only).", "sql": "SELECT b.GEOID AS census_tracts_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.COUNTYFIPS = '22071' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.224, "row_count": 1, "result": [["22071009900"]]}
{"id": "L2_0006", "question": "In Galveston County, TX (identified by COUNTYFP = '167' and STATEFP = '48'), which FEMA Flood Hazard Zone (excluding 'X' and 'AREA NOT INCLUDED') has the most census_tracts intersecting floodplain polygons? Return its FLD_ZONE code.", "sql": "SELECT b.FLD_ZONE FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='167' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) AND b.FLD_ZONE IS NOT NULL AND b.FLD_ZONE NOT IN ('X','AREA NOT INCLUDED') GROUP BY b.FLD_ZONE ORDER BY COUNT(DISTINCT a.GEOID) DESC LIMIT 1;", "elapsed": 2.185, "row_count": 1, "result": [["AE"]]}
{"id": "L2_0007", "question": "How many hospitals in Harris County, TX (identified by COUNTYFIPS = '48201') are located within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN census_tracts b ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.COUNTYFIPS='48201' AND ST_IsValid(b.geometry);", "elapsed": 0.219, "row_count": 1, "result": [[110]]}
{"id": "L2_0008", "question": "How many pairs of census_tracts in Hillsborough County, FL (STATEFP = '12' and COUNTYFP = '057') share a common boundary?", "sql": "SELECT COUNT(*) AS num_adjacent_pairs FROM census_tracts a JOIN census_tracts b ON ST_Touches(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='057' AND b.STATEFP='12' AND b.COUNTYFP='057' AND a.GEOID < b.GEOID AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.188, "row_count": 1, "result": [[1025]]}
{"id": "L2_0009", "question": "Which census_tract in Jacksonville, FL (CITY = 'JACKSONVILLE' and STATEFP = '12') contains the largest number of schools? Return the 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tracts_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='12' AND a.CITY='JACKSONVILLE' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.251, "row_count": 1, "result": [["12031000800"]]}
{"id": "L2_0010", "question": "How many census_tracts in Hillsborough County, FL (STATEFP = '12' and COUNTYFP = '057') intersect floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='057' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.335, "row_count": 1, "result": [[335]]}
{"id": "L2_0011", "question": "Which census_tract in Broward County, FL (STATEFP = '12' and COUNTYFP = '011') has the largest overlap area with zcta polygons? Return the 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tracts_id FROM census_tracts a JOIN zcta b ON ST_Overlaps(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='011' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry, b.geometry))) DESC LIMIT 1;", "elapsed": 0.29, "row_count": 1, "result": [["12011980000"]]}
{"id": "L2_0012", "question": "How many census_tracts in Louisiana (identified by STATEFP = '22') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP = '22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.279, "row_count": 1, "result": [[514]]}
{"id": "L2_0013", "question": "How many schools in Miami, FL (CITY = 'MIAMI' and STATEFP = '12') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN zcta b ON ST_Within(ST_Point(a.LON, a.LAT), b.geometry) WHERE a.STATEFP='12' AND a.CITY='MIAMI' AND ST_IsValid(b.geometry);", "elapsed": 0.201, "row_count": 1, "result": [[537]]}
{"id": "L2_0014", "question": "In Palm Beach County, FL (STATEFP = '12' and COUNTYFP = '099'), which FEMA Flood Hazard Zoneexcluding 'X' and 'AREA NOT INCLUDED'has the second largest number of intersecting census_tracts? Return its FLD_ZONE code.", "sql": "SELECT b.FLD_ZONE FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='099' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) AND b.FLD_ZONE NOT IN ('X','AREA NOT INCLUDED') GROUP BY b.FLD_ZONE ORDER BY COUNT(DISTINCT a.GEOID) DESC LIMIT 1 OFFSET 1;", "elapsed": 2.288, "row_count": 1, "result": [["VE"]]}
{"id": "L2_0015", "question": "How many hospitals in Orleans Parish, LA (COUNTYFIPS = '22071') are located within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN census_tracts b ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.COUNTYFIPS='22071' AND ST_IsValid(b.geometry);", "elapsed": 0.236, "row_count": 1, "result": [[15]]}
{"id": "L2_0016", "question": "How many census_tracts in Florida (identified by STATEFP = '12') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP = '12' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.417, "row_count": 1, "result": [[2465]]}
{"id": "L2_0017", "question": "Which zcta in Florida (STATEFP = '12') contains the largest number of schools? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.236, "row_count": 1, "result": [["33157"]]}
{"id": "L2_0018", "question": "Which census_tract in Louisiana (identified by STATEFP = '22') shares boundaries with the largest number of other census_tracts, including those in neighboring states? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tracts_id FROM census_tracts a JOIN census_tracts b ON ST_Touches(a.geometry, b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY COUNT(DISTINCT b.GEOID) DESC LIMIT 1;", "elapsed": 0.841, "row_count": 1, "result": [["22051028900"]]}
{"id": "L2_0019", "question": "Which zcta in FL (identified by STATEFP = '12') contains the most hospitals? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.193, "row_count": 1, "result": [["32308"]]}
{"id": "L2_0020", "question": "Which floodplain polygon in Louisiana (STATEFP = '22') contains the largest number of schools? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.356, "row_count": 1, "result": [["ad62c09e-ed3a-4753-93b8-62dbd1e7c3c1"]]}
{"id": "L2_0021", "question": "In East Baton Rouge Parish, LA (identified by COUNTYFP = '033' and STATEFP = '22'), which FEMA Flood Hazard Zone (excluding 'X' and 'AREA NOT INCLUDED') ranks second in terms of the number of intersecting census_tracts? Return its FLD_ZONE code.", "sql": "SELECT b.FLD_ZONE FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='22' AND a.COUNTYFP='033' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) AND b.FLD_ZONE IS NOT NULL AND b.FLD_ZONE NOT IN ('X','AREA NOT INCLUDED') GROUP BY b.FLD_ZONE ORDER BY COUNT(DISTINCT a.GEOID) DESC LIMIT 1 OFFSET 1;", "elapsed": 2.198, "row_count": 1, "result": [["A"]]}
{"id": "L2_0022", "question": "In Broward County, FL (identified by COUNTYFP = '011' and STATEFP = '12'), which FEMA Flood Hazard Zone (excluding 'X' and 'AREA NOT INCLUDED') ranks second in terms of the number of intersecting census_tracts? Return its FLD_ZONE code.", "sql": "SELECT b.FLD_ZONE FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='011' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) AND b.FLD_ZONE IS NOT NULL AND b.FLD_ZONE NOT IN ('X','AREA NOT INCLUDED') GROUP BY b.FLD_ZONE ORDER BY COUNT(DISTINCT a.GEOID) DESC LIMIT 1 OFFSET 1;", "elapsed": 2.311, "row_count": 1, "result": [["AH"]]}
{"id": "L2_0023", "question": "Which floodplain polygon in TX (STATEFP = '48') contains the largest number of schools? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.546, "row_count": 1, "result": [["87641727-0834-4106-afd0-c2944041d29c"]]}
{"id": "L2_0024", "question": "Which zcta in LA (STATEFP = '22') contains the most hospitals? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.197, "row_count": 1, "result": [["70508"]]}
{"id": "L2_0025", "question": "Which floodplain polygon in Louisiana (identified by STATEFP = '22') contains the largest number of schools? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE b.STATEFP = '22' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.033, "row_count": 1, "result": [["ad62c09e-ed3a-4753-93b8-62dbd1e7c3c1"]]}
{"id": "L2_0026", "question": "Which census_tract in TX (STATEFP = '48') borders the largest number of neighboring census_tracts? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tracts_id FROM census_tracts a JOIN census_tracts b ON ST_Touches(a.geometry, b.geometry) WHERE a.STATEFP='48' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY COUNT(DISTINCT b.GEOID) DESC LIMIT 1;", "elapsed": 2.955, "row_count": 1, "result": [["48141010101"]]}
{"id": "L2_0027", "question": "Top 2 zcta in LA (identified by STATEFP 22) by number of contained schools.", "sql": "SELECT b.GEOID AS zcta_id, COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM zcta b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP = '22' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY num_schools DESC LIMIT 2;", "elapsed": 0.205, "row_count": 2, "result": [["70806", 24], ["70115", 19]]}
{"id": "L2_0028", "question": "How many schools in TX (STATEFP = '48') are located within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN census_tracts b ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry);", "elapsed": 0.282, "row_count": 1, "result": [[11285]]}
{"id": "L2_0029", "question": "Which ZCTA in TX (identified by STATEFP = '48') contains the largest number of hospitals? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP = '48' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.199, "row_count": 1, "result": [["77030"]]}
{"id": "L2_0030", "question": "Which floodplain polygon in Texas (STATEFP = '48') contains the largest number of schools whose CITY = 'AUSTIN'? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE b.STATEFP='48' AND a.CITY='AUSTIN' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.318, "row_count": 1, "result": [["c8b590c8-8c68-4ee7-8bf5-8fa1f00b01bf"]]}
{"id": "L2_0031", "question": "How many census_tracts in TX (identified by STATEFP 48) contains zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Contains(a.geometry, b.geometry) WHERE a.STATEFP = '48' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.42, "row_count": 1, "result": [[166]]}
{"id": "L2_0032", "question": "How many census_tracts in East Baton Rouge Parish, LA (identified by COUNTYFP 033 and STATEFP 22) intersect zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP = '22' AND a.COUNTYFP = '033' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.223, "row_count": 1, "result": [[108]]}
{"id": "L2_0033", "question": "How many census_tracts in Orleans Parish, LA (identified by COUNTYFP 071 and STATEFP 22) intersect zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP = '22' AND a.COUNTYFP = '071' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.222, "row_count": 1, "result": [[184]]}
{"id": "L2_0034", "question": "Which census_tract in LA (identified by STATEFP = '22') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE b.STATEFP='22' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.054, "row_count": 1, "result": [["22033003804"]]}
{"id": "L2_0035", "question": "How many schools in TX (identified by STATEFP 48) are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP = '48' AND ST_IsValid(b.geometry);", "elapsed": 0.256, "row_count": 1, "result": [[11284]]}
{"id": "L2_0036", "question": "Which floodplain polygon in TX (identified by STATEFP = '48') contains the largest number of hospitals? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE b.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.317, "row_count": 1, "result": [["87641727-0834-4106-afd0-c2944041d29c"]]}
{"id": "L2_0037", "question": "How many census_tracts in FL (identified by STATEFP 12) are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP = '12' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 3.199, "row_count": 1, "result": [[211]]}
{"id": "L2_0038", "question": "How many hospitals in Texas (STATEFP = '48') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN floodplain b ON ST_Within(ST_Point(a.LON, a.LAT), b.geometry) WHERE a.STATEFP = '48' AND ST_IsValid(b.geometry);", "elapsed": 2.341, "row_count": 1, "result": [[723]]}
{"id": "L2_0039", "question": "Which FEMA Flood Hazard Zone in LA (identified by STATEFP = '22') contains the largest number of census_tracts within floodplain polygons? Return its FLD_ZONE code.", "sql": "SELECT b.FLD_ZONE FROM census_tracts a JOIN floodplain b ON ST_Contains(b.geometry,a.geometry) WHERE a.STATEFP='22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY b.FLD_ZONE ORDER BY COUNT(DISTINCT a.GEOID) DESC LIMIT 1;", "elapsed": 2.89, "row_count": 1, "result": [["AREA NOT INCLUDED"]]}
{"id": "L2_0040", "question": "How many schools in TX (identified by STATEFP 48) are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON, a.LAT), b.geometry) WHERE a.STATEFP = '48' AND ST_IsValid(b.geometry);", "elapsed": 2.525, "row_count": 1, "result": [[9704]]}
{"id": "L2_0041", "question": "How many hospitals in LA (identified by STATEFP = '22') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Within(ST_Point(a.LON, a.LAT), b.geometry) WHERE a.STATEFP = '22' AND ST_IsValid(b.geometry);", "elapsed": 0.215, "row_count": 1, "result": [[269]]}
{"id": "L2_0042", "question": "How many census_tracts in TX (identified by STATEFP = '48') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP = '48' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.529, "row_count": 1, "result": [[3143]]}
{"id": "L2_0043", "question": "How many schools in Austin, TX (identified by CITY = 'AUSTIN' and STATEFP = '48') are located within census_tracts polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN census_tracts b ON ST_Within(ST_Point(a.LON, a.LAT), b.geometry) WHERE a.STATEFP = '48' AND a.CITY = 'AUSTIN' AND ST_IsValid(b.geometry);", "elapsed": 0.228, "row_count": 1, "result": [[395]]}
{"id": "L2_0044", "question": "How many census_tracts in LA (identified by STATEFP = '22') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP = '22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.859, "row_count": 1, "result": [[59]]}
{"id": "L2_0045", "question": "How many census_tracts in TX (identified by STATEFP = '48') intersect floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP = '48' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 4.878, "row_count": 1, "result": [[6295]]}
{"id": "L2_0046", "question": "Which FEMA Flood Hazard Zone in Harris County, TX (identified by COUNTYFP = '201' and STATEFP = '48') contains the largest number of census_tracts intersecting floodplain polygons, excluding areas marked as 'AREA NOT INCLUDED' or 'ZONE X'? Return its FLD_ZONE code.", "sql": "SELECT b.FLD_ZONE FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='201' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) AND b.FLD_ZONE NOT IN ('AREA NOT INCLUDED','AREA OF MINIMAL FLOOD HAZARD','X') GROUP BY b.FLD_ZONE ORDER BY COUNT(DISTINCT a.GEOID) DESC LIMIT 1;", "elapsed": 2.176, "row_count": 1, "result": [["AE"]]}
{"id": "L2_0047", "question": "Which census_tract in TX (identified by STATEFP = '48') contains the largest number of schools? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.301, "row_count": 1, "result": [["48451000801"]]}
{"id": "L2_0048", "question": "Which floodplain polygon in TX (identified by STATEFP = '48') contains the largest number of schools? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE b.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.437, "row_count": 1, "result": [["87641727-0834-4106-afd0-c2944041d29c"]]}
{"id": "L2_0049", "question": "How many schools in TX (identified by STATEFP = '48') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON, a.LAT), b.geometry) WHERE a.STATEFP = '48' AND ST_IsValid(b.geometry);", "elapsed": 2.585, "row_count": 1, "result": [[9704]]}
{"id": "L2_0050", "question": "How many schools in New Orleans, LA (identified by CITY = 'NEW ORLEANS' and STATEFP = '22') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN zcta b ON ST_Within(ST_Point(a.LON, a.LAT), b.geometry) WHERE a.STATEFP='22' AND a.CITY='NEW ORLEANS' AND ST_IsValid(b.geometry);", "elapsed": 0.21, "row_count": 1, "result": [[152]]}
{"id": "L2_0051", "question": "Which census_tract in Travis County, TX (identified by COUNTYFP = '453' and STATEFP = '48') has the largest overlap area with floodplain polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN floodplain b ON ST_Overlaps(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='453' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 2.496, "row_count": 1, "result": [["48453036300"]]}
{"id": "L2_0052", "question": "Which census_tract in Orleans County, LA (identified by COUNTYFP = '071' and STATEFP = '22') has the largest overlap area with zcta polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Overlaps(a.geometry, b.geometry) WHERE a.STATEFP='22' AND a.COUNTYFP='071' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.229, "row_count": 1, "result": [["22071001758"]]}
{"id": "L2_0053", "question": "Which zcta in TX (identified by STATEFP = '48') contains the largest number of schools? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.255, "row_count": 1, "result": [["78626"]]}
{"id": "L2_0054", "question": "Which census_tract in Miami-Dade County, FL (identified by COUNTYFP = '086' and STATEFP = '12') has the largest overlap area with zcta polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Overlaps(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='086' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.302, "row_count": 1, "result": [["12086011500"]]}
{"id": "L2_0055", "question": "How many census_tracts in Travis County, TX (identified by COUNTYFP = '453' and STATEFP = '48') intersect other census_tract polygons within the same county (excluding self-intersections)?", "sql": "WITH valid_tracts AS (SELECT GEOID, geometry AS geom FROM census_tracts WHERE STATEFP='48' AND COUNTYFP='453' AND ST_IsValid(geometry)) SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM valid_tracts a JOIN valid_tracts b ON ST_Intersects(a.geom, b.geom) WHERE a.GEOID < b.GEOID;", "elapsed": 0.094, "row_count": 1, "result": [[261]]}
{"id": "L2_0056", "question": "Which FEMA Flood Hazard Zone in Travis County, TX (identified by COUNTYFP = '453' and STATEFP = '48') contains the largest number of census_tracts intersecting floodplain polygons, excluding areas marked as 'AREA NOT INCLUDED' or 'ZONE X'? Return its FLD_ZONE code.", "sql": "SELECT b.FLD_ZONE FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='453' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) AND b.FLD_ZONE NOT IN ('AREA NOT INCLUDED','AREA OF MINIMAL FLOOD HAZARD','X') GROUP BY b.FLD_ZONE ORDER BY COUNT(DISTINCT a.GEOID) DESC LIMIT 1;", "elapsed": 2.217, "row_count": 1, "result": [["AE"]]}
{"id": "L2_0057", "question": "How many census_tracts in Lafayette Parish, LA (identified by COUNTYFP = '055' and STATEFP = '22') intersect other census_tract polygons within the same county (excluding self-intersections)?", "sql": "WITH valid_tracts AS (SELECT GEOID, geometry AS geom FROM census_tracts WHERE STATEFP='22' AND COUNTYFP='055' AND ST_IsValid(geometry)) SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM valid_tracts a JOIN valid_tracts b ON ST_Intersects(a.geom, b.geom) WHERE a.GEOID < b.GEOID;", "elapsed": 0.03, "row_count": 1, "result": [[52]]}
{"id": "L2_0058", "question": "Which census_tract in TX (identified by STATEFP = '48') contains the largest number of schools? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.293, "row_count": 1, "result": [["48451000801"]]}
{"id": "L2_0059", "question": "How many census_tracts in LA (identified by STATEFP = '22') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.279, "row_count": 1, "result": [[514]]}
{"id": "L2_0060", "question": "Which census_tract in FL (identified by STATEFP = '12') contains the largest number of schools? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.264, "row_count": 1, "result": [["12086009010"]]}
{"id": "L2_0061", "question": "Which census_tract in LA (identified by STATEFP = '22') has the largest overlap area with floodplain polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN floodplain b ON ST_Overlaps(a.geometry, b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 5.302, "row_count": 1, "result": [["22087030105"]]}
{"id": "L2_0062", "question": "How many census_tracts in LA (identified by STATEFP = '22') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.813, "row_count": 1, "result": [[59]]}
{"id": "L2_0063", "question": "Which floodplain polygon in TX (identified by STATEFP = '48') contains the largest number of hospitals? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.394, "row_count": 1, "result": [["87641727-0834-4106-afd0-c2944041d29c"]]}
{"id": "L2_0064", "question": "Which census_tract in TX (identified by STATEFP = '48') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.228, "row_count": 1, "result": [["48201313102"]]}
{"id": "L2_0065", "question": "Which zcta in TX (identified by STATEFP = '48') contains the largest number of schools? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.271, "row_count": 1, "result": [["78626"]]}
{"id": "L2_0066", "question": "How many census_tracts in TX (identified by STATEFP = '48') intersect zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.614, "row_count": 1, "result": [[6893]]}
{"id": "L2_0067", "question": "Which census_tract in Florida (identified by STATEFP = '12') contains the largest number of schools? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.259, "row_count": 1, "result": [["12086009010"]]}
{"id": "L2_0068", "question": "How many schools in FL (identified by STATEFP = '12') are located within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN census_tracts b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry);", "elapsed": 0.269, "row_count": 1, "result": [[6596]]}
{"id": "L2_0069", "question": "How many hospitals in FL (identified by STATEFP = '12') intersect zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry);", "elapsed": 0.192, "row_count": 1, "result": [[381]]}
{"id": "L2_0070", "question": "How many schools in TX (identified by STATEFP = '48') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry);", "elapsed": 0.255, "row_count": 1, "result": [[11284]]}
{"id": "L2_0071", "question": "Which census_tract in TX (identified by STATEFP = '48') has the largest overlap area with zcta polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 3.645, "row_count": 1, "result": [["48043950500"]]}
{"id": "L2_0072", "question": "Which census_tract in FL (identified by STATEFP = '12') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.231, "row_count": 1, "result": [["12099001402"]]}
{"id": "L2_0073", "question": "How many hospitals in LA (identified by STATEFP = '22') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry);", "elapsed": 0.192, "row_count": 1, "result": [[269]]}
{"id": "L2_0074", "question": "How many hospitals in FL (identified by STATEFP = '12') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry);", "elapsed": 0.194, "row_count": 1, "result": [[381]]}
{"id": "L2_0075", "question": "How many census_tracts in LA (identified by STATEFP = '22') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 3.027, "row_count": 1, "result": [[59]]}
{"id": "L2_0076", "question": "How many schools in LA (identified by STATEFP = '22') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry);", "elapsed": 0.207, "row_count": 1, "result": [[1787]]}
{"id": "L2_0077", "question": "Which census_tract in Florida (identified by STATEFP = '12') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.223, "row_count": 1, "result": [["12099001402"]]}
{"id": "L2_0078", "question": "Which census_tract in LA (identified by STATEFP = '22') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.221, "row_count": 1, "result": [["22051020519"]]}
{"id": "L2_0079", "question": "Which zcta in TX (identified by STATEFP = '48') contains the largest number of hospitals? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.202, "row_count": 1, "result": [["77030"]]}
{"id": "L2_0080", "question": "How many hospitals in TX (identified by STATEFP = '48') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry);", "elapsed": 0.199, "row_count": 1, "result": [[876]]}
{"id": "L2_0081", "question": "How many census_tracts in Miami-Dade County, FL (identified by COUNTYFP = '086' and STATEFP = '12') intersect zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='086' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.239, "row_count": 1, "result": [[707]]}
{"id": "L2_0082", "question": "How many census_tracts in Harris County, TX (identified by COUNTYFP = '201' and STATEFP = '48') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='201' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.398, "row_count": 1, "result": [[180]]}
{"id": "L2_0083", "question": "Which census_tract in Travis County, TX (identified by COUNTYFP = '453' and STATEFP = '48') has the largest overlap area with floodplain polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='453' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 2.532, "row_count": 1, "result": [["48453036300"]]}
{"id": "L2_0084", "question": "How many census_tracts in FL (identified by STATEFP = '12') intersect other census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN census_tracts b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='12' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.63, "row_count": 1, "result": [[5160]]}
{"id": "L2_0085", "question": "How many hospitals in TX (identified by STATEFP = '48') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry);", "elapsed": 0.194, "row_count": 1, "result": [[876]]}
{"id": "L2_0086", "question": "How many hospitals in East Baton Rouge County, LA (identified by COUNTYFP = '033' and STATEFP = '22') are located within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN census_tracts b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='22' AND b.COUNTYFP='033' AND ST_IsValid(b.geometry);", "elapsed": 0.032, "row_count": 1, "result": [[21]]}
{"id": "L2_0087", "question": "Which census_tract in FL (identified by STATEFP = '12') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.225, "row_count": 1, "result": [["12099001402"]]}
{"id": "L2_0088", "question": "How many schools in Louisiana (identified by STATEFP = '22') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry);", "elapsed": 2.394, "row_count": 1, "result": [[1555]]}
{"id": "L2_0089", "question": "Which census_tract in Miami-Dade County, FL (identified by COUNTYFP = '086' and STATEFP = '12') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND b.COUNTYFP='086' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.037, "row_count": 1, "result": [["12086003004"]]}
{"id": "L2_0090", "question": "Which zcta in LA (identified by STATEFP = '22') contains the largest number of schools? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.215, "row_count": 1, "result": [["70806"]]}
{"id": "L2_0091", "question": "Which floodplain polygon in TX (identified by STATEFP = '48') contains the largest number of hospitals? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.349, "row_count": 1, "result": [["87641727-0834-4106-afd0-c2944041d29c"]]}
{"id": "L2_0092", "question": "Which floodplain polygon in LA (identified by STATEFP = '22') contains the largest number of schools? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP = '22' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.317, "row_count": 1, "result": [["ad62c09e-ed3a-4753-93b8-62dbd1e7c3c1"]]}
{"id": "L2_0093", "question": "Which census_tract in Bexar County, TX (identified by COUNTYFP = '029' and STATEFP = '48') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND b.COUNTYFP='029' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.045, "row_count": 1, "result": [["48029181402"]]}
{"id": "L2_0094", "question": "How many hospitals in LA (identified by STATEFP = '22') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry);", "elapsed": 0.191, "row_count": 1, "result": [[269]]}
{"id": "L2_0095", "question": "How many hospitals in McAllen, TX (identified by CITY = 'MCALLEN' and STATEFP = '48') are located within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN census_tracts b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND UPPER(a.CITY)='MCALLEN' AND ST_IsValid(b.geometry);", "elapsed": 0.235, "row_count": 1, "result": [[7]]}
{"id": "L2_0096", "question": "Which zcta in FL (identified by STATEFP = '12') contains the largest number of schools? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.228, "row_count": 1, "result": [["33012"]]}
{"id": "L2_0097", "question": "Which census_tract in Orleans Parish, LA (identified by COUNTYFP = '071' and STATEFP = '22') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND b.COUNTYFP='071' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.04, "row_count": 1, "result": [["22071009900"]]}
{"id": "L2_0098", "question": "Which census_tract in FL (identified by STATEFP = '12') has the largest overlap area with zcta polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='12' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 2.119, "row_count": 1, "result": [["12097043802"]]}
{"id": "L2_0099", "question": "Which zcta in LA (identified by STATEFP = '22') contains the largest number of hospitals? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.202, "row_count": 1, "result": [["70508"]]}
{"id": "L2_0100", "question": "Which census_tract in Miami-Dade County, FL (identified by COUNTYFP = '086' and STATEFP = '12') has the largest overlap area with zcta polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='086' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.348, "row_count": 1, "result": [["12086011500"]]}
{"id": "L2_0101", "question": "Which census_tract in Dallas, TX (identified by CITY = 'DALLAS' and STATEFP = '48') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND a.CITY='DALLAS' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.221, "row_count": 1, "result": [["48113002200"]]}
{"id": "L2_0102", "question": "Which floodplain polygon in Bexar County, TX (identified by COUNTYFP = '029' and STATEFP = '48') overlaps the largest total census_tract area? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='029' GROUP BY b.GFID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.731, "row_count": 1, "result": [["0a5d9e00-2e1c-41a5-a89c-cdc365e46d03"]]}
{"id": "L2_0103", "question": "How many schools in Corpus Christi, TX (identified by CITY = 'CORPUS CHRISTI' and STATEFP = '48') fall within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND UPPER(a.CITY)='CORPUS CHRISTI' AND ST_IsValid(b.geometry);", "elapsed": 2.367, "row_count": 1, "result": [[119]]}
{"id": "L2_0104", "question": "Which census_tract in Duval County, FL (identified by COUNTYFP = '031' and STATEFP = '12') has the largest overlap area with floodplain polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='031' GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 1.059, "row_count": 1, "result": [["12031017300"]]}
{"id": "L2_0105", "question": "How many hospitals in Tampa, FL (identified by CITY = 'TAMPA' and STATEFP = '12') are located in floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='12' AND UPPER(a.CITY)='TAMPA' AND ST_IsValid(b.geometry);", "elapsed": 2.305, "row_count": 1, "result": [[17]]}
{"id": "L2_0106", "question": "Which ZCTA in Baton Rouge, LA (identified by CITY = 'BATON ROUGE' and STATEFP = '22') contains the largest number of schools? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND UPPER(a.CITY)='BATON ROUGE' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.199, "row_count": 1, "result": [["70806"]]}
{"id": "L2_0107", "question": "How many hospitals in Shreveport, LA (identified by CITY = 'SHREVEPORT' and STATEFP = '22') are located within ZCTA polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='22' AND a.CITY='SHREVEPORT' AND ST_IsValid(b.geometry);", "elapsed": 0.191, "row_count": 1, "result": [[17]]}
{"id": "L2_0108", "question": "Which census_tract in Palm Beach County, FL (identified by COUNTYFP = '099' and STATEFP = '12') overlaps the largest ZCTA area? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='099' GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.121, "row_count": 1, "result": [["12099007917"]]}
{"id": "L2_0109", "question": "How many schools in Louisiana (identified by STATEFP = '22') fall within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN census_tracts b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry);", "elapsed": 0.245, "row_count": 1, "result": [[1786]]}
{"id": "L2_0110", "question": "Which census_tract in Collin County, TX (identified by COUNTYFP = '085' and STATEFP = '48') intersects the largest floodplain area? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='085' GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.693, "row_count": 1, "result": [["48085030102"]]}
{"id": "L2_0111", "question": "Which floodplain polygon in Tampa, FL (identified by CITY = 'TAMPA' and STATEFP = '12') contains the largest number of hospitals? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND UPPER(a.CITY)='TAMPA' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.336, "row_count": 1, "result": [["ef973673-3efc-44af-a661-585f27a3bc1b"]]}
{"id": "L2_0112", "question": "Which floodplain polygon in Tarrant County, TX (identified by COUNTYFP = '439' and STATEFP = '48') overlaps the largest area of census_tracts? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN census_tracts a ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='439' GROUP BY b.GFID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.989, "row_count": 1, "result": [["92c5c131-27c2-428a-922a-22415dd3470b"]]}
{"id": "L2_0113", "question": "Which census_tract in Orange County, FL (identified by COUNTYFP = '095' and STATEFP = '12') overlaps the largest ZCTA area? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='095' GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.233, "row_count": 1, "result": [["12095016604"]]}
{"id": "L2_0114", "question": "Which census_tract in Lafayette, LA (identified by CITY = 'Lafayette' and STATEFP = '22') contains the largest number of schools? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND a.CITY='LAFAYETTE' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.23, "row_count": 1, "result": [["22055000200"]]}
{"id": "L2_0115", "question": "Which census_tract in Hillsborough County, FL (identified by COUNTYFP = '057' and STATEFP = '12') overlaps the largest floodplain area? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='057' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 2.659, "row_count": 1, "result": [["12057990000"]]}
{"id": "L2_0116", "question": "How many schools in El Paso, TX (identified by CITY = 'EL PASO' and STATEFP = '48') are located in census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN census_tracts b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND a.CITY='EL PASO' AND ST_IsValid(b.geometry);", "elapsed": 0.233, "row_count": 1, "result": [[296]]}
{"id": "L2_0117", "question": "Which census_tract in East Baton Rouge Parish, LA (identified by COUNTYFP = '033' and STATEFP = '22') overlaps the largest ZCTA area? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='22' AND a.COUNTYFP='033' GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.223, "row_count": 1, "result": [["22033004700"]]}
{"id": "L2_0118", "question": "How many census_tracts in Pinellas County, FL (identified by COUNTYFP = '103' and STATEFP = '12') intersect floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='103' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.335, "row_count": 1, "result": [[275]]}
{"id": "L2_0119", "question": "Which census_tract in Galveston County, TX (identified by COUNTYFP = '167' and STATEFP = '48') has the largest overlap area with floodplain polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='167' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 3.082, "row_count": 1, "result": [["48167990100"]]}
{"id": "L2_0120", "question": "How many hospitals in Fort Worth, TX (identified by CITY = 'FORT WORTH' and STATEFP = '48') intersect floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN floodplain b ON ST_Intersects(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND UPPER(a.CITY)='FORT WORTH' AND ST_IsValid(b.geometry);", "elapsed": 2.324, "row_count": 1, "result": [[26]]}
{"id": "L2_0121", "question": "Which census_tract in Williamson County, TX (identified by COUNTYFP = '491' and STATEFP = '48') overlaps the largest ZCTA area? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='491' GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.088, "row_count": 1, "result": [["48491020900"]]}
{"id": "L2_0122", "question": "How many schools in San Antonio, TX (identified by CITY = 'SAN ANTONIO' and STATEFP = '48') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND a.CITY='SAN ANTONIO' AND ST_IsValid(b.geometry);", "elapsed": 2.369, "row_count": 1, "result": [[668]]}
{"id": "L2_0123", "question": "Which census_tract in Leon County, FL (identified by COUNTYFP = '073' and STATEFP = '12') overlaps the largest area with other census_tract polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN census_tracts b ON ST_Overlaps(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='073' AND a.GEOID < b.GEOID GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 1.525, "row_count": 1, "result": [["12073002701"]]}
{"id": "L2_0124", "question": "How many census_tracts in St. Tammany Parish, LA (identified by COUNTYFP = '103' and STATEFP = '22') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP='22' AND a.COUNTYFP='103' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.382, "row_count": 1, "result": [[41]]}
{"id": "L2_0125", "question": "Which census_tract in Galveston, TX (identified by CITY = 'GALVESTON' and STATEFP = '48') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND a.CITY='GALVESTON' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.223, "row_count": 1, "result": [["48167724300"]]}
{"id": "L2_0126", "question": "How many hospitals in Plano, TX (identified by CITY = 'PLANO' and STATEFP = '48') intersect ZCTA polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Intersects(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND a.CITY='PLANO' AND ST_IsValid(b.geometry);", "elapsed": 0.192, "row_count": 1, "result": [[18]]}
{"id": "L2_0127", "question": "How many census_tracts in Palm Beach County, FL (identified by COUNTYFP = '099' and STATEFP = '12') contain floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Contains(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='099' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.38, "row_count": 1, "result": [[261]]}
{"id": "L2_0128", "question": "Which census_tract in Dallas County, TX (identified by COUNTYFP = '113' and STATEFP = '48') overlaps the largest total ZCTA area? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='113' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.391, "row_count": 1, "result": [["48113016903"]]}
{"id": "L2_0129", "question": "How many census_tracts in Cameron Parish, LA (identified by COUNTYFP = '023' and STATEFP = '22') intersect floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='22' AND a.COUNTYFP='023' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.392, "row_count": 1, "result": [[5]]}
{"id": "L2_0130", "question": "How many hospitals in Orlando, FL (identified by CITY = 'ORLANDO' and STATEFP = '12') are within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='12' AND a.CITY='ORLANDO' AND ST_IsValid(b.geometry);", "elapsed": 2.319, "row_count": 1, "result": [[14]]}
{"id": "L2_0131", "question": "How many census_tracts in Harris County, TX (identified by COUNTYFP = '201' and STATEFP = '48') intersect other census_tract polygons within the same county (excluding self-intersections)?", "sql": "WITH valid_tracts AS (SELECT GEOID, geometry AS geom FROM census_tracts WHERE STATEFP='48' AND COUNTYFP='201' AND ST_IsValid(geometry)) SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM valid_tracts a JOIN valid_tracts b ON ST_Intersects(a.geom, b.geom) WHERE a.GEOID < b.GEOID;", "elapsed": 0.668, "row_count": 1, "result": [[1077]]}
{"id": "L2_0132", "question": "How many census_tracts in Dallas County, TX (identified by COUNTYFP = '113' and STATEFP = '48') intersect other census_tract polygons within the same county (excluding self-intersections)?", "sql": "WITH valid_tracts AS (SELECT GEOID, geometry AS geom FROM census_tracts WHERE STATEFP='48' AND COUNTYFP='113' AND ST_IsValid(geometry)) SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM valid_tracts a JOIN valid_tracts b ON ST_Intersects(a.geom, b.geom) WHERE a.GEOID < b.GEOID;", "elapsed": 0.249, "row_count": 1, "result": [[591]]}
{"id": "L2_0133", "question": "How many census_tracts in Orleans Parish, LA (identified by COUNTYFP = '071' and STATEFP = '22') intersect other census_tract polygons within the same county (excluding self-intersections)?", "sql": "WITH valid_tracts AS (SELECT GEOID, geometry AS geom FROM census_tracts WHERE STATEFP='22' AND COUNTYFP='071' AND ST_IsValid(geometry)) SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM valid_tracts a JOIN valid_tracts b ON ST_Intersects(a.geom,b.geom) WHERE a.GEOID < b.GEOID;", "elapsed": 0.04, "row_count": 1, "result": [[169]]}
{"id": "L2_0134", "question": "Which census_tract in Orange County, FL (identified by COUNTYFP = '095' and STATEFP = '12') contains the most ZCTA polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Contains(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='095' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY COUNT(DISTINCT b.GEOID) DESC LIMIT 1;", "elapsed": 0.248, "row_count": 1, "result": [["12095017902"]]}
{"id": "L2_0135", "question": "How many census_tracts in Montgomery County, TX (identified by COUNTYFP = '339' and STATEFP = '48') are completely within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry,b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='339' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.405, "row_count": 1, "result": [[1]]}
{"id": "L2_0136", "question": "How many ZCTA polygons intersect census_tracts in East Baton Rouge Parish, LA (identified by COUNTYFP = '033' and STATEFP = '22')?", "sql": "SELECT COUNT(DISTINCT b.GEOID) AS num_zcta FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='22' AND a.COUNTYFP='033';", "elapsed": 0.049, "row_count": 1, "result": [[38]]}
{"id": "L2_0137", "question": "How many schools in Tampa, FL (identified by CITY = 'TAMPA' and STATEFP = '12') lie within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN census_tracts b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='12' AND UPPER(a.CITY)='TAMPA' AND ST_IsValid(b.geometry);", "elapsed": 0.229, "row_count": 1, "result": [[268]]}
{"id": "L2_0138", "question": "Which census_tract in El Paso County, TX (identified by COUNTYFP = '141' and STATEFP = '48') overlaps the largest number of ZCTA polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='141' GROUP BY a.GEOID ORDER BY COUNT(DISTINCT b.GEOID) DESC LIMIT 1;", "elapsed": 0.054, "row_count": 1, "result": [["48141010101"]]}
{"id": "L2_0139", "question": "How many hospitals in Miami, FL (identified by CITY = 'MIAMI' and STATEFP = '12') are located within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN census_tracts b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='12' AND UPPER(a.CITY)='MIAMI' AND ST_IsValid(b.geometry);", "elapsed": 0.218, "row_count": 1, "result": [[20]]}
{"id": "L2_0140", "question": "How many schools in Galveston, TX (identified by CITY = 'GALVESTON' and STATEFP = '48') lie within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND UPPER(a.CITY)='GALVESTON' AND ST_IsValid(b.geometry);", "elapsed": 2.355, "row_count": 1, "result": [[20]]}
{"id": "L2_0141", "question": "Which census_tract in Slidell, LA (identified by CITY = 'SLIDELL' and STATEFP = '22') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND a.CITY='SLIDELL' GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.042, "row_count": 1, "result": [["22103041002"]]}
{"id": "L2_0142", "question": "How many census_tracts in Leon County, FL (identified by COUNTYFP = '073' and STATEFP = '12') are within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='073' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.333, "row_count": 1, "result": [[2]]}
{"id": "L2_0143", "question": "How many hospitals in Baton Rouge, LA (identified by CITY = 'BATON ROUGE' and STATEFP = '22') are located in ZCTA polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND a.CITY='BATON ROUGE' AND ST_IsValid(b.geometry);", "elapsed": 0.192, "row_count": 1, "result": [[20]]}
{"id": "L2_0144", "question": "How many census_tracts in Travis County, TX (identified by COUNTYFP = '453' and STATEFP = '48') intersect floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='453';", "elapsed": 0.564, "row_count": 1, "result": [[290]]}
{"id": "L2_0145", "question": "Which census_tract in Tampa, FL (identified by CITY = 'TAMPA' and STATEFP = '12') contains the largest number of schools? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND a.CITY='TAMPA' GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.05, "row_count": 1, "result": [["12057010402"]]}
{"id": "L2_0146", "question": "How many schools in Austin, TX (identified by CITY = 'AUSTIN' and STATEFP = '48') are within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND UPPER(a.CITY)='AUSTIN' AND ST_IsValid(b.geometry);", "elapsed": 2.339, "row_count": 1, "result": [[392]]}
{"id": "L2_0147", "question": "Which census_tract in Bexar County, TX (identified by COUNTYFP = '029' and STATEFP = '48') overlaps the largest number of ZCTA polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='029' GROUP BY a.GEOID ORDER BY COUNT(DISTINCT b.GEOID) DESC LIMIT 1;", "elapsed": 0.328, "row_count": 1, "result": [["48029131802"]]}
{"id": "L2_0148", "question": "How many schools in Austin, TX (identified by CITY = 'AUSTIN' and STATEFP = '48') lie within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND UPPER(a.CITY)='AUSTIN' AND ST_IsValid(b.geometry);", "elapsed": 2.319, "row_count": 1, "result": [[392]]}
{"id": "L2_0149", "question": "Which ZCTA in Miami, FL (identified by CITY = 'MIAMI' and STATEFP = '12') contains the largest number of hospitals? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND a.CITY='MIAMI' GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.024, "row_count": 1, "result": [["33136"]]}
{"id": "L2_0150", "question": "Which census_tract in Sugar Land, TX (identified by CITY = 'SUGAR LAND' and STATEFP = '48') has the largest number of hospitals within its boundary? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND a.CITY='SUGAR LAND' GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.037, "row_count": 1, "result": [["48157673902"]]}
{"id": "L3_0001", "question": "In Texas (STATEFP 48), what is the average non-null number of observed or modeled riverine flood events weighted by the non-null estimated percent of households with no vehicle among census tracts that have NFIP claims?", "sql": "SELECT SUM(n.RFLD_EVNTS * s.EP_NOVEH) / SUM(s.EP_NOVEH) AS weighted_avg_events FROM (SELECT DISTINCT GEOID, STATEFP FROM claims WHERE STATEFP = '48') cl JOIN nri n ON cl.GEOID = n.GEOID JOIN svi s ON s.GEOID = cl.GEOID WHERE n.RFLD_EVNTS IS NOT NULL AND s.EP_NOVEH IS NOT NULL;", "elapsed": 0.089, "row_count": 1, "result": [[93.17169105846224]]}
{"id": "L3_0002", "question": "In Florida (STATEFP 12), list the 5 census tracts with the highest population-weighted combined score of NRI total expected annual loss for riverine flooding and its average annual flood event frequency among tracts with NFIP claims.", "sql": "SELECT cl.GEOID FROM (SELECT DISTINCT GEOID, STATEFP FROM claims WHERE STATEFP = '12') cl JOIN nri n ON cl.GEOID = n.GEOID JOIN cre cr ON cr.GEOID = cl.GEOID WHERE n.RFLD_EALT IS NOT NULL AND n.RFLD_AFREQ IS NOT NULL AND cr.POPUNI > 0 GROUP BY cl.GEOID ORDER BY SUM((n.RFLD_EALT + n.RFLD_AFREQ) * cr.POPUNI) / SUM(cr.POPUNI) DESC LIMIT 5;", "elapsed": 0.036, "row_count": 5, "result": [["48201420900"], ["12086011500"], ["48167725600"], ["22033002801"], ["12086019600"]]}
{"id": "L3_0003", "question": "In Louisiana (STATEFP 22), how many census tracts with NFIP claims have both above-average total expected annual loss and above-median annual flood frequency for riverine flooding?", "sql": "WITH avg_loss AS (SELECT AVG(CAST(RFLD_EALT AS DOUBLE)) AS avg_ealt FROM nri WHERE GEOID LIKE '22%'), median_freq AS (SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY RFLD_AFREQ) AS med_afreq FROM nri WHERE GEOID LIKE '22%') SELECT COUNT(DISTINCT cl.GEOID) AS num_high_risk_tracts FROM (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '22%') cl JOIN nri n ON cl.GEOID = n.GEOID JOIN cre cr ON cl.GEOID = cr.GEOID, avg_loss, median_freq WHERE n.RFLD_EALT > avg_loss.avg_ealt AND n.RFLD_AFREQ > median_freq.med_afreq;", "elapsed": 0.235, "row_count": 1, "result": [[137]]}
{"id": "L3_0004", "question": "Which 3 Texas counties (STATEFP 48) have the highest total non-null NFIP building payouts weighted by the non-null historical loss ratio for buildings due to coastal flooding? Return their county names.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' AND cl.amountPaidOnBuildingClaim IS NOT NULL AND n.CFLD_HLRB IS NOT NULL AND n.CFLD_HLRB BETWEEN 0 AND 1 GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE) * CAST(n.CFLD_HLRB AS DOUBLE)) DESC LIMIT 3;", "elapsed": 0.038, "row_count": 3, "result": [["Cameron"], ["Harris"], ["Nueces"]]}
{"id": "L3_0005", "question": "In Harris County, TX (GEOID 48201), among tracts that have NFIP claims, what is the average non-null expected annual coastal flood loss per capita based on SVI total population?", "sql": "SELECT AVG(n.CFLD_EALB / CAST(s.E_TOTPOP AS DOUBLE)) AS avg_loss_per_capita FROM (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '48201%') cl JOIN nri n ON cl.GEOID = n.GEOID JOIN svi s ON s.GEOID = cl.GEOID WHERE n.CFLD_EALB IS NOT NULL AND s.E_TOTPOP > 0;", "elapsed": 0.034, "row_count": 1, "result": [[7.842180509973438]]}
{"id": "L3_0006", "question": "Which 3 Louisiana counties (STATEFP 22) have the largest number of census tracts that have NFIP claims and above-average expected affected land area due to riverine flooding?", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID JOIN county c ON LEFT(cl.GEOID,5)=c.GEOID WHERE c.STATEFP='22' AND n.RFLD_EXP_AREA > (SELECT AVG(RFLD_EXP_AREA) FROM nri WHERE GEOID LIKE '22%') GROUP BY c.NAME ORDER BY COUNT(DISTINCT cl.GEOID) DESC LIMIT 3;", "elapsed": 0.019, "row_count": 3, "result": [["Vermilion"], ["Iberia"], ["St. Landry"]]}
{"id": "L3_0007", "question": "In Florida (STATEFP 12), what is the average ratio between non-null NFIP building claim payouts and non-null coastal flood expected annual building loss, weighted by the non-null estimated percent of households with no vehicle?", "sql": "SELECT SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE) / NULLIF(n.CFLD_EALB, 0) * s.EP_NOVEH) / SUM(s.EP_NOVEH) AS weighted_avg_payout_loss_ratio FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID JOIN svi s ON s.GEOID = cl.GEOID WHERE cl.STATEFP = '12' AND cl.amountPaidOnBuildingClaim IS NOT NULL AND n.CFLD_EALB IS NOT NULL AND s.EP_NOVEH IS NOT NULL;", "elapsed": 0.081, "row_count": 1, "result": [[17957.01460600447]]}
{"id": "L3_0008", "question": "List the 5 Texas (STATEFP 48) census tracts with the highest ratio of NRI riverine expected annual building loss to total housing units among tracts with NFIP claims.", "sql": "SELECT cl.GEOID FROM (SELECT DISTINCT GEOID, STATEFP FROM claims WHERE STATEFP = '48') cl JOIN nri n ON cl.GEOID = n.GEOID JOIN svi s ON s.GEOID = cl.GEOID WHERE n.RFLD_EALB IS NOT NULL AND s.E_HU > 0 ORDER BY (n.RFLD_EALB / s.E_HU) DESC LIMIT 5;", "elapsed": 0.036, "row_count": 5, "result": [["48201343601"], ["48167724000"], ["48201980000"], ["48167724500"], ["48361020300"]]}
{"id": "L3_0009", "question": "List the 5 Louisiana (STATEFP 22) counties ranked by the highest total NFIP payouts per capita using CRE population estimates.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN cre cr ON cl.GEOID = cr.GEOID JOIN county c ON LEFT(cl.GEOID,5) = c.GEOID WHERE c.STATEFP = '22' AND cr.POPUNI > 0 AND cl.amountPaidOnBuildingClaim IS NOT NULL GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) / SUM(CAST(cr.POPUNI AS DOUBLE)) DESC LIMIT 5;", "elapsed": 0.044, "row_count": 5, "result": [["Cameron"], ["Plaquemines"], ["St. Bernard"], ["Orleans"], ["St. Helena"]]}
{"id": "L3_0010", "question": "In Texas (STATEFP 48), what is the average population-weighted riverine flood risk score among tracts that have NFIP claims and CRE data?", "sql": "SELECT SUM(n.RFLD_RISKS * cr.POPUNI) / SUM(cr.POPUNI) AS weighted_risk FROM (SELECT DISTINCT GEOID, STATEFP FROM claims WHERE STATEFP='48') cl JOIN nri n ON cl.GEOID = n.GEOID JOIN cre cr ON cr.GEOID = cl.GEOID WHERE n.RFLD_RISKS IS NOT NULL AND cr.POPUNI > 0;", "elapsed": 0.028, "row_count": 1, "result": [[69.30237734469767]]}
{"id": "L3_0011", "question": "In Texas (STATEFP 48), what is the population-weighted average coastal flood risk score of census tracts that have NFIP claims and appear in the CRE dataset?", "sql": "SELECT SUM(n.CFLD_RISKS * cr.POPUNI) / SUM(cr.POPUNI) AS weighted_avg_coastal_risk FROM (SELECT DISTINCT GEOID, STATEFP FROM claims WHERE STATEFP='48') cl JOIN nri n ON cl.GEOID = n.GEOID JOIN cre cr ON cr.GEOID = cl.GEOID WHERE n.CFLD_RISKS IS NOT NULL AND cr.POPUNI > 0;", "elapsed": 0.018, "row_count": 1, "result": [[31.416541741446466]]}
{"id": "L3_0012", "question": "Which 5 Florida (STATEFP 12) counties have the highest average riverine flood risk among tracts that also appear in the SVI and NRI datasets?", "sql": "SELECT c.NAME AS county_name FROM county c JOIN svi s ON LEFT(s.GEOID,5)=c.GEOID JOIN nri n ON s.GEOID = n.GEOID WHERE c.STATEFP='12' AND n.RFLD_RISKS IS NOT NULL GROUP BY c.NAME ORDER BY AVG(n.RFLD_RISKS) DESC LIMIT 5;", "elapsed": 0.01, "row_count": 5, "result": [["Calhoun"], ["Lafayette"], ["Dixie"], ["Washington"], ["Holmes"]]}
{"id": "L3_0013", "question": "How many Louisiana (STATEFP 22) census tracts with NFIP claims have both overall SVI relative vulnerability percentile across all themes above 0.8 and CRE population exceeding 10,000?", "sql": "SELECT COUNT(DISTINCT cl.GEOID) AS num_tracts FROM (SELECT DISTINCT GEOID, STATEFP FROM claims WHERE STATEFP='22') cl JOIN svi s ON cl.GEOID = s.GEOID JOIN cre cr ON cl.GEOID = cr.GEOID WHERE s.RPL_THEMES > 0.8 AND cr.POPUNI > 10000;", "elapsed": 0.028, "row_count": 1, "result": [[1]]}
{"id": "L3_0014", "question": "List the 5 Texas (STATEFP 48) counties with the greatest number of hospitals located in census tracts that also appear in the CRE dataset and have population exceeding 5,000.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID JOIN cre cr ON LEFT(cr.GEOID,5) = c.GEOID WHERE c.STATEFP='48' AND cr.POPUNI > 5000 GROUP BY c.NAME ORDER BY COUNT(DISTINCT h.HOSPITAL_ID) DESC LIMIT 5;", "elapsed": 0.01, "row_count": 5, "result": [["Harris"], ["Tarrant"], ["Bexar"], ["Dallas"], ["Collin"]]}
{"id": "L3_0015", "question": "In Florida (STATEFP 12), what is the average NFIP building payout per claim tract among tracts that also appear in the NRI and SVI datasets?", "sql": "SELECT AVG(avg_payout) AS avg_building_payout FROM (SELECT cl.GEOID, AVG(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) AS avg_payout FROM claims cl JOIN nri n ON cl.GEOID=n.GEOID JOIN svi s ON s.GEOID=cl.GEOID WHERE cl.STATEFP='12' AND cl.amountPaidOnBuildingClaim IS NOT NULL GROUP BY cl.GEOID) t;", "elapsed": 0.041, "row_count": 1, "result": [[27950.176495490767]]}
{"id": "L3_0016", "question": "Which 5 Louisiana (STATEFP 22) counties have the highest ratio of total NFIP building payouts to CRE population among tracts present in the NRI dataset?", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN nri n ON cl.GEOID=n.GEOID JOIN cre cr ON cl.GEOID=cr.GEOID JOIN county c ON LEFT(cl.GEOID,5)=c.GEOID WHERE c.STATEFP='22' AND cr.POPUNI>0 AND cl.amountPaidOnBuildingClaim IS NOT NULL GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE))/SUM(cr.POPUNI) DESC LIMIT 5;", "elapsed": 0.058, "row_count": 5, "result": [["Cameron"], ["Plaquemines"], ["St. Bernard"], ["Orleans"], ["St. Helena"]]}
{"id": "L3_0017", "question": "For Texas (STATEFP 48), what is the average SVI overall vulnerability percentile among tracts that have NFIP claims and NRI records?", "sql": "SELECT AVG(s.RPL_THEMES) AS avg_vulnerability FROM (SELECT DISTINCT GEOID, STATEFP FROM claims WHERE STATEFP='48') cl JOIN nri n ON cl.GEOID=n.GEOID JOIN svi s ON s.GEOID=cl.GEOID WHERE s.RPL_THEMES IS NOT NULL;", "elapsed": 0.041, "row_count": 1, "result": [[-2.5120805983478447]]}
{"id": "L3_0018", "question": "List the 5 Texas (STATEFP 48) counties with the highest number of hospitals located in census tracts that also appear in the NRI dataset and have above-average riverine flood risk.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID JOIN nri n ON LEFT(n.GEOID,5) = c.GEOID WHERE c.STATEFP='48' AND n.RFLD_RISKS > (SELECT AVG(RFLD_RISKS) FROM nri WHERE GEOID LIKE '48%') GROUP BY c.NAME ORDER BY COUNT(DISTINCT h.HOSPITAL_ID) DESC LIMIT 5;", "elapsed": 0.016, "row_count": 5, "result": [["Harris"], ["Tarrant"], ["Bexar"], ["Dallas"], ["Collin"]]}
{"id": "L3_0019", "question": "In Florida (STATEFP 12), what is the population-weighted average riverine flood risk score among tracts that appear in both CRE and NRI datasets and have NFIP claims?", "sql": "SELECT SUM(n.RFLD_RISKS * cr.POPUNI)/SUM(cr.POPUNI) AS weighted_riverine_risk FROM (SELECT DISTINCT GEOID, STATEFP FROM claims WHERE STATEFP='12') cl JOIN nri n ON cl.GEOID=n.GEOID JOIN cre cr ON cr.GEOID=cl.GEOID WHERE n.RFLD_RISKS IS NOT NULL AND cr.POPUNI>0;", "elapsed": 0.019, "row_count": 1, "result": [[59.38665118844555]]}
{"id": "L3_0020", "question": "Which 3 Texas counties (STATEFP 48) have the largest number of hospitals located within topologically valid census tracts according to the census_tracts table? Return their county names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN census_tracts t ON LEFT(t.GEOID, 5) = h.COUNTYFIPS JOIN county c ON c.GEOID = h.COUNTYFIPS WHERE c.STATEFP = '48' AND ST_IsValid(t.geometry) GROUP BY c.NAME ORDER BY COUNT(DISTINCT h.HOSPITAL_ID) DESC LIMIT 3;", "elapsed": 0.231, "row_count": 3, "result": [["Harris"], ["Tarrant"], ["Bexar"]]}
{"id": "L3_0021", "question": "Among Texas (48), Florida (12), and Louisiana (22), which state has the highest average NRI riverine flood risk among tracts with NFIP claims and SVI records?", "sql": "SELECT cl.STATEFP FROM (SELECT DISTINCT GEOID, STATEFP FROM claims) cl JOIN nri n ON cl.GEOID = n.GEOID JOIN svi s ON s.GEOID = cl.GEOID WHERE cl.STATEFP IN ('48','12','22') AND n.RFLD_RISKS IS NOT NULL GROUP BY cl.STATEFP ORDER BY AVG(n.RFLD_RISKS) DESC LIMIT 1;", "elapsed": 0.075, "row_count": 1, "result": [["22"]]}
{"id": "L3_0022", "question": "In Florida (STATEFP 12), what is the average total NFIP building payout per 1,000 residents using CRE population counts for tracts present in the NRI dataset?", "sql": "SELECT (SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) / SUM(cr.POPUNI)) * 1000 AS payout_per_thousand FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID JOIN cre cr ON cl.GEOID = cr.GEOID WHERE cl.STATEFP='12' AND cl.amountPaidOnBuildingClaim IS NOT NULL AND cr.POPUNI>0;", "elapsed": 0.035, "row_count": 1, "result": [[14076.136444944716]]}
{"id": "L3_0023", "question": "For Texas (STATEFP 48), which 5 counties have the largest difference between average NRI coastal and riverine flood risk among tracts with NFIP claims?", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID JOIN county c ON LEFT(cl.GEOID,5)=c.GEOID WHERE c.STATEFP='48' GROUP BY c.NAME ORDER BY (AVG(n.CFLD_RISKS) - AVG(n.RFLD_RISKS)) DESC LIMIT 5;", "elapsed": 0.033, "row_count": 5, "result": [["Nueces"], ["Calhoun"], ["Aransas"], ["Fort Bend"], ["Jackson"]]}
{"id": "L3_0024", "question": "In Louisiana (STATEFP 22), what is the percentage of NFIP claims located in tracts with SVI overall vulnerability above 0.8 and NRI riverine risk above 0.7?", "sql": "SELECT 100.0 * COUNT(*) / (SELECT COUNT(*) FROM claims WHERE STATEFP='22') AS pct_high_risk_claims FROM claims cl JOIN nri n ON cl.GEOID=n.GEOID JOIN svi s ON s.GEOID=cl.GEOID WHERE cl.STATEFP='22' AND s.RPL_THEMES>0.8 AND n.RFLD_RISKS>0.7;", "elapsed": 0.022, "row_count": 1, "result": [[18.575996970649]]}
{"id": "L3_0025", "question": "List the 5 Florida (STATEFP 12) counties with the lowest average NRI coastal flood expected annual building loss per capita, using CRE population data.", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN cre cr ON n.GEOID=cr.GEOID JOIN county c ON LEFT(n.GEOID,5)=c.GEOID WHERE c.STATEFP='12' AND cr.POPUNI>0 AND n.CFLD_EALB IS NOT NULL GROUP BY c.NAME ORDER BY SUM(n.CFLD_EALB)/SUM(cr.POPUNI) ASC LIMIT 5;", "elapsed": 0.007, "row_count": 5, "result": [["Union"], ["Alachua"], ["Baker"], ["Holmes"], ["Seminole"]]}
{"id": "L3_0026", "question": "For Texas (STATEFP 48), what is the average year of NFIP losses among tracts that appear in both NRI and SVI datasets?", "sql": "SELECT AVG(EXTRACT(YEAR FROM cl.dateOfLoss)) AS avg_loss_year FROM claims cl JOIN nri n ON cl.GEOID=n.GEOID JOIN svi s ON s.GEOID=cl.GEOID WHERE cl.STATEFP='48' AND cl.dateOfLoss IS NOT NULL;", "elapsed": 0.096, "row_count": 1, "result": [[2005.2360789535696]]}
{"id": "L3_0027", "question": "Which 5 Louisiana (STATEFP 22) counties have the highest average SVI percentile among tracts with above-average NRI riverine flood risk?", "sql": "SELECT c.NAME AS county_name FROM county c JOIN nri n ON LEFT(n.GEOID,5)=c.GEOID JOIN svi s ON s.GEOID=n.GEOID WHERE c.STATEFP='22' AND n.RFLD_RISKS > (SELECT AVG(RFLD_RISKS) FROM nri WHERE GEOID LIKE '22%') GROUP BY c.NAME ORDER BY AVG(s.RPL_THEMES) DESC LIMIT 5;", "elapsed": 0.012, "row_count": 5, "result": [["Grant"], ["Bienville"], ["St. Helena"], ["Madison"], ["Caldwell"]]}
{"id": "L3_0028", "question": "In Florida (STATEFP 12), what is the average ratio of NFIP building payouts to Expected annual loss for buildings due to coastal flooding across tracts with CRE population above 5,000?", "sql": "SELECT AVG(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)/NULLIF(n.CFLD_EALB,0)) AS avg_ratio FROM claims cl JOIN nri n ON cl.GEOID=n.GEOID JOIN cre cr ON cr.GEOID=cl.GEOID WHERE cl.STATEFP='12' AND cl.amountPaidOnBuildingClaim IS NOT NULL AND n.CFLD_EALB>0 AND cr.POPUNI>5000;", "elapsed": 0.027, "row_count": 1, "result": [[35997.577999996174]]}
{"id": "L3_0029", "question": "Which 5 Texas (STATEFP 48) counties have the highest total number of NFIP claims located in tracts where SVI overall vulnerability exceeds 0.75?", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN svi s ON cl.GEOID=s.GEOID JOIN county c ON LEFT(cl.GEOID,5)=c.GEOID WHERE c.STATEFP='48' AND s.RPL_THEMES>0.75 GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 5;", "elapsed": 0.025, "row_count": 5, "result": [["Harris"], ["Galveston"], ["Jefferson"], ["Brazoria"], ["Cameron"]]}
{"id": "L3_0030", "question": "In Louisiana (STATEFP 22), what is the average overall relative vulnerability percentile across all themes among census tracts that have NFIP claims and appear in the CRE dataset?", "sql": "SELECT AVG(s.RPL_THEMES) AS avg_vulnerability FROM (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '22%') cl JOIN svi s ON cl.GEOID = s.GEOID JOIN cre cr ON cl.GEOID = cr.GEOID WHERE s.RPL_THEMES BETWEEN 0 AND 100;", "elapsed": 0.03, "row_count": 1, "result": [[0.5791805877803557]]}
{"id": "L3_0031", "question": "Which state among Texas (48), Florida (12), and Louisiana (22) has the lowest population-weighted average SVI vulnerability percentile using CRE population data?", "sql": "SELECT c.STATEFP FROM county c JOIN svi s ON LEFT(s.GEOID,5)=c.GEOID JOIN cre cr ON s.GEOID=cr.GEOID WHERE c.STATEFP IN ('48','12','22') AND s.RPL_THEMES IS NOT NULL AND cr.POPUNI>0 GROUP BY c.STATEFP ORDER BY SUM(s.RPL_THEMES*cr.POPUNI)/SUM(cr.POPUNI) ASC LIMIT 1;", "elapsed": 0.01, "row_count": 1, "result": [["48"]]}
{"id": "L3_0032", "question": "In Florida (STATEFP 12), what percentage of tracts with NFIP claims have both above-median NRI coastal flood risk and below-average SVI vulnerability?", "sql": "WITH stats AS (SELECT AVG(RPL_THEMES) AS avg_svi FROM svi WHERE GEOID LIKE '12%'), med AS (SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY CFLD_RISKS) AS med_risk FROM nri WHERE GEOID LIKE '12%') SELECT 100.0 * COUNT(DISTINCT cl.GEOID) / (SELECT COUNT(DISTINCT GEOID) FROM claims WHERE STATEFP='12') AS pct_qualified FROM (SELECT DISTINCT GEOID, STATEFP FROM claims WHERE STATEFP='12') cl JOIN nri n ON cl.GEOID=n.GEOID JOIN svi s ON s.GEOID=cl.GEOID, stats, med WHERE n.CFLD_RISKS>med.med_risk AND s.RPL_THEMES<stats.avg_svi;", "elapsed": 0.035, "row_count": 1, "result": [[0.07446016381236038]]}
{"id": "L3_0033", "question": "List the 5 Texas (STATEFP 48) counties with the highest number of NFIP claims per 10,000 residents, based on CRE population counts.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID,5)=c.GEOID JOIN cre cr ON cl.GEOID=cr.GEOID WHERE c.STATEFP='48' AND cr.POPUNI>0 GROUP BY c.NAME ORDER BY (COUNT(*)*10000.0)/SUM(cr.POPUNI) DESC LIMIT 5;", "elapsed": 0.033, "row_count": 5, "result": [["Kenedy"], ["McMullen"], ["Terrell"], ["Stonewall"], ["Dimmit"]]}
{"id": "L3_0034", "question": "In Louisiana (STATEFP 22), what is the correlation between NRI riverine flood risk and SVI vulnerability across tracts with NFIP claims?", "sql": "SELECT CORR(n.RFLD_RISKS, s.RPL_THEMES) AS correlation_value FROM (SELECT DISTINCT GEOID, STATEFP FROM claims WHERE STATEFP='22') cl JOIN nri n ON cl.GEOID=n.GEOID JOIN svi s ON s.GEOID=cl.GEOID WHERE n.RFLD_RISKS IS NOT NULL AND s.RPL_THEMES IS NOT NULL;", "elapsed": 0.032, "row_count": 1, "result": [[0.09719961889397033]]}
{"id": "L3_0035", "question": "Which 5 Florida (STATEFP 12) counties have the lowest average NFIP building payout per 10,000 residents using CRE population data?", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID,5)=c.GEOID JOIN cre cr ON cl.GEOID=cr.GEOID WHERE c.STATEFP='12' AND cl.amountPaidOnBuildingClaim IS NOT NULL AND cr.POPUNI>0 GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE))/SUM(cr.POPUNI) ASC LIMIT 5;", "elapsed": 0.043, "row_count": 5, "result": [["Jefferson"], ["Hendry"], ["Gadsden"], ["Okeechobee"], ["Gilchrist"]]}
{"id": "L3_0036", "question": "For Texas (STATEFP 48), what is the proportion of total NFIP payouts occurring in tracts where the NRI riverine flood risk exceeds 0.7?", "sql": "SELECT SUM(CASE WHEN n.RFLD_RISKS>0.7 THEN CAST(cl.amountPaidOnBuildingClaim AS DOUBLE) ELSE 0 END)/SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) AS payout_ratio FROM claims cl JOIN nri n ON cl.GEOID=n.GEOID JOIN svi s ON s.GEOID=cl.GEOID WHERE cl.STATEFP='48' AND cl.amountPaidOnBuildingClaim IS NOT NULL AND n.RFLD_RISKS IS NOT NULL;", "elapsed": 0.035, "row_count": 1, "result": [[0.9427088852891017]]}
{"id": "L3_0037", "question": "List the 5 Louisiana (STATEFP 22) counties with the largest gap between average NRI riverine risk and coastal risk scores among tracts that appear in the SVI dataset.", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN county c ON LEFT(n.GEOID,5)=c.GEOID JOIN svi s ON s.GEOID=n.GEOID WHERE c.STATEFP='22' GROUP BY c.NAME ORDER BY (AVG(n.RFLD_RISKS)-AVG(n.CFLD_RISKS)) DESC LIMIT 5;", "elapsed": 0.024, "row_count": 5, "result": [["Concordia"], ["Evangeline"], ["Avoyelles"], ["East Feliciana"], ["Pointe Coupee"]]}
{"id": "L3_0038", "question": "In Texas (STATEFP 48), what is the average SVI vulnerability percentile among tracts with NFIP claims and CRE population above the state median?", "sql": "WITH med AS (SELECT PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY POPUNI) AS med_pop FROM cre WHERE GEOID LIKE '48%') SELECT AVG(s.RPL_THEMES) AS avg_vulnerability FROM (SELECT DISTINCT GEOID, STATEFP FROM claims WHERE STATEFP='48') cl JOIN svi s ON cl.GEOID=s.GEOID JOIN cre cr ON s.GEOID=cr.GEOID, med WHERE cr.POPUNI>med.med_pop;", "elapsed": 0.181, "row_count": 1, "result": [[0.18688350730688935]]}
{"id": "L3_0039", "question": "Which 5 Florida (STATEFP 12) counties have the highest total CRE population residing in tracts with NRI coastal flood risk greater than 0.6?", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN cre cr ON n.GEOID=cr.GEOID JOIN county c ON LEFT(n.GEOID,5)=c.GEOID WHERE c.STATEFP='12' AND n.CFLD_RISKS>0.6 GROUP BY c.NAME ORDER BY SUM(cr.POPUNI) DESC LIMIT 5;", "elapsed": 0.008, "row_count": 5, "result": [["Miami-Dade"], ["Hillsborough"], ["Duval"], ["Pinellas"], ["Lee"]]}
{"id": "L3_0040", "question": "For Louisiana (STATEFP 22), what is the mean NFIP claim payout per tract weighted by CRE population across tracts with NRI data?", "sql": "SELECT SUM(sub.avg_payout * sub.POPUNI)/SUM(sub.POPUNI) AS weighted_payout FROM (SELECT cl.GEOID, AVG(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) AS avg_payout, cr.POPUNI FROM claims cl JOIN cre cr ON cl.GEOID=cr.GEOID JOIN nri n ON n.GEOID=cl.GEOID WHERE cl.STATEFP='22' AND cl.amountPaidOnBuildingClaim IS NOT NULL GROUP BY cl.GEOID, cr.POPUNI) sub;", "elapsed": 0.038, "row_count": 1, "result": [[35903.74982583567]]}
{"id": "L3_0041", "question": "Which 5 Texas (STATEFP 48) counties show the greatest mismatch between high average NFIP building payouts and low NRI riverine flood risk?", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID JOIN county c ON LEFT(cl.GEOID,5)=c.GEOID WHERE c.STATEFP='48' AND cl.amountPaidOnBuildingClaim IS NOT NULL AND n.RFLD_RISKS IS NOT NULL GROUP BY c.NAME ORDER BY (AVG(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) - AVG(n.RFLD_RISKS)*10000) DESC LIMIT 5;", "elapsed": 0.056, "row_count": 5, "result": [["Hansford"], ["Nueces"], ["Sabine"], ["Kenedy"], ["Franklin"]]}
{"id": "L3_0042", "question": "In Florida (STATEFP 12), what is the ratio of average NFIP building payout to average NRI coastal flood expected annual building loss among tracts with SVI records?", "sql": "SELECT AVG(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) / AVG(n.CFLD_EALB) AS payout_to_loss_ratio FROM claims cl JOIN nri n ON cl.GEOID=n.GEOID JOIN svi s ON s.GEOID=cl.GEOID WHERE cl.STATEFP='12' AND cl.amountPaidOnBuildingClaim IS NOT NULL AND n.CFLD_EALB>0;", "elapsed": 0.033, "row_count": 1, "result": [[1.7179354170140235]]}
{"id": "L3_0043", "question": "Across all Louisiana (STATEFP 22) counties, which 5 have the highest number of tracts where SVI vulnerability is below 0.5 but NFIP payouts exceed $20,000?", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN svi s ON cl.GEOID=s.GEOID JOIN county c ON LEFT(cl.GEOID,5)=c.GEOID WHERE c.STATEFP='22' AND s.RPL_THEMES<0.5 AND CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)>20000 GROUP BY c.NAME ORDER BY COUNT(DISTINCT cl.GEOID) DESC LIMIT 5;", "elapsed": 0.053, "row_count": 5, "result": [["Orleans"], ["Jefferson"], ["East Baton Rouge"], ["St. Tammany"], ["Calcasieu"]]}
{"id": "L3_0044", "question": "In Texas (STATEFP 48), what is the average population-normalized NFIP payout per tract using CRE population and NRI data?", "sql": "SELECT AVG((CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)/NULLIF(cr.POPUNI,0))) AS avg_payout_per_capita FROM claims cl JOIN cre cr ON cl.GEOID=cr.GEOID JOIN nri n ON n.GEOID=cl.GEOID WHERE cl.STATEFP='48' AND cl.amountPaidOnBuildingClaim IS NOT NULL AND cr.POPUNI>0;", "elapsed": 0.037, "row_count": 1, "result": [[15.130699897572063]]}
{"id": "L3_0045", "question": "For Florida (STATEFP 12), list the 5 counties with the highest population-weighted NRI coastal flood risk using CRE data.", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN cre cr ON n.GEOID=cr.GEOID JOIN county c ON LEFT(n.GEOID,5)=c.GEOID WHERE c.STATEFP='12' AND n.CFLD_RISKS IS NOT NULL AND cr.POPUNI>0 GROUP BY c.NAME ORDER BY SUM(n.CFLD_RISKS*cr.POPUNI)/SUM(cr.POPUNI) DESC LIMIT 5;", "elapsed": 0.009, "row_count": 5, "result": [["Franklin"], ["Monroe"], ["Gulf"], ["St. Johns"], ["Dixie"]]}
{"id": "L3_0046", "question": "In Louisiana (STATEFP 22), what is the correlation between NFIP claim payout and CRE population across tracts with NRI riverine risk data?", "sql": "SELECT CORR(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE), cr.POPUNI) AS payout_pop_corr FROM claims cl JOIN cre cr ON cl.GEOID=cr.GEOID JOIN nri n ON n.GEOID=cl.GEOID WHERE cl.STATEFP='22' AND cl.amountPaidOnBuildingClaim IS NOT NULL AND cr.POPUNI>0;", "elapsed": 0.038, "row_count": 1, "result": [[0.00811901390909783]]}
{"id": "L3_0047", "question": "Which 5 Texas (STATEFP 48) counties have the highest number of tracts with both high NRI coastal flood risk (>0.8) and high SVI vulnerability (>0.8)?", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN svi s ON n.GEOID=s.GEOID JOIN county c ON LEFT(n.GEOID,5)=c.GEOID WHERE c.STATEFP='48' AND n.CFLD_RISKS>0.8 AND s.RPL_THEMES>0.8 GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 5;", "elapsed": 0.022, "row_count": 5, "result": [["Harris"], ["Cameron"], ["Galveston"], ["Nueces"], ["Brazoria"]]}
{"id": "L3_0048", "question": "For Florida (STATEFP 12), what is the percentage of total CRE population living in tracts where NRI coastal flood expected annual building loss exceeds 10?", "sql": "SELECT 100.0 * SUM(CASE WHEN n.CFLD_EALB>10 THEN cr.POPUNI ELSE 0 END)/SUM(cr.POPUNI) AS pct_exposed_pop FROM nri n JOIN cre cr ON n.GEOID=cr.GEOID JOIN county c ON LEFT(n.GEOID,5)=c.GEOID WHERE c.STATEFP='12' AND cr.POPUNI>0;", "elapsed": 0.014, "row_count": 1, "result": [[44.06694787655717]]}
{"id": "L3_0049", "question": "Across Louisiana (STATEFP 22), which county has the lowest average NFIP building payout despite above-average NRI flood risk and SVI vulnerability?", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN nri n ON cl.GEOID=n.GEOID JOIN svi s ON s.GEOID=cl.GEOID JOIN county c ON LEFT(cl.GEOID,5)=c.GEOID WHERE c.STATEFP='22' AND n.RFLD_RISKS>(SELECT AVG(RFLD_RISKS) FROM nri WHERE GEOID LIKE '22%') AND s.RPL_THEMES>(SELECT AVG(RPL_THEMES) FROM svi WHERE GEOID LIKE '22%') AND cl.amountPaidOnBuildingClaim IS NOT NULL GROUP BY c.NAME ORDER BY AVG(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) ASC LIMIT 1;", "elapsed": 0.066, "row_count": 1, "result": [["Jackson"]]}
{"id": "L3_0050", "question": "In Texas (STATEFP 48), what fraction of NFIP claim tracts also appear in both the NRI and SVI datasets?", "sql": "SELECT COUNT(*) * 1.0 / (SELECT COUNT(DISTINCT GEOID) FROM claims WHERE STATEFP='48') AS fraction_shared FROM (SELECT DISTINCT cl.GEOID FROM claims cl JOIN nri n ON cl.GEOID=n.GEOID JOIN svi s ON s.GEOID=cl.GEOID WHERE cl.STATEFP='48');", "elapsed": 0.028, "row_count": 1, "result": [[0.773976153447382]]}
{"id": "L4_0001", "question": "What is the average Relative percentile for Theme 1 (Socioeconomic) for census tracts in Texas (STATEFP 48) that intersect a FEMA floodplain polygon?", "sql": "SELECT AVG(v.RPL_THEME1) AS avg_theme1_rank FROM svi v JOIN census_tracts t ON v.GEOID = t.GEOID JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE t.STATEFP='48' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND v.RPL_THEME1 IS NOT NULL AND v.RPL_THEME1 BETWEEN 0 AND 100;", "elapsed": 5.052, "row_count": 1, "result": [[0.543291524199177]]}
{"id": "L4_0002", "question": "Which 5 Florida (STATEFP 12) counties have the highest number of hospitals located inside floodplain zones? Return their names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON LEFT(h.COUNTYFIPS,5)=c.GEOID JOIN floodplain f ON ST_Contains(f.geometry, ST_Point(h.LON, h.LAT)) WHERE c.STATEFP='12' AND ST_IsValid(f.geometry) AND ST_IsValid(c.geometry) GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 5;", "elapsed": 3.08, "row_count": 5, "result": [["Miami-Dade"], ["Broward"], ["Orange"], ["Hillsborough"], ["Duval"]]}
{"id": "L4_0003", "question": "What is the average Normalized coastal flood risk score for all census tracts within Orleans Parish, Louisiana (STATEFP 22, COUNTY NAME 'ORLEANS') that contain at least one hospital?", "sql": "SELECT AVG(n.CFLD_RISKS) AS avg_coastal_risk_score FROM hospitals h JOIN county c ON ST_Contains(c.geometry, ST_Point(h.LON, h.LAT)) JOIN nri n ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.NAME = 'ORLEANS' AND c.STATEFP = '22' AND n.CFLD_RISKS IS NOT NULL AND ST_IsValid(c.geometry);", "elapsed": 0.058, "row_count": 1, "result": [[null]]}
{"id": "L4_0004", "question": "Which 5 Texas (STATEFP 48) counties have the highest average Overall summary percentile rank for all four SVI themes combined among census tracts that intersect FEMA floodplain areas? Return their names.", "sql": "SELECT c.NAME AS county_name FROM county c JOIN census_tracts t ON LEFT(t.GEOID,5)=c.GEOID JOIN svi s ON s.FIPS=t.GEOID JOIN floodplain f ON ST_Intersects(t.geometry,f.geometry) WHERE c.STATEFP='48' AND s.SPL_THEMES IS NOT NULL AND s.SPL_THEMES BETWEEN 0 AND 100 AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) GROUP BY c.NAME ORDER BY AVG(s.SPL_THEMES) DESC LIMIT 5;", "elapsed": 4.914, "row_count": 5, "result": [["Zapata"], ["Willacy"], ["El Paso"], ["Dimmit"], ["Maverick"]]}
{"id": "L4_0005", "question": "Which 5 Texas (STATEFP 12) counties have the highest number of hospitals located inside floodplain zones? Return their names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON LEFT(h.COUNTYFIPS,5)=c.GEOID JOIN floodplain f ON ST_Contains(f.geometry, ST_Point(h.LON, h.LAT)) WHERE c.STATEFP='12' AND ST_IsValid(f.geometry) AND ST_IsValid(c.geometry) GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 5;", "elapsed": 2.313, "row_count": 5, "result": [["Miami-Dade"], ["Broward"], ["Orange"], ["Hillsborough"], ["Duval"]]}
{"id": "L4_0006", "question": "For Louisiana (STATEFP 22), which 5 counties contain the largest number of schools located in floodplain areas?", "sql": "SELECT c.NAME AS county_name FROM schools s JOIN county c ON s.STATEFP=c.STATEFP WHERE c.STATEFP='22' AND EXISTS (SELECT 1 FROM floodplain f WHERE ST_Contains(f.geometry, ST_Point(s.LON, s.LAT)) AND ST_IsValid(f.geometry)) GROUP BY c.NAME ORDER BY COUNT(DISTINCT s.SCHOOL_ID) DESC LIMIT 5;", "elapsed": 2.336, "row_count": 5, "result": [["De Soto"], ["St. Helena"], ["St. Mary"], ["Sabine"], ["Webster"]]}
{"id": "L4_0007", "question": "In Texas (STATEFP 48), how many census tracts with Percentage of individuals with three plus components of social vulnerability higher than 40 intersect FEMA floodplain polygons?", "sql": "SELECT COUNT(*) AS num_high_vuln_tracts FROM cre r JOIN census_tracts t ON r.GEOID=t.GEOID JOIN floodplain f ON ST_Intersects(f.geometry,t.geometry) WHERE LEFT(t.GEOID,2)='48' AND r.PRED3_PE>40 AND r.PRED3_PE BETWEEN 0 AND 100 AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry);", "elapsed": 2.643, "row_count": 1, "result": [[8089]]}
{"id": "L4_0008", "question": "In Florida (STATEFP 12), how many census tracts with Riverine Flood Risk Score greater than 70 intersect FEMA floodplain polygons?", "sql": "SELECT COUNT(*) AS num_high_risk_tracts FROM nri n JOIN census_tracts t ON n.GEOID=t.GEOID JOIN floodplain f ON ST_Intersects(f.geometry,t.geometry) WHERE LEFT(t.GEOID,2)='12' AND n.RFLD_RISKS>70 AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry);", "elapsed": 3.492, "row_count": 1, "result": [[340709]]}
{"id": "L4_0009", "question": "In Orleans Parish (in Louisiana, identified by the left most 5 digits of GEOID, 22071), how many local floodplain polygons intersect census tracts that have NFIP claims?", "sql": "SELECT COUNT(DISTINCT f.GFID) AS num_intersecting_floodplains FROM floodplain f JOIN census_tracts t ON ST_Intersects(f.geometry, t.geometry) WHERE LEFT(t.GEOID,5)='22071' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) AND EXISTS (SELECT 1 FROM claims cl WHERE cl.GEOID=t.GEOID);", "elapsed": 2.423, "row_count": 1, "result": [[5]]}
{"id": "L4_0010", "question": "In Texas (STATEFP 48), which city has the highest number of unique schools located within a county where the Normalized riverine flood risk score is greater than 50? Return its city name in uppercase.", "sql": "SELECT s.CITY AS city_name FROM schools s JOIN county c ON ST_Contains(c.geometry, ST_Point(s.LON, s.LAT)) JOIN nri n ON LEFT(n.GEOID, 5) = c.GEOID WHERE s.STATEFP='48' AND n.RFLD_RISKS > 50 AND ST_IsValid(c.geometry) GROUP BY s.CITY ORDER BY COUNT(DISTINCT s.SCHOOL_ID) DESC LIMIT 1;", "elapsed": 0.405, "row_count": 1, "result": [["HOUSTON"]]}
{"id": "L4_0011", "question": "For Florida (STATEFP 12), what is the average Insurance payout amount (in USD) for structural building damage across all census tracts within counties that contain at least one hospital located inside a FEMA floodplain polygon?", "sql": "SELECT AVG(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) AS avg_county_building_claim FROM hospitals h JOIN floodplain f ON ST_Contains(f.geometry, ST_Point(h.LON, h.LAT)) JOIN claims cl ON LEFT(cl.GEOID, 5) = h.COUNTYFIPS WHERE h.STATEFP='12' AND ST_IsValid(f.geometry) AND cl.amountPaidOnBuildingClaim IS NOT NULL;", "elapsed": 2.281, "row_count": 1, "result": [[41904.07624848125]]}
{"id": "L4_0012", "question": "In Louisiana (STATEFP 22), which 5 counties have the largest number of schools located in census tracts intersecting FEMA floodplain zones?", "sql": "SELECT c.NAME AS county_name FROM schools s JOIN census_tracts t ON ST_Contains(t.geometry, ST_Point(s.LON, s.LAT)) JOIN county c ON LEFT(t.GEOID,5)=c.GEOID JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE c.STATEFP='22' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) GROUP BY c.NAME ORDER BY COUNT(DISTINCT s.SCHOOL_ID) DESC LIMIT 5;", "elapsed": 4.648, "row_count": 5, "result": [["East Baton Rouge"], ["Orleans"], ["Jefferson"], ["Caddo"], ["St. Tammany"]]}
{"id": "L4_0013", "question": "For Florida (STATEFP 12), what is the average relative percentile rank for Summary percentile rank for Theme 1 across all census tracts that contain at least one hospital?", "sql": "SELECT AVG(s.SPL_THEME1) AS avg_svi_theme1 FROM hospitals h JOIN census_tracts t ON ST_Contains(t.geometry, ST_Point(h.LON, h.LAT)) JOIN svi s ON t.GEOID = s.GEOID WHERE h.STATEFP='12' AND ST_IsValid(t.geometry) AND s.SPL_THEME1 IS NOT NULL AND s.SPL_THEME1 BETWEEN 0 AND 100;", "elapsed": 0.223, "row_count": 1, "result": [[2.82332328042328]]}
{"id": "L4_0014", "question": "Among Florida counties (STATEFP 12), which has the greatest number of low-resilience tracts (percentage of individuals with zero components of social vulnerability lower than 10) that intersect FEMA floodplain areas? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM cre r JOIN census_tracts t ON r.GEOID=t.GEOID JOIN county c ON LEFT(t.GEOID,5)=c.GEOID JOIN floodplain f ON ST_Intersects(t.geometry,f.geometry) WHERE c.STATEFP='12' AND r.PRED0_PE<10 AND r.PRED0_PE BETWEEN 0 AND 100 AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 1;", "elapsed": 2.679, "row_count": 1, "result": [["Sarasota"]]}
{"id": "L4_0015", "question": "In Louisiana (STATEFP 22), what is the maximum Insurance payout amount (in USD) for structural building damage (amountPaidOnContentsClaim) across all census tracts that contain at least one hospital?", "sql": "SELECT MAX(CAST(cl.amountPaidOnContentsClaim AS DOUBLE)) AS max_building_claim FROM hospitals h JOIN census_tracts t ON ST_Contains(t.geometry, ST_Point(h.LON, h.LAT)) JOIN claims cl ON cl.GEOID = t.GEOID WHERE h.STATEFP='22' AND ST_IsValid(t.geometry) AND cl.amountPaidOnContentsClaim IS NOT NULL;", "elapsed": 0.241, "row_count": 1, "result": [[500000.0]]}
{"id": "L4_0016", "question": "In Texas (STATEFP 48), which county has the highest total Riverine Flooding Expected Annual Loss for Buildings within FEMA floodplain regions? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN census_tracts t ON n.GEOID=t.GEOID JOIN county c ON LEFT(t.GEOID,5)=c.GEOID JOIN floodplain f ON ST_Intersects(f.geometry, t.geometry) WHERE c.STATEFP='48' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) GROUP BY c.NAME ORDER BY SUM(n.RFLD_EALB) DESC LIMIT 1;", "elapsed": 4.853, "row_count": 1, "result": [["Brazoria"]]}
{"id": "L4_0017", "question": "In Orleans Parish, Louisiana (GEOID prefix 22071), what is the average Underlying continuous numeric riverine flood risk value used to derive the categorical rating and normalized score for all census tracts that intersect FEMA floodplain polygons?", "sql": "SELECT AVG(n.RFLD_RISKV) AS avg_riverine_risk FROM census_tracts t JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) JOIN nri n ON t.GEOID = n.GEOID WHERE LEFT(t.GEOID, 5) = '22071' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND n.RFLD_RISKV IS NOT NULL;", "elapsed": 2.396, "row_count": 1, "result": [[2424.5865462407914]]}
{"id": "L4_0018", "question": "In Louisiana (STATEFP 22), which 2 counties have the most schools located inside both FEMA floodplain and ZCTA polygons? Return their county names.", "sql": "SELECT c.NAME AS county_name FROM schools s JOIN county c ON c.STATEFP='22' AND ST_Contains(c.geometry, ST_Point(s.LON, s.LAT)) WHERE EXISTS (SELECT 1 FROM zcta z JOIN floodplain f ON ST_Intersects(f.geometry, z.geometry) WHERE ST_Contains(z.geometry, ST_Point(s.LON, s.LAT)) AND ST_IsValid(f.geometry) AND ST_IsValid(z.geometry)) AND ST_IsValid(c.geometry) GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 2;", "elapsed": 7.943, "row_count": 2, "result": [["East Baton Rouge"], ["Orleans"]]}
{"id": "L4_0019", "question": "In Texas (STATEFP 48), what is the average percentage of individuals with three or more components of social vulnerability among census tracts that intersect FEMA floodplain polygons?", "sql": "SELECT AVG(r.PRED3_PE) AS avg_high_vulnerability FROM cre r JOIN census_tracts t ON r.GEOID=t.GEOID JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE t.STATEFP ='48' AND r.PRED3_PE BETWEEN 0 AND 100 AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry);", "elapsed": 4.637, "row_count": 1, "result": [[21.75774239276319]]}
{"id": "L4_0020", "question": "Which 5 Florida (STATEFP 12) counties have the largest number of hospitals located within FEMA floodplain regions that overlap census tract boundaries?", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON LEFT(h.COUNTYFIPS,5)=c.GEOID JOIN floodplain f ON ST_Contains(f.geometry, ST_Point(h.LON, h.LAT)) JOIN census_tracts t ON ST_Intersects(f.geometry, t.geometry) WHERE c.STATEFP='12' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) GROUP BY c.NAME ORDER BY COUNT(DISTINCT h.HOSPITAL_ID) DESC LIMIT 5;", "elapsed": 3.81, "row_count": 5, "result": [["Miami-Dade"], ["Broward"], ["Orange"], ["Hillsborough"], ["Duval"]]}
{"id": "L4_0021", "question": "In Orleans Parish (Louisiana, GEOID 22071), what is the average relative percentile rank for Relative percentile for Theme 4 (Housing & Transportation) (RPL_THEME4) across all census tracts that contain at least one school?", "sql": "SELECT AVG(v.RPL_THEME4) AS avg_housing_vulnerability FROM schools s JOIN census_tracts t ON ST_Contains(t.geometry, ST_Point(s.LON, s.LAT)) JOIN svi v ON t.GEOID = v.GEOID WHERE LEFT(t.GEOID, 5) = '22071' AND ST_IsValid(t.geometry) AND v.RPL_THEME4 IS NOT NULL AND v.RPL_THEME4 BETWEEN 0 AND 100;", "elapsed": 1.039, "row_count": 1, "result": [[0.43347468354430346]]}
{"id": "L4_0022", "question": "In Louisiana (STATEFP 22), what is the average Riverine Flooding Expected Area Exposure among census tracts that intersect FEMA floodplain polygons?", "sql": "SELECT AVG(n.RFLD_EXP_AREA) AS avg_exposed_area FROM nri n JOIN census_tracts t ON n.GEOID=t.GEOID WHERE LEFT(t.GEOID,2)='22' AND n.RFLD_EXP_AREA BETWEEN 0 AND 1e9 AND ST_IsValid(t.geometry) AND EXISTS (SELECT 1 FROM floodplain f WHERE ST_Intersects(t.geometry, f.geometry) AND ST_IsValid(f.geometry));", "elapsed": 4.429, "row_count": 1, "result": [[3.058101789520622]]}
{"id": "L4_0023", "question": "In Florida (STATEFP 12), what is the average number of Riverine Flooding events among census tracts that intersect FEMA floodplain polygons?", "sql": "SELECT AVG(n.RFLD_EVNTS) AS avg_flood_events FROM nri n JOIN census_tracts t ON n.GEOID=t.GEOID WHERE LEFT(t.GEOID,2)='12' AND n.RFLD_EVNTS BETWEEN 0 AND 1000 AND ST_IsValid(t.geometry) AND EXISTS (SELECT 1 FROM floodplain f WHERE ST_Intersects(f.geometry,t.geometry) AND ST_IsValid(f.geometry));", "elapsed": 5.533, "row_count": 1, "result": [[34.15488810365135]]}
{"id": "L4_0024", "question": "In Louisiana (STATEFP 22), which 3 counties contain the largest number of hospitals located within FEMA floodplain polygons? Return their county names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON LEFT(h.COUNTYFIPS,5)=c.GEOID WHERE c.STATEFP='22' AND EXISTS (SELECT 1 FROM floodplain f WHERE ST_Contains(f.geometry, ST_Point(h.LON, h.LAT)) AND ST_IsValid(f.geometry)) GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 3;", "elapsed": 2.619, "row_count": 3, "result": [["East Baton Rouge"], ["Lafayette"], ["St. Tammany"]]}
{"id": "L4_0025", "question": "Which 5 Texas (STATEFP 48) counties have the highest number of schools located within FEMA floodplain polygons? Return their county names.", "sql": "SELECT c.NAME AS county_name FROM schools s JOIN county c ON LEFT(s.STATEFP,2)=c.STATEFP AND ST_Contains(c.geometry, ST_Point(s.LON, s.LAT)) JOIN floodplain f ON ST_Contains(f.geometry, ST_Point(s.LON, s.LAT)) WHERE c.STATEFP='48' AND ST_IsValid(c.geometry) AND ST_IsValid(f.geometry) GROUP BY c.NAME ORDER BY COUNT(DISTINCT s.SCHOOL_ID) DESC LIMIT 5;", "elapsed": 17.807, "row_count": 5, "result": [["Harris"], ["Dallas"], ["Bexar"], ["Tarrant"], ["Travis"]]}
{"id": "L4_0026", "question": "In Harris County, Texas (GEOID prefix 48201), what is the average Overall relative vulnerability percentile across all themes across all census tracts that contain at least one school?", "sql": "SELECT AVG(v.RPL_THEMES) AS avg_overall_vulnerability FROM schools s JOIN census_tracts t ON ST_Contains(t.geometry, ST_Point(s.LON, s.LAT)) JOIN svi v ON t.GEOID = v.GEOID WHERE LEFT(t.GEOID, 5) = '48201' AND ST_IsValid(t.geometry) AND v.RPL_THEMES IS NOT NULL AND v.RPL_THEMES BETWEEN 0 AND 100;", "elapsed": 0.07, "row_count": 1, "result": [[0.6671438259756864]]}
{"id": "L4_0027", "question": "In Florida (STATEFP 12), what is the average population universe of census tracts that intersect FEMA floodplain polygons?", "sql": "SELECT AVG(r.POPUNI) AS avg_population_universe FROM cre r JOIN (SELECT DISTINCT t.GEOID FROM census_tracts t JOIN floodplain f ON ST_Intersects(f.geometry,t.geometry) WHERE LEFT(t.GEOID,2)='12' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry)) t2 ON r.GEOID=t2.GEOID;", "elapsed": 4.614, "row_count": 1, "result": [[4336.608450155763]]}
{"id": "L4_0028", "question": "In Texas (STATEFP 48), what is the average population universe of census tracts that intersect FEMA floodplain polygons?", "sql": "SELECT AVG(r.POPUNI) AS avg_population_universe FROM cre r JOIN (SELECT DISTINCT t.GEOID FROM census_tracts t JOIN floodplain f ON ST_Intersects(f.geometry,t.geometry) WHERE LEFT(t.GEOID,2)='48' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry)) t2 ON r.GEOID=t2.GEOID;", "elapsed": 4.738, "row_count": 1, "result": [[4411.511199364575]]}
{"id": "L4_0029", "question": "In Travis County, Texas (GEOID 48453), what is the total Insurance payout amount (in USD) for structural building damage for all NFIP flood claims recorded within that county, contingent on the county boundary also containing at least one hospital?", "sql": "SELECT SUM(CAST(l.amountPaidOnBuildingClaim AS DOUBLE)) AS total_claims_paid FROM hospitals h JOIN county c ON ST_Contains(c.geometry, ST_Point(h.LON, h.LAT)) JOIN claims l ON LEFT(l.GEOID, 5) = c.GEOID WHERE c.GEOID = '48453' AND ST_IsValid(c.geometry) AND l.amountPaidOnBuildingClaim IS NOT NULL;", "elapsed": 0.194, "row_count": 1, "result": [[2785435764.5999036]]}
{"id": "L4_0030", "question": "In Orleans Parish (Louisiana, GEOID 22071), how many census tracts have NFIP claims and intersect any FEMA floodplain polygons?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_claim_tracts FROM census_tracts t WHERE LEFT(t.GEOID,5)='22071' AND EXISTS (SELECT 1 FROM claims cl WHERE cl.GEOID=t.GEOID) AND EXISTS (SELECT 1 FROM floodplain f WHERE ST_Intersects(f.geometry, t.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry));", "elapsed": 2.349, "row_count": 1, "result": [[183]]}
{"id": "L4_0031", "question": "In Miami-Dade County (Florida, GEOID 12086), what is the average overall relative vulnerability percentile across all themes for census tracts that intersect any FEMA floodplain polygons?", "sql": "SELECT AVG(v.RPL_THEMES) AS avg_svi_for_flooded_tracts FROM census_tracts t JOIN svi v ON t.GEOID = v.GEOID WHERE LEFT(t.GEOID,5)='12086' AND EXISTS (SELECT 1 FROM floodplain f WHERE ST_Intersects(f.geometry, t.geometry) AND ST_IsValid(f.geometry)) AND v.RPL_THEMES IS NOT NULL AND v.RPL_THEMES BETWEEN 0 AND 100;", "elapsed": 2.327, "row_count": 1, "result": [[0.689059971305595]]}
{"id": "L4_0032", "question": "In Dallas County, Texas (GEOID 48113), what is the total Expected annual loss for buildings caused by riverine flooding (USD) across all census tracts within that county, contingent on the county boundary also containing at least one hospital?", "sql": "SELECT SUM(n.RFLD_EALB) AS total_expected_loss FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.GEOID = '48113' AND n.RFLD_EALB IS NOT NULL AND EXISTS (SELECT 1 FROM hospitals h WHERE ST_Contains(c.geometry, ST_Point(h.LON, h.LAT)));", "elapsed": 0.032, "row_count": 1, "result": [[2177344.868646109]]}
{"id": "L4_0033", "question": "In Broward County, Florida (GEOID 12011), how many census tracts with Estimated percent of population below 150% poverty line above 25% intersect FEMA floodplain polygons?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_high_poverty_tracts FROM svi s JOIN census_tracts t ON s.FIPS=t.GEOID JOIN floodplain f ON ST_Intersects(t.geometry,f.geometry) WHERE LEFT(t.GEOID,5)='12011' AND s.EP_POV150 BETWEEN 0 AND 100 AND s.EP_POV150>25 AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry);", "elapsed": 2.3, "row_count": 1, "result": [[140]]}
{"id": "L4_0034", "question": "In Jefferson Parish, Louisiana (GEOID 22051), what is the total Insurance payout amount (in USD) for structural building damage for all NFIP flood claims recorded in that county, contingent on the county boundary also containing at least one hospital?", "sql": "SELECT SUM(CAST(l.amountPaidOnBuildingClaim AS DOUBLE)) AS total_claims_paid FROM hospitals h JOIN county c ON ST_Contains(c.geometry, ST_Point(h.LON, h.LAT)) JOIN claims l ON LEFT(l.GEOID, 5) = c.GEOID WHERE c.GEOID = '22051' AND ST_IsValid(c.geometry) AND l.amountPaidOnBuildingClaim IS NOT NULL;", "elapsed": 0.096, "row_count": 1, "result": [[45117781253.34436]]}
{"id": "L4_0035", "question": "In Florida (STATEFP 12), what is the total estimated population in census tracts that intersect FEMA floodplain polygons?", "sql": "WITH affected_tracts AS (SELECT DISTINCT t.GEOID FROM census_tracts t JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE LEFT(t.GEOID,2)='12' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry)) SELECT SUM(s.E_TOTPOP) AS total_population FROM affected_tracts a JOIN svi s ON s.FIPS=a.GEOID WHERE s.E_TOTPOP IS NOT NULL;", "elapsed": 4.685, "row_count": 1, "result": [[21583194]]}
{"id": "L4_0036", "question": "In Tampa area (Hillsborough County, GEOID 12057), what is the total Population universe used in tract-level resilience estimation for census tracts that intersect FEMA floodplain polygons?", "sql": "SELECT SUM(r.POPUNI) AS total_population_universe FROM census_tracts t JOIN cre r ON t.GEOID=r.GEOID WHERE LEFT(t.GEOID,5)='12057' AND EXISTS (SELECT 1 FROM floodplain f WHERE ST_Intersects(t.geometry, f.geometry) AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry)) AND r.POPUNI IS NOT NULL;", "elapsed": 2.318, "row_count": 1, "result": [[1515105]]}
{"id": "L4_0037", "question": "In Baton Rouge (East Baton Rouge Parish, GEOID 22033), what is the average estimated total population for census tracts that contain at least one hospital?", "sql": "SELECT AVG(s.E_TOTPOP) AS avg_population_in_hospital_tracts FROM census_tracts t JOIN svi s ON t.GEOID = s.GEOID WHERE LEFT(t.GEOID,5)='22033' AND EXISTS (SELECT 1 FROM hospitals h WHERE ST_Contains(t.geometry, ST_Point(h.LON, h.LAT))) AND s.E_TOTPOP IS NOT NULL;", "elapsed": 0.038, "row_count": 1, "result": [[4910.0]]}
{"id": "L4_0038", "question": "In Dallas County, Texas (GEOID 48113), how many census tracts with NFIP claims intersect floodplain areas?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_tracts FROM census_tracts t WHERE LEFT(t.GEOID,5)='48113' AND EXISTS (SELECT 1 FROM claims cl WHERE cl.GEOID=t.GEOID) AND EXISTS (SELECT 1 FROM floodplain f WHERE ST_Intersects(t.geometry, f.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry));", "elapsed": 2.332, "row_count": 1, "result": [[302]]}
{"id": "L4_0039", "question": "In Louisiana (STATEFP 22), what is the average percentage of population with three or more social vulnerability components among tracts that intersect FEMA floodplain polygons?", "sql": "SELECT AVG(r.PRED3_PE) AS avg_high_vulnerability_pct FROM cre r JOIN census_tracts t ON r.GEOID=t.GEOID JOIN floodplain f ON ST_Intersects(t.geometry,f.geometry) WHERE LEFT(t.GEOID,2)='22' AND r.PRED3_PE BETWEEN 0 AND 100;", "elapsed": 2.086, "row_count": 1, "result": [[26.740750498598462]]}
{"id": "L4_0040", "question": "In Harris County, Texas (GEOID 48201), how many census tracts with limited English proficiency above 10% (EP_LIMENG > 10) intersect FEMA floodplain areas?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_limited_english_tracts FROM svi s JOIN census_tracts t ON s.FIPS=t.GEOID JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE LEFT(t.GEOID,5)='48201' AND s.EP_LIMENG BETWEEN 0 AND 100 AND s.EP_LIMENG > 10 AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry);", "elapsed": 2.348, "row_count": 1, "result": [[469]]}
{"id": "L4_0041", "question": "In Texas (STATEFP 48), what is the average Riverine Flood Expected Annual Loss for buildings (RFLD_EALB) among census tracts that intersect FEMA floodplain polygons?", "sql": "SELECT AVG(sub.RFLD_EALB) AS avg_building_loss FROM (SELECT DISTINCT n.GEOID, n.RFLD_EALB FROM nri n JOIN census_tracts t ON n.GEOID=t.GEOID JOIN floodplain f ON ST_Intersects(f.geometry, t.geometry) WHERE LEFT(t.GEOID,2)='48' AND n.RFLD_EALB BETWEEN 0 AND 1e9 AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry)) AS sub;", "elapsed": 4.763, "row_count": 1, "result": [[233289.81096640913]]}
{"id": "L4_0042", "question": "In Harris County, Texas (GEOID 48201), how many census tracts with estimated percent of minority population above 60 intersect FEMA floodplain polygons?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_minority_tracts FROM svi s JOIN census_tracts t ON s.FIPS=t.GEOID JOIN floodplain f ON ST_Intersects(f.geometry, t.geometry) WHERE LEFT(t.GEOID,5)='48201' AND s.EP_MINRTY BETWEEN 0 AND 100 AND s.EP_MINRTY>60 AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry);", "elapsed": 2.377, "row_count": 1, "result": [[777]]}
{"id": "L4_0043", "question": "In Florida (STATEFP 12), what is the average estimated percent unemployed among census tracts that intersect FEMA floodplain polygons?", "sql": "SELECT AVG(sub.EP_UNEMP) AS avg_unemployment FROM (SELECT DISTINCT s.FIPS, s.EP_UNEMP FROM svi s JOIN census_tracts t ON s.FIPS=t.GEOID JOIN floodplain f ON ST_Intersects(f.geometry, t.geometry) WHERE LEFT(t.GEOID,2)='12' AND s.EP_UNEMP BETWEEN 0 AND 100 AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry)) AS sub;", "elapsed": 4.348, "row_count": 1, "result": [[5.15486358244366]]}
{"id": "L5_0001", "question": "How many hospitals are located within both FEMA floodplain polygons and census tract boundaries in Harris County, Texas (identified by the leftmost 5 digits of GEOID 48201 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT h.UNIQUE_ID) AS num_hospitals FROM hospitals h JOIN floodplain f ON ST_Within(ST_Point(h.LON, h.LAT), f.geometry) JOIN census_tracts t ON ST_Within(ST_Point(h.LON, h.LAT), t.geometry) WHERE LEFT(t.GEOID,5)='48201' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry);", "elapsed": 2.525, "row_count": 1, "result": [[106]]}
{"id": "L5_0002", "question": "What is the total area where census tract geometries and FEMA floodplain polygons intersect, considering only tracts that also intersect ZCTA boundaries, in Dallas County, Texas (identified by the leftmost 5 digits of GEOID 48113 in the census_tract table)?", "sql": "SELECT SUM(ST_Area(ST_Intersection(t.geometry, f.geometry))) AS total_overlap_area FROM census_tracts t JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE LEFT(t.GEOID,5)='48113' AND t.GEOID IN (SELECT DISTINCT t2.GEOID FROM census_tracts t2 JOIN zcta z ON ST_Intersects(t2.geometry, z.geometry) WHERE LEFT(t2.GEOID,5)='48113' AND ST_IsValid(t2.geometry) AND ST_IsValid(z.geometry)) AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry);", "elapsed": 2.952, "row_count": 1, "result": [[0.22053823274254702]]}
{"id": "L5_0003", "question": "Among ZCTAs that intersect both census tract and FEMA floodplain geometries in Orleans Parish, Louisiana (identified by the leftmost 5 digits of GEOID 22071 in the census_tract table), how many distinct ZCTAs are found?", "sql": "SELECT COUNT(DISTINCT z.GEOID) AS num_zcta FROM zcta z JOIN census_tracts t ON ST_Intersects(z.geometry, t.geometry) JOIN floodplain f ON ST_Intersects(f.geometry, z.geometry) WHERE LEFT(t.GEOID,5)='22071' AND ST_IsValid(z.geometry) AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry);", "elapsed": 4.923, "row_count": 1, "result": [[35]]}
{"id": "L5_0004", "question": "How many FEMA floodplain polygons partially overlap both ZCTAs and census tracts in Miami-Dade County, Florida (identified by the leftmost 5 digits of GEOID 12086 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT f.GFID) AS num_floodplain FROM floodplain f JOIN zcta z ON ST_Overlaps(f.geometry, z.geometry) JOIN census_tracts t ON ST_Overlaps(f.geometry, t.geometry) WHERE LEFT(t.GEOID,5)='12086' AND ST_IsValid(f.geometry) AND ST_IsValid(z.geometry) AND ST_IsValid(t.geometry);", "elapsed": 5.244, "row_count": 1, "result": [[4]]}
{"id": "L5_0005", "question": "What is the maximum number of ZCTAs intersecting a single census tract that also intersects FEMA floodplain polygons in Travis County, Texas (identified by the leftmost 5 digits of GEOID 48453 in the census_tract table)?", "sql": "SELECT MAX(zcta_count) AS max_zcta_per_tract FROM (SELECT t.GEOID, COUNT(DISTINCT z.GEOID) AS zcta_count FROM census_tracts t JOIN zcta z ON ST_Intersects(t.geometry, z.geometry) JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE LEFT(t.GEOID,5)='48453' AND ST_IsValid(t.geometry) AND ST_IsValid(z.geometry) AND ST_IsValid(f.geometry) GROUP BY t.GEOID);", "elapsed": 2.929, "row_count": 1, "result": [[7]]}
{"id": "L5_0006", "question": "How many schools are located within both census tract boundaries and FEMA floodplain polygons in Miami-Dade County, Florida (identified by the leftmost 5 digits of GEOID 12086 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT s.UNIQUE_ID) AS num_schools FROM schools s JOIN census_tracts t ON ST_Within(ST_Point(s.LON, s.LAT), t.geometry) JOIN floodplain f ON ST_Within(ST_Point(s.LON, s.LAT), f.geometry) WHERE LEFT(t.GEOID,5)='12086' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry);", "elapsed": 2.353, "row_count": 1, "result": [[934]]}
{"id": "L5_0007", "question": "What is the total area where FEMA floodplain polygons intersect census tract geometries, considering only tracts that also intersect ZCTA boundaries, in Harris County, Texas (identified by the leftmost 5 digits of GEOID 48201 in the census_tract table)?", "sql": "SELECT SUM(ST_Area(ST_Intersection(f.geometry, t.geometry))) AS total_overlap_area FROM floodplain f JOIN census_tracts t ON ST_Intersects(f.geometry, t.geometry) WHERE LEFT(t.GEOID,5)='48201' AND t.GEOID IN (SELECT DISTINCT t2.GEOID FROM census_tracts t2 JOIN zcta z ON ST_Intersects(t2.geometry, z.geometry) WHERE LEFT(t2.GEOID,5)='48201' AND ST_IsValid(t2.geometry) AND ST_IsValid(z.geometry)) AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry);", "elapsed": 3.27, "row_count": 1, "result": [[0.43223487650533016]]}
{"id": "L5_0008", "question": "How many census tracts partially overlap both FEMA floodplain polygons and ZCTA boundaries in Dallas County, Texas (identified by the leftmost 5 digits of GEOID 48113 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_tracts FROM census_tracts t JOIN floodplain f ON ST_Overlaps(t.geometry, f.geometry) JOIN zcta z ON ST_Overlaps(t.geometry, z.geometry) WHERE LEFT(t.GEOID,5)='48113' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(z.geometry);", "elapsed": 2.75, "row_count": 1, "result": [[246]]}
{"id": "L5_0009", "question": "How many hospitals are located within both FEMA floodplain polygons and census tract boundaries in Orleans Parish, Louisiana (identified by the leftmost 5 digits of GEOID 22071 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT h.UNIQUE_ID) AS num_hospitals FROM hospitals h JOIN floodplain f ON ST_Within(ST_Point(h.LON, h.LAT), f.geometry) JOIN census_tracts t ON ST_Within(ST_Point(h.LON, h.LAT), t.geometry) WHERE LEFT(t.GEOID,5)='22071' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry);", "elapsed": 2.344, "row_count": 1, "result": [[15]]}
{"id": "L5_0010", "question": "What is the maximum intersection area between a census tract and FEMA floodplain polygons, considering only tracts that also intersect ZCTA geometries, in Palm Beach County, Florida (identified by the leftmost 5 digits of GEOID 12099 in the census_tract table)?", "sql": "SELECT MAX(ST_Area(ST_Intersection(t.geometry, f.geometry))) AS max_overlap_area FROM census_tracts t JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE LEFT(t.GEOID,5)='12099' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND ST_Area(t.geometry) > 0 AND t.GEOID IN (SELECT DISTINCT t2.GEOID FROM census_tracts t2 JOIN zcta z ON ST_Intersects(t2.geometry, z.geometry) WHERE LEFT(t2.GEOID,5)='12099' AND ST_IsValid(t2.geometry) AND ST_IsValid(z.geometry));", "elapsed": 3.114, "row_count": 1, "result": [[0.06589282024525736]]}
{"id": "L5_0011", "question": "Among all ZCTAs in the dataset, what percentage share boundaries with census tracts that intersect FEMA floodplain polygons in Orleans Parish, Louisiana (identified by the leftmost 5 digits of GEOID 22071 in the census_tract table)?", "sql": "SELECT 100.0 * COUNT(DISTINCT z.GEOID) / (SELECT COUNT(*) FROM zcta) AS pct_zcta_touching FROM zcta z JOIN census_tracts t ON ST_Touches(z.geometry, t.geometry) JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE LEFT(t.GEOID,5)='22071' AND ST_IsValid(z.geometry) AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry);", "elapsed": 2.62, "row_count": 1, "result": [[0.5488266464799394]]}
{"id": "L5_0012", "question": "What is the average overlap area between census tracts and FEMA floodplain polygons, considering only tracts that also overlap ZCTA boundaries, in Harris County, Texas (identified by the leftmost 5 digits of GEOID 48201 in the census_tract table)?", "sql": "SELECT AVG(ST_Area(ST_Intersection(t.geometry, f.geometry))) AS avg_overlap_area FROM census_tracts t JOIN floodplain f ON ST_Overlaps(t.geometry, f.geometry) WHERE LEFT(t.GEOID,5)='48201' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND t.GEOID IN (SELECT DISTINCT t2.GEOID FROM census_tracts t2 JOIN zcta z ON ST_Overlaps(t2.geometry, z.geometry) WHERE LEFT(t2.GEOID,5)='48201' AND ST_IsValid(t2.geometry) AND ST_IsValid(z.geometry));", "elapsed": 2.966, "row_count": 1, "result": [[6.139365682100565e-05]]}
{"id": "L5_0013", "question": "Among ZCTAs that intersect FEMA floodplain polygons and also intersect census tract geometries in Travis County, Texas (identified by the leftmost 5 digits of GEOID 48453), what is the maximum number of distinct floodplain polygons intersecting any single ZCTA?", "sql": "SELECT MAX(floodplain_count) AS max_floodplain_per_zcta FROM (SELECT z.GEOID, COUNT(DISTINCT f.GFID) AS floodplain_count FROM zcta z JOIN floodplain f ON ST_Intersects(z.geometry, f.geometry) JOIN census_tracts t ON ST_Intersects(z.geometry, t.geometry) WHERE LEFT(t.GEOID,5)='48453' AND ST_IsValid(z.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) GROUP BY z.GEOID);", "elapsed": 5.202, "row_count": 1, "result": [[4]]}
{"id": "L5_0014", "question": "What is the total area of ZCTAs (not just their overlapping or intersection portions) that intersect FEMA floodplain polygons within Broward County, Florida (identified by GEOID 12011 in the county table)?", "sql": "SELECT SUM(ST_Area(z.geometry)) AS total_zcta_area FROM zcta z JOIN county c ON ST_Intersects(z.geometry, c.geometry) WHERE c.GEOID='12011' AND ST_IsValid(z.geometry) AND ST_IsValid(c.geometry) AND EXISTS (SELECT 1 FROM floodplain f WHERE ST_Intersects(z.geometry, f.geometry) AND ST_IsValid(f.geometry));", "elapsed": 2.532, "row_count": 1, "result": [[0.7734889619005]]}
{"id": "L5_0015", "question": "What is the average percentage of each census tract's total area that intersects FEMA floodplain polygons, considering only tracts that also intersect ZCTA geometries, in Jefferson Parish, Louisiana (identified by the leftmost 5 digits of GEOID 22051 in the census_tract table)?", "sql": "SELECT AVG((ST_Area(ST_Intersection(t.geometry, f.geometry)) / ST_Area(t.geometry)) * 100) AS avg_overlap_pct FROM census_tracts t JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE LEFT(t.GEOID,5)='22051' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND t.GEOID IN (SELECT DISTINCT t2.GEOID FROM census_tracts t2 JOIN zcta z ON ST_Intersects(t2.geometry, z.geometry) WHERE LEFT(t2.GEOID,5)='22051' AND ST_IsValid(t2.geometry) AND ST_IsValid(z.geometry));", "elapsed": 3.512, "row_count": 1, "result": [[0.4907105030218991]]}
{"id": "L5_0016", "question": "What is the smallest number of FEMA floodplain polygons intersecting any census tract that also intersects ZCTA geometries in Harris County, Texas (identified by the leftmost 5 digits of GEOID 48201 in the census_tract table)?", "sql": "SELECT MIN(floodplain_count) AS min_floodplain_per_tract FROM (SELECT t.GEOID, COUNT(DISTINCT f.GFID) AS floodplain_count FROM census_tracts t JOIN floodplain f ON ST_Intersects(f.geometry, t.geometry) WHERE LEFT(t.GEOID,5)='48201' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) AND t.GEOID IN (SELECT DISTINCT t2.GEOID FROM census_tracts t2 JOIN zcta z ON ST_Intersects(t2.geometry, z.geometry) WHERE LEFT(t2.GEOID,5)='48201' AND ST_IsValid(t2.geometry) AND ST_IsValid(z.geometry)) GROUP BY t.GEOID);", "elapsed": 2.776, "row_count": 1, "result": [[1]]}
{"id": "L5_0017", "question": "What percentage of census tracts in Dallas County, Texas (identified by the leftmost 5 digits of GEOID 48113 in the census_tract table) intersect both FEMA floodplain polygons and county geometries?", "sql": "SELECT 100.0 * COUNT(DISTINCT t.GEOID) / (SELECT COUNT(*) FROM census_tracts WHERE LEFT(GEOID,5)='48113') AS pct_intersecting FROM census_tracts t JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) JOIN county c ON ST_Intersects(t.geometry, c.geometry) WHERE LEFT(t.GEOID,5)='48113' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(c.geometry);", "elapsed": 2.514, "row_count": 1, "result": [[100.0]]}
{"id": "L5_0018", "question": "How many ZCTAs intersect both FEMA floodplain polygons and census tract boundaries in Palm Beach County, Florida (identified by the leftmost 5 digits of GEOID 12099 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT z.GEOID) AS num_zcta FROM zcta z JOIN floodplain f ON ST_Intersects(z.geometry, f.geometry) JOIN census_tracts t ON ST_Intersects(z.geometry, t.geometry) WHERE LEFT(t.GEOID,5)='12099' AND ST_IsValid(z.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry);", "elapsed": 6.905, "row_count": 1, "result": [[63]]}
{"id": "L5_0019", "question": "How many distinct FEMA floodplain polygons intersect both county and census tract geometries in Travis County, Texas (identified by the leftmost 5 digits of GEOID 48453 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT f.GFID) AS num_floodplain FROM floodplain f JOIN county c ON ST_Intersects(f.geometry, c.geometry) JOIN census_tracts t ON ST_Intersects(f.geometry, t.geometry) WHERE LEFT(t.GEOID,5)='48453' AND ST_IsValid(f.geometry) AND ST_IsValid(c.geometry) AND ST_IsValid(t.geometry);", "elapsed": 8.072, "row_count": 1, "result": [[5]]}
{"id": "L5_0020", "question": "What is the average number of schools located within FEMA floodplain polygons per census tract in Orleans Parish, Louisiana (identified by the leftmost 5 digits of GEOID 22071)?", "sql": "SELECT AVG(school_count) AS avg_schools_per_tract FROM (SELECT t.GEOID, COUNT(DISTINCT s.UNIQUE_ID) AS school_count FROM schools s JOIN floodplain f ON ST_Within(ST_Point(s.LON, s.LAT), f.geometry) JOIN census_tracts t ON ST_Within(ST_Point(s.LON, s.LAT), t.geometry) WHERE LEFT(t.GEOID,5)='22071' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) GROUP BY t.GEOID);", "elapsed": 2.811, "row_count": 1, "result": [[1.5]]}
{"id": "L5_0021", "question": "How many schools are located within both census tract boundaries and FEMA floodplain polygons in Broward County, Florida (identified by the leftmost 5 digits of GEOID 12011 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT s.UNIQUE_ID) AS num_schools FROM schools s JOIN census_tracts t ON ST_Within(ST_Point(s.LON, s.LAT), t.geometry) JOIN floodplain f ON ST_Within(ST_Point(s.LON, s.LAT), f.geometry) WHERE LEFT(t.GEOID,5)='12011' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry);", "elapsed": 2.348, "row_count": 1, "result": [[516]]}
{"id": "L5_0022", "question": "How many census tracts overlap FEMA floodplain polygons and touch ZCTA boundaries in Orleans Parish, Louisiana (identified by the leftmost 5 digits of GEOID 22071 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_tracts FROM census_tracts t JOIN floodplain f ON ST_Overlaps(t.geometry, f.geometry) JOIN zcta z ON ST_Touches(t.geometry, z.geometry) WHERE LEFT(t.GEOID,5)='22071' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(z.geometry);", "elapsed": 2.647, "row_count": 1, "result": [[91]]}
{"id": "L5_0023", "question": "Across all Texas counties (identified by GEOID prefix 48 in the county table), what is the maximum number of distinct FEMA floodplain polygons that intersect both county and census tract geometries?", "sql": "SELECT MAX(num_floodplain) AS max_floodplain_per_county FROM (SELECT c.GEOID, COUNT(DISTINCT f.GFID) AS num_floodplain FROM floodplain f JOIN county c ON ST_Intersects(f.geometry, c.geometry) JOIN census_tracts t ON ST_Intersects(f.geometry, t.geometry) WHERE LEFT(c.GEOID,2)='48' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) AND ST_IsValid(c.geometry) GROUP BY c.GEOID);", "elapsed": 10.236, "row_count": 1, "result": [[8]]}
{"id": "L5_0024", "question": "How many census tracts intersect FEMA floodplain polygons and overlap ZCTA geometries in Miami-Dade County, Florida (identified by the leftmost 5 digits of GEOID 12086 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_tracts FROM census_tracts t JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) JOIN zcta z ON ST_Overlaps(t.geometry, z.geometry) WHERE LEFT(t.GEOID,5)='12086' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(z.geometry);", "elapsed": 2.84, "row_count": 1, "result": [[283]]}
{"id": "L5_0025", "question": "How many FEMA floodplain polygons overlap census tract geometries and intersect ZCTA geometries that touch along their shared boundaries in Bexar County, Texas (identified by the leftmost 5 digits of GEOID 48029 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT f.GFID) AS num_floodplain FROM floodplain f JOIN census_tracts t ON ST_Overlaps(f.geometry, t.geometry) JOIN zcta z ON ST_Intersects(f.geometry, z.geometry) WHERE LEFT(t.GEOID,5)='48029' AND ST_Touches(z.geometry, t.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) AND ST_IsValid(z.geometry);", "elapsed": 14.106, "row_count": 1, "result": [[7]]}
{"id": "L5_0026", "question": "How many census tracts intersect FEMA floodplain polygons and touch ZCTA boundaries in Harris County, Texas (identified by the leftmost 5 digits of GEOID 48201 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_tracts FROM census_tracts t JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) JOIN zcta z ON ST_Touches(t.geometry, z.geometry) WHERE LEFT(t.GEOID,5)='48201' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(z.geometry);", "elapsed": 3.279, "row_count": 1, "result": [[735]]}
{"id": "L5_0027", "question": "How many hospitals are located within both FEMA floodplain polygons and census tract boundaries in Travis County, Texas (identified by the leftmost 5 digits of GEOID 48453 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT h.UNIQUE_ID) AS num_hospitals FROM hospitals h JOIN floodplain f ON ST_Within(ST_Point(h.LON, h.LAT), f.geometry) JOIN census_tracts t ON ST_Within(ST_Point(h.LON, h.LAT), t.geometry) WHERE LEFT(t.GEOID,5)='48453' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry);", "elapsed": 2.455, "row_count": 1, "result": [[30]]}
{"id": "L5_0028", "question": "What is the average number of FEMA floodplain polygons located entirely within each ZCTA that intersects census tract geometries in Miami-Dade County, Florida (identified by the leftmost 5 digits of GEOID 12086)?", "sql": "SELECT AVG(floodplain_count) AS avg_floodplain_per_zcta FROM (SELECT z.GEOID, COUNT(DISTINCT f.GFID) AS floodplain_count FROM floodplain f JOIN zcta z ON ST_Within(f.geometry, z.geometry) JOIN census_tracts t ON ST_Intersects(z.geometry, t.geometry) WHERE LEFT(t.GEOID,5)='12086' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) AND ST_IsValid(z.geometry) GROUP BY z.GEOID);", "elapsed": 5.394, "row_count": 1, "result": [[1.0609756097560976]]}
{"id": "L5_0029", "question": "How many census tracts are completely contained within (excluding boundaries of) county geometries and intersect FEMA floodplain polygons in Orleans Parish, Louisiana (identified by the leftmost 5 digits of GEOID 22071 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_tracts FROM census_tracts t JOIN county c ON ST_Within(t.geometry, c.geometry) JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE LEFT(t.GEOID,5)='22071' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(c.geometry);", "elapsed": 2.523, "row_count": 1, "result": [[182]]}
{"id": "L5_0030", "question": "How many FEMA floodplain polygons intersect both county and census tract boundaries in Broward County, Florida (identified by the leftmost 5 digits of GEOID 12011 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT f.GFID) AS num_floodplain FROM floodplain f JOIN county c ON ST_Intersects(f.geometry, c.geometry) JOIN census_tracts t ON ST_Intersects(f.geometry, t.geometry) WHERE LEFT(t.GEOID,5)='12011' AND ST_IsValid(f.geometry) AND ST_IsValid(c.geometry) AND ST_IsValid(t.geometry);", "elapsed": 7.943, "row_count": 1, "result": [[4]]}
{"id": "L5_0031", "question": "How many census tracts intersect both FEMA floodplain polygons and county boundaries in Travis County, Texas (identified by the leftmost 5 digits of GEOID 48453 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_tracts FROM census_tracts t JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) JOIN county c ON ST_Intersects(t.geometry, c.geometry) WHERE LEFT(t.GEOID,5)='48453' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(c.geometry);", "elapsed": 2.649, "row_count": 1, "result": [[290]]}
{"id": "L5_0032", "question": "How many hospitals are located within both FEMA floodplain polygons and census tract boundaries in East Baton Rouge Parish, Louisiana (identified by the leftmost 5 digits of GEOID 22033 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT h.UNIQUE_ID) AS num_hospitals FROM hospitals h JOIN floodplain f ON ST_Within(ST_Point(h.LON, h.LAT), f.geometry) JOIN census_tracts t ON ST_Within(ST_Point(h.LON, h.LAT), t.geometry) WHERE LEFT(t.GEOID,5)='22033' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry);", "elapsed": 2.343, "row_count": 1, "result": [[21]]}
{"id": "L5_0033", "question": "What is the average total intersection area between each census tract and FEMA floodplain polygons, considering only tracts that also intersect ZCTA geometries, in Palm Beach County, Florida (identified by the leftmost 5 digits of GEOID 12099 in the census_tract table)?", "sql": "SELECT AVG(overlap_area) AS avg_overlap_area FROM (SELECT t.GEOID, SUM(ST_Area(ST_Intersection(t.geometry, f.geometry))) AS overlap_area FROM census_tracts t JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE LEFT(t.GEOID,5)='12099' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND t.GEOID IN (SELECT DISTINCT t2.GEOID FROM census_tracts t2 JOIN zcta z ON ST_Intersects(t2.geometry, z.geometry) WHERE LEFT(t2.GEOID,5)='12099' AND ST_IsValid(t2.geometry) AND ST_IsValid(z.geometry)) GROUP BY t.GEOID);", "elapsed": 3.099, "row_count": 1, "result": [[0.0014035499381325905]]}
{"id": "L5_0034", "question": "How many FEMA floodplain polygons overlap census tract boundaries and intersect county geometries in Dallas County, Texas (identified by the leftmost 5 digits of GEOID 48113 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT f.GFID) AS num_floodplain FROM floodplain f JOIN census_tracts t ON ST_Overlaps(f.geometry, t.geometry) JOIN county c ON ST_Intersects(f.geometry, c.geometry) WHERE LEFT(t.GEOID,5)='48113' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) AND ST_IsValid(c.geometry);", "elapsed": 2.474, "row_count": 1, "result": [[7]]}
{"id": "L5_0035", "question": "How many hospitals are located within both FEMA floodplain polygons and census tract geometries in Jefferson Parish, Louisiana (identified by the leftmost 5 digits of GEOID 22051 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT h.UNIQUE_ID) AS num_hospitals FROM hospitals h JOIN floodplain f ON ST_Within(ST_Point(h.LON, h.LAT), f.geometry) JOIN census_tracts t ON ST_Within(ST_Point(h.LON, h.LAT), t.geometry) WHERE LEFT(t.GEOID,5)='22051' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry);", "elapsed": 2.356, "row_count": 1, "result": [[15]]}
{"id": "L5_0036", "question": "How many FEMA floodplain polygons overlap census tract boundaries and intersect county geometries in Miami-Dade County, Florida (identified by the leftmost 5 digits of GEOID 12086 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT f.GFID) AS num_floodplain FROM floodplain f JOIN census_tracts t ON ST_Overlaps(f.geometry, t.geometry) JOIN county c ON ST_Intersects(f.geometry, c.geometry) WHERE LEFT(t.GEOID,5)='12086' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) AND ST_IsValid(c.geometry);", "elapsed": 2.463, "row_count": 1, "result": [[4]]}
{"id": "L5_0037", "question": "How many FEMA floodplain polygons intersect county boundaries and census tract geometries in Harris County, Texas (identified by the leftmost 5 digits of GEOID 48201 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT f.GFID) AS num_floodplain FROM floodplain f JOIN county c ON ST_Intersects(f.geometry, c.geometry) JOIN census_tracts t ON ST_Intersects(f.geometry, t.geometry) WHERE LEFT(t.GEOID,5)='48201' AND ST_IsValid(f.geometry) AND ST_IsValid(c.geometry) AND ST_IsValid(t.geometry);", "elapsed": 8.044, "row_count": 1, "result": [[8]]}
{"id": "L5_0038", "question": "How many census tracts touch ZCTA boundaries and intersect FEMA floodplain polygons in Dallas County, Texas (identified by the leftmost 5 digits of GEOID 48113 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_tracts FROM census_tracts t JOIN zcta z ON ST_Touches(t.geometry, z.geometry) JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE LEFT(t.GEOID,5)='48113' AND ST_IsValid(t.geometry) AND ST_IsValid(z.geometry) AND ST_IsValid(f.geometry);", "elapsed": 2.747, "row_count": 1, "result": [[417]]}
{"id": "L5_0039", "question": "How many ZCTAs intersect both FEMA floodplain polygons and county boundaries in Orleans Parish, Louisiana (identified by GEOID 22071 in the county table)?", "sql": "SELECT COUNT(DISTINCT z.GEOID) AS num_zcta FROM zcta z JOIN floodplain f ON ST_Intersects(z.geometry, f.geometry) JOIN county c ON ST_Intersects(z.geometry, c.geometry) WHERE c.GEOID='22071' AND ST_IsValid(z.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(c.geometry);", "elapsed": 5.194, "row_count": 1, "result": [[35]]}
{"id": "L5_0040", "question": "How many census tracts intersect both FEMA floodplain polygons and ZCTA geometries in Travis County, Texas (identified by the leftmost 5 digits of GEOID 48453 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_tracts FROM census_tracts t JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) JOIN zcta z ON ST_Intersects(t.geometry, z.geometry) WHERE LEFT(t.GEOID,5)='48453' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(z.geometry);", "elapsed": 2.699, "row_count": 1, "result": [[290]]}
{"id": "L5_0041", "question": "What is the maximum number of schools located within any single census tract in Palm Beach County, Florida (identified by the leftmost 5 digits of GEOID 12099), considering only schools that lie inside FEMA floodplain polygons?", "sql": "SELECT MAX(num_schools) AS max_schools_in_tract FROM (SELECT t.GEOID, COUNT(DISTINCT s.UNIQUE_ID) AS num_schools FROM schools s JOIN floodplain f ON ST_Within(ST_Point(s.LON, s.LAT), f.geometry) JOIN census_tracts t ON ST_Within(ST_Point(s.LON, s.LAT), t.geometry) WHERE LEFT(t.GEOID,5)='12099' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) GROUP BY t.GEOID);", "elapsed": 2.973, "row_count": 1, "result": [[7]]}
{"id": "L5_0042", "question": "How many FEMA floodplain polygons overlap census tract geometries and touch ZCTA boundaries in Jefferson Parish, Louisiana (identified by the leftmost 5 digits of GEOID 22051 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT f.GFID) AS num_floodplain FROM floodplain f JOIN census_tracts t ON ST_Overlaps(f.geometry, t.geometry) JOIN zcta z ON ST_Touches(t.geometry, z.geometry) WHERE LEFT(t.GEOID,5)='22051' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) AND ST_IsValid(z.geometry);", "elapsed": 2.667, "row_count": 1, "result": [[3]]}
{"id": "L5_0043", "question": "How many FEMA floodplain polygons intersect both census tract and ZCTA geometries in Miami-Dade County, Florida (identified by the leftmost 5 digits of GEOID 12086 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT f.GFID) AS num_floodplain FROM floodplain f JOIN census_tracts t ON ST_Intersects(f.geometry, t.geometry) JOIN zcta z ON ST_Intersects(f.geometry, z.geometry) WHERE LEFT(t.GEOID,5)='12086' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) AND ST_IsValid(z.geometry);", "elapsed": 2.523, "row_count": 1, "result": [[4]]}
{"id": "L5_0044", "question": "How many ZCTAs intersect both FEMA floodplain polygons and county boundaries in Dallas County, Texas (identified by GEOID 48113 in the county table)?", "sql": "SELECT COUNT(DISTINCT z.GEOID) AS num_zcta FROM zcta z JOIN floodplain f ON ST_Intersects(z.geometry, f.geometry) JOIN county c ON ST_Intersects(z.geometry, c.geometry) WHERE c.GEOID='48113' AND ST_IsValid(z.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(c.geometry);", "elapsed": 5.375, "row_count": 1, "result": [[100]]}
{"id": "L5_0045", "question": "How many census tracts touch ZCTA boundaries and intersect FEMA floodplain polygons in Harris County, Texas (identified by the leftmost 5 digits of GEOID 48201 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_tracts FROM census_tracts t JOIN zcta z ON ST_Touches(t.geometry, z.geometry) JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE LEFT(t.GEOID,5)='48201' AND ST_IsValid(t.geometry) AND ST_IsValid(z.geometry) AND ST_IsValid(f.geometry);", "elapsed": 2.761, "row_count": 1, "result": [[735]]}
{"id": "L5_0046", "question": "How many FEMA floodplain polygons overlap census tract boundaries and intersect county geometries in Orleans Parish, Louisiana (identified by the leftmost 5 digits of GEOID 22071 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT f.GFID) AS num_floodplain FROM floodplain f JOIN census_tracts t ON ST_Overlaps(f.geometry, t.geometry) JOIN county c ON ST_Intersects(f.geometry, c.geometry) WHERE LEFT(t.GEOID,5)='22071' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry) AND ST_IsValid(c.geometry);", "elapsed": 3.148, "row_count": 1, "result": [[5]]}
{"id": "L5_0047", "question": "What percentage of all census tracts in Travis County, Texas (identified by the leftmost 5 digits of GEOID 48453) touch a ZCTA boundary and intersect a FEMA floodplain polygon?", "sql": "SELECT 100.0 * COUNT(DISTINCT t.GEOID) / (SELECT COUNT(*) FROM census_tracts WHERE LEFT(GEOID,5)='48453') AS pct_affected FROM census_tracts t JOIN zcta z ON ST_Touches(t.geometry, z.geometry) JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) WHERE LEFT(t.GEOID,5)='48453' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(z.geometry);", "elapsed": 2.562, "row_count": 1, "result": [[58.275862068965516]]}
{"id": "L5_0048", "question": "How many hospitals are located within both FEMA floodplain polygons and census tract boundaries in Harris County, Texas (identified by the leftmost 5 digits of GEOID 48201 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT h.UNIQUE_ID) AS num_hospitals FROM hospitals h JOIN floodplain f ON ST_Within(ST_Point(h.LON, h.LAT), f.geometry) JOIN census_tracts t ON ST_Within(ST_Point(h.LON, h.LAT), t.geometry) WHERE LEFT(t.GEOID,5)='48201' AND ST_IsValid(f.geometry) AND ST_IsValid(t.geometry);", "elapsed": 2.432, "row_count": 1, "result": [[106]]}
{"id": "L5_0049", "question": "How many census tracts intersect FEMA floodplain polygons and touch ZCTA boundaries in Jefferson Parish, Louisiana (identified by the leftmost 5 digits of GEOID 22051 in the census_tract table)?", "sql": "SELECT COUNT(DISTINCT t.GEOID) AS num_tracts FROM census_tracts t JOIN floodplain f ON ST_Intersects(t.geometry, f.geometry) JOIN zcta z ON ST_Touches(t.geometry, z.geometry) WHERE LEFT(t.GEOID,5)='22051' AND ST_IsValid(t.geometry) AND ST_IsValid(f.geometry) AND ST_IsValid(z.geometry);", "elapsed": 3.72, "row_count": 1, "result": [[78]]}
{"id": "L5_0050", "question": "How many FEMA floodplain polygons intersect both ZCTA geometries and county boundaries in Harris County, Texas (identified by GEOID 48201 in the county table)?", "sql": "SELECT COUNT(DISTINCT f.GFID) AS num_floodplain FROM floodplain f JOIN zcta z ON ST_Intersects(f.geometry, z.geometry) JOIN county c ON ST_Intersects(f.geometry, c.geometry) WHERE c.GEOID='48201' AND ST_IsValid(f.geometry) AND ST_IsValid(z.geometry) AND ST_IsValid(c.geometry);", "elapsed": 6.258, "row_count": 1, "result": [[8]]}
