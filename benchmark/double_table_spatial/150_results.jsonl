{"id": "L2_0001", "question": "How many census_tracts in Duval County, FL (identified by GEOID starting with 12031) intersect floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.GEOID LIKE '12031%' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.964, "row_count": 1, "result": [[219]]}
{"id": "L2_0002", "question": "How many schools in San Antonio, TX (identified by CITY = 'SAN ANTONIO' and STATEFP = '48') fall inside floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP = '48' AND a.CITY = 'SAN ANTONIO' AND ST_IsValid(b.geometry);", "elapsed": 2.491, "row_count": 1, "result": [[668]]}
{"id": "L2_0003", "question": "Which census_tract in Hillsborough County, FL (identified by STATEFP = '12' and COUNTYFP = '057') has the largest total overlap area with all zcta polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tracts_id FROM census_tracts a JOIN zcta b ON ST_Overlaps(a.geometry, b.geometry) WHERE a.STATEFP = '12' AND a.COUNTYFP = '057' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry, b.geometry))) DESC LIMIT 1;", "elapsed": 0.453, "row_count": 1, "result": [["12057013903"]]}
{"id": "L2_0004", "question": "Top 1 census_tract in Austin, TX (identified by CITY = 'AUSTIN' and STATEFP = '48') by number of schools located within it (return the 11-digit GEOID only).", "sql": "SELECT b.GEOID AS census_tracts_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP = '48' AND a.CITY = 'AUSTIN' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.231, "row_count": 1, "result": [["48453002411"]]}
{"id": "L2_0005", "question": "Top 1 census_tract in Orleans Parish, LA (identified by COUNTYFIPS = '071') by number of hospitals located within it (return the 11-digit GEOID only).", "sql": "SELECT b.GEOID AS census_tracts_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.COUNTYFIPS = '22071' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.224, "row_count": 1, "result": [["22071009900"]]}
{"id": "L2_0006", "question": "In Galveston County, TX (identified by COUNTYFP = '167' and STATEFP = '48'), which FEMA Flood Hazard Zone (excluding 'X' and 'AREA NOT INCLUDED') has the most census_tracts intersecting floodplain polygons? Return its FLD_ZONE code.", "sql": "SELECT b.FLD_ZONE FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='167' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) AND b.FLD_ZONE IS NOT NULL AND b.FLD_ZONE NOT IN ('X','AREA NOT INCLUDED') GROUP BY b.FLD_ZONE ORDER BY COUNT(DISTINCT a.GEOID) DESC LIMIT 1;", "elapsed": 2.185, "row_count": 1, "result": [["AE"]]}
{"id": "L2_0007", "question": "How many hospitals in Harris County, TX (identified by COUNTYFIPS = '48201') are located within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN census_tracts b ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.COUNTYFIPS='48201' AND ST_IsValid(b.geometry);", "elapsed": 0.219, "row_count": 1, "result": [[110]]}
{"id": "L2_0008", "question": "How many pairs of census_tracts in Hillsborough County, FL (STATEFP = '12' and COUNTYFP = '057') share a common boundary?", "sql": "SELECT COUNT(*) AS num_adjacent_pairs FROM census_tracts a JOIN census_tracts b ON ST_Touches(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='057' AND b.STATEFP='12' AND b.COUNTYFP='057' AND a.GEOID < b.GEOID AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.188, "row_count": 1, "result": [[1025]]}
{"id": "L2_0009", "question": "Which census_tract in Jacksonville, FL (CITY = 'JACKSONVILLE' and STATEFP = '12') contains the largest number of schools? Return the 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tracts_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='12' AND a.CITY='JACKSONVILLE' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.251, "row_count": 1, "result": [["12031000800"]]}
{"id": "L2_0010", "question": "How many census_tracts in Hillsborough County, FL (STATEFP = '12' and COUNTYFP = '057') intersect floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='057' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.335, "row_count": 1, "result": [[335]]}
{"id": "L2_0011", "question": "Which census_tract in Broward County, FL (STATEFP = '12' and COUNTYFP = '011') has the largest overlap area with zcta polygons? Return the 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tracts_id FROM census_tracts a JOIN zcta b ON ST_Overlaps(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='011' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry, b.geometry))) DESC LIMIT 1;", "elapsed": 0.29, "row_count": 1, "result": [["12011980000"]]}
{"id": "L2_0012", "question": "How many census_tracts in Louisiana (identified by STATEFP = '22') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP = '22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.279, "row_count": 1, "result": [[514]]}
{"id": "L2_0013", "question": "How many schools in Miami, FL (CITY = 'MIAMI' and STATEFP = '12') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN zcta b ON ST_Within(ST_Point(a.LON, a.LAT), b.geometry) WHERE a.STATEFP='12' AND a.CITY='MIAMI' AND ST_IsValid(b.geometry);", "elapsed": 0.201, "row_count": 1, "result": [[537]]}
{"id": "L2_0014", "question": "In Palm Beach County, FL (STATEFP = '12' and COUNTYFP = '099'), which FEMA Flood Hazard Zone—excluding 'X' and 'AREA NOT INCLUDED'—has the second largest number of intersecting census_tracts? Return its FLD_ZONE code.", "sql": "SELECT b.FLD_ZONE FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='099' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) AND b.FLD_ZONE NOT IN ('X','AREA NOT INCLUDED') GROUP BY b.FLD_ZONE ORDER BY COUNT(DISTINCT a.GEOID) DESC LIMIT 1 OFFSET 1;", "elapsed": 2.288, "row_count": 1, "result": [["VE"]]}
{"id": "L2_0015", "question": "How many hospitals in Orleans Parish, LA (COUNTYFIPS = '22071') are located within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN census_tracts b ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.COUNTYFIPS='22071' AND ST_IsValid(b.geometry);", "elapsed": 0.236, "row_count": 1, "result": [[15]]}
{"id": "L2_0016", "question": "How many census_tracts in Florida (identified by STATEFP = '12') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP = '12' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.417, "row_count": 1, "result": [[2465]]}
{"id": "L2_0017", "question": "Which zcta in Florida (STATEFP = '12') contains the largest number of schools? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.236, "row_count": 1, "result": [["33157"]]}
{"id": "L2_0018", "question": "Which census_tract in Louisiana (identified by STATEFP = '22') shares boundaries with the largest number of other census_tracts, including those in neighboring states? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tracts_id FROM census_tracts a JOIN census_tracts b ON ST_Touches(a.geometry, b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY COUNT(DISTINCT b.GEOID) DESC LIMIT 1;", "elapsed": 0.841, "row_count": 1, "result": [["22051028900"]]}
{"id": "L2_0019", "question": "Which zcta in FL (identified by STATEFP = '12') contains the most hospitals? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.193, "row_count": 1, "result": [["32308"]]}
{"id": "L2_0020", "question": "Which floodplain polygon in Louisiana (STATEFP = '22') contains the largest number of schools? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.356, "row_count": 1, "result": [["ad62c09e-ed3a-4753-93b8-62dbd1e7c3c1"]]}
{"id": "L2_0021", "question": "In East Baton Rouge Parish, LA (identified by COUNTYFP = '033' and STATEFP = '22'), which FEMA Flood Hazard Zone (excluding 'X' and 'AREA NOT INCLUDED') ranks second in terms of the number of intersecting census_tracts? Return its FLD_ZONE code.", "sql": "SELECT b.FLD_ZONE FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='22' AND a.COUNTYFP='033' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) AND b.FLD_ZONE IS NOT NULL AND b.FLD_ZONE NOT IN ('X','AREA NOT INCLUDED') GROUP BY b.FLD_ZONE ORDER BY COUNT(DISTINCT a.GEOID) DESC LIMIT 1 OFFSET 1;", "elapsed": 2.198, "row_count": 1, "result": [["A"]]}
{"id": "L2_0022", "question": "In Broward County, FL (identified by COUNTYFP = '011' and STATEFP = '12'), which FEMA Flood Hazard Zone (excluding 'X' and 'AREA NOT INCLUDED') ranks second in terms of the number of intersecting census_tracts? Return its FLD_ZONE code.", "sql": "SELECT b.FLD_ZONE FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='011' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) AND b.FLD_ZONE IS NOT NULL AND b.FLD_ZONE NOT IN ('X','AREA NOT INCLUDED') GROUP BY b.FLD_ZONE ORDER BY COUNT(DISTINCT a.GEOID) DESC LIMIT 1 OFFSET 1;", "elapsed": 2.311, "row_count": 1, "result": [["AH"]]}
{"id": "L2_0023", "question": "Which floodplain polygon in TX (STATEFP = '48') contains the largest number of schools? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.546, "row_count": 1, "result": [["87641727-0834-4106-afd0-c2944041d29c"]]}
{"id": "L2_0024", "question": "Which zcta in LA (STATEFP = '22') contains the most hospitals? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.197, "row_count": 1, "result": [["70508"]]}
{"id": "L2_0025", "question": "Which floodplain polygon in Louisiana (identified by STATEFP = '22') contains the largest number of schools? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE b.STATEFP = '22' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.033, "row_count": 1, "result": [["ad62c09e-ed3a-4753-93b8-62dbd1e7c3c1"]]}
{"id": "L2_0026", "question": "Which census_tract in TX (STATEFP = '48') borders the largest number of neighboring census_tracts? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tracts_id FROM census_tracts a JOIN census_tracts b ON ST_Touches(a.geometry, b.geometry) WHERE a.STATEFP='48' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY COUNT(DISTINCT b.GEOID) DESC LIMIT 1;", "elapsed": 2.955, "row_count": 1, "result": [["48141010101"]]}
{"id": "L2_0027", "question": "Top 2 zcta in LA (identified by STATEFP 22) by number of contained schools.", "sql": "SELECT b.GEOID AS zcta_id, COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM zcta b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP = '22' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY num_schools DESC LIMIT 2;", "elapsed": 0.205, "row_count": 2, "result": [["70806", 24], ["70115", 19]]}
{"id": "L2_0028", "question": "How many schools in TX (STATEFP = '48') are located within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN census_tracts b ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry);", "elapsed": 0.282, "row_count": 1, "result": [[11285]]}
{"id": "L2_0029", "question": "Which ZCTA in TX (identified by STATEFP = '48') contains the largest number of hospitals? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP = '48' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.199, "row_count": 1, "result": [["77030"]]}
{"id": "L2_0030", "question": "Which floodplain polygon in Texas (STATEFP = '48') contains the largest number of schools whose CITY = 'AUSTIN'? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE b.STATEFP='48' AND a.CITY='AUSTIN' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.318, "row_count": 1, "result": [["c8b590c8-8c68-4ee7-8bf5-8fa1f00b01bf"]]}
{"id": "L2_0031", "question": "How many census_tracts in TX (identified by STATEFP 48) contains zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Contains(a.geometry, b.geometry) WHERE a.STATEFP = '48' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.42, "row_count": 1, "result": [[166]]}
{"id": "L2_0032", "question": "How many census_tracts in East Baton Rouge Parish, LA (identified by COUNTYFP 033 and STATEFP 22) intersect zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP = '22' AND a.COUNTYFP = '033' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.223, "row_count": 1, "result": [[108]]}
{"id": "L2_0033", "question": "How many census_tracts in Orleans Parish, LA (identified by COUNTYFP 071 and STATEFP 22) intersect zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP = '22' AND a.COUNTYFP = '071' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.222, "row_count": 1, "result": [[184]]}
{"id": "L2_0034", "question": "Which census_tract in LA (identified by STATEFP = '22') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE b.STATEFP='22' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.054, "row_count": 1, "result": [["22033003804"]]}
{"id": "L2_0035", "question": "How many schools in TX (identified by STATEFP 48) are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP = '48' AND ST_IsValid(b.geometry);", "elapsed": 0.256, "row_count": 1, "result": [[11284]]}
{"id": "L2_0036", "question": "Which floodplain polygon in TX (identified by STATEFP = '48') contains the largest number of hospitals? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE b.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.317, "row_count": 1, "result": [["87641727-0834-4106-afd0-c2944041d29c"]]}
{"id": "L2_0037", "question": "How many census_tracts in FL (identified by STATEFP 12) are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP = '12' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 3.199, "row_count": 1, "result": [[211]]}
{"id": "L2_0038", "question": "How many hospitals in Texas (STATEFP = '48') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN floodplain b ON ST_Within(ST_Point(a.LON, a.LAT), b.geometry) WHERE a.STATEFP = '48' AND ST_IsValid(b.geometry);", "elapsed": 2.341, "row_count": 1, "result": [[723]]}
{"id": "L2_0039", "question": "Which FEMA Flood Hazard Zone in LA (identified by STATEFP = '22') contains the largest number of census_tracts within floodplain polygons? Return its FLD_ZONE code.", "sql": "SELECT b.FLD_ZONE FROM census_tracts a JOIN floodplain b ON ST_Contains(b.geometry,a.geometry) WHERE a.STATEFP='22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY b.FLD_ZONE ORDER BY COUNT(DISTINCT a.GEOID) DESC LIMIT 1;", "elapsed": 2.89, "row_count": 1, "result": [["AREA NOT INCLUDED"]]}
{"id": "L2_0040", "question": "How many schools in TX (identified by STATEFP 48) are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON, a.LAT), b.geometry) WHERE a.STATEFP = '48' AND ST_IsValid(b.geometry);", "elapsed": 2.525, "row_count": 1, "result": [[9704]]}
{"id": "L2_0041", "question": "How many hospitals in LA (identified by STATEFP = '22') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Within(ST_Point(a.LON, a.LAT), b.geometry) WHERE a.STATEFP = '22' AND ST_IsValid(b.geometry);", "elapsed": 0.215, "row_count": 1, "result": [[269]]}
{"id": "L2_0042", "question": "How many census_tracts in TX (identified by STATEFP = '48') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP = '48' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.529, "row_count": 1, "result": [[3143]]}
{"id": "L2_0043", "question": "How many schools in Austin, TX (identified by CITY = 'AUSTIN' and STATEFP = '48') are located within census_tracts polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN census_tracts b ON ST_Within(ST_Point(a.LON, a.LAT), b.geometry) WHERE a.STATEFP = '48' AND a.CITY = 'AUSTIN' AND ST_IsValid(b.geometry);", "elapsed": 0.228, "row_count": 1, "result": [[395]]}
{"id": "L2_0044", "question": "How many census_tracts in LA (identified by STATEFP = '22') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP = '22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.859, "row_count": 1, "result": [[59]]}
{"id": "L2_0045", "question": "How many census_tracts in TX (identified by STATEFP = '48') intersect floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP = '48' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 4.878, "row_count": 1, "result": [[6295]]}
{"id": "L2_0046", "question": "Which FEMA Flood Hazard Zone in Harris County, TX (identified by COUNTYFP = '201' and STATEFP = '48') contains the largest number of census_tracts intersecting floodplain polygons, excluding areas marked as 'AREA NOT INCLUDED' or 'ZONE X'? Return its FLD_ZONE code.", "sql": "SELECT b.FLD_ZONE FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='201' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) AND b.FLD_ZONE NOT IN ('AREA NOT INCLUDED','AREA OF MINIMAL FLOOD HAZARD','X') GROUP BY b.FLD_ZONE ORDER BY COUNT(DISTINCT a.GEOID) DESC LIMIT 1;", "elapsed": 2.176, "row_count": 1, "result": [["AE"]]}
{"id": "L2_0047", "question": "Which census_tract in TX (identified by STATEFP = '48') contains the largest number of schools? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.301, "row_count": 1, "result": [["48451000801"]]}
{"id": "L2_0048", "question": "Which floodplain polygon in TX (identified by STATEFP = '48') contains the largest number of schools? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE b.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.437, "row_count": 1, "result": [["87641727-0834-4106-afd0-c2944041d29c"]]}
{"id": "L2_0049", "question": "How many schools in TX (identified by STATEFP = '48') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON, a.LAT), b.geometry) WHERE a.STATEFP = '48' AND ST_IsValid(b.geometry);", "elapsed": 2.585, "row_count": 1, "result": [[9704]]}
{"id": "L2_0050", "question": "How many schools in New Orleans, LA (identified by CITY = 'NEW ORLEANS' and STATEFP = '22') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN zcta b ON ST_Within(ST_Point(a.LON, a.LAT), b.geometry) WHERE a.STATEFP='22' AND a.CITY='NEW ORLEANS' AND ST_IsValid(b.geometry);", "elapsed": 0.21, "row_count": 1, "result": [[152]]}
{"id": "L2_0051", "question": "Which census_tract in Travis County, TX (identified by COUNTYFP = '453' and STATEFP = '48') has the largest overlap area with floodplain polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN floodplain b ON ST_Overlaps(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='453' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 2.496, "row_count": 1, "result": [["48453036300"]]}
{"id": "L2_0052", "question": "Which census_tract in Orleans County, LA (identified by COUNTYFP = '071' and STATEFP = '22') has the largest overlap area with zcta polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Overlaps(a.geometry, b.geometry) WHERE a.STATEFP='22' AND a.COUNTYFP='071' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.229, "row_count": 1, "result": [["22071001758"]]}
{"id": "L2_0053", "question": "Which zcta in TX (identified by STATEFP = '48') contains the largest number of schools? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.255, "row_count": 1, "result": [["78626"]]}
{"id": "L2_0054", "question": "Which census_tract in Miami-Dade County, FL (identified by COUNTYFP = '086' and STATEFP = '12') has the largest overlap area with zcta polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Overlaps(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='086' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.302, "row_count": 1, "result": [["12086011500"]]}
{"id": "L2_0055", "question": "How many census_tracts in Travis County, TX (identified by COUNTYFP = '453' and STATEFP = '48') intersect other census_tract polygons within the same county (excluding self-intersections)?", "sql": "WITH valid_tracts AS (SELECT GEOID, geometry AS geom FROM census_tracts WHERE STATEFP='48' AND COUNTYFP='453' AND ST_IsValid(geometry)) SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM valid_tracts a JOIN valid_tracts b ON ST_Intersects(a.geom, b.geom) WHERE a.GEOID < b.GEOID;", "elapsed": 0.094, "row_count": 1, "result": [[261]]}
{"id": "L2_0056", "question": "Which FEMA Flood Hazard Zone in Travis County, TX (identified by COUNTYFP = '453' and STATEFP = '48') contains the largest number of census_tracts intersecting floodplain polygons, excluding areas marked as 'AREA NOT INCLUDED' or 'ZONE X'? Return its FLD_ZONE code.", "sql": "SELECT b.FLD_ZONE FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='453' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) AND b.FLD_ZONE NOT IN ('AREA NOT INCLUDED','AREA OF MINIMAL FLOOD HAZARD','X') GROUP BY b.FLD_ZONE ORDER BY COUNT(DISTINCT a.GEOID) DESC LIMIT 1;", "elapsed": 2.217, "row_count": 1, "result": [["AE"]]}
{"id": "L2_0057", "question": "How many census_tracts in Lafayette Parish, LA (identified by COUNTYFP = '055' and STATEFP = '22') intersect other census_tract polygons within the same county (excluding self-intersections)?", "sql": "WITH valid_tracts AS (SELECT GEOID, geometry AS geom FROM census_tracts WHERE STATEFP='22' AND COUNTYFP='055' AND ST_IsValid(geometry)) SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM valid_tracts a JOIN valid_tracts b ON ST_Intersects(a.geom, b.geom) WHERE a.GEOID < b.GEOID;", "elapsed": 0.03, "row_count": 1, "result": [[52]]}
{"id": "L2_0058", "question": "Which census_tract in TX (identified by STATEFP = '48') contains the largest number of schools? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.293, "row_count": 1, "result": [["48451000801"]]}
{"id": "L2_0059", "question": "How many census_tracts in LA (identified by STATEFP = '22') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.279, "row_count": 1, "result": [[514]]}
{"id": "L2_0060", "question": "Which census_tract in FL (identified by STATEFP = '12') contains the largest number of schools? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.264, "row_count": 1, "result": [["12086009010"]]}
{"id": "L2_0061", "question": "Which census_tract in LA (identified by STATEFP = '22') has the largest overlap area with floodplain polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN floodplain b ON ST_Overlaps(a.geometry, b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 5.302, "row_count": 1, "result": [["22087030105"]]}
{"id": "L2_0062", "question": "How many census_tracts in LA (identified by STATEFP = '22') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.813, "row_count": 1, "result": [[59]]}
{"id": "L2_0063", "question": "Which floodplain polygon in TX (identified by STATEFP = '48') contains the largest number of hospitals? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.394, "row_count": 1, "result": [["87641727-0834-4106-afd0-c2944041d29c"]]}
{"id": "L2_0064", "question": "Which census_tract in TX (identified by STATEFP = '48') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.228, "row_count": 1, "result": [["48201313102"]]}
{"id": "L2_0065", "question": "Which zcta in TX (identified by STATEFP = '48') contains the largest number of schools? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.271, "row_count": 1, "result": [["78626"]]}
{"id": "L2_0066", "question": "How many census_tracts in TX (identified by STATEFP = '48') intersect zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.614, "row_count": 1, "result": [[6893]]}
{"id": "L2_0067", "question": "Which census_tract in Florida (identified by STATEFP = '12') contains the largest number of schools? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.259, "row_count": 1, "result": [["12086009010"]]}
{"id": "L2_0068", "question": "How many schools in FL (identified by STATEFP = '12') are located within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN census_tracts b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry);", "elapsed": 0.269, "row_count": 1, "result": [[6596]]}
{"id": "L2_0069", "question": "How many hospitals in FL (identified by STATEFP = '12') intersect zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry);", "elapsed": 0.192, "row_count": 1, "result": [[381]]}
{"id": "L2_0070", "question": "How many schools in TX (identified by STATEFP = '48') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry);", "elapsed": 0.255, "row_count": 1, "result": [[11284]]}
{"id": "L2_0071", "question": "Which census_tract in TX (identified by STATEFP = '48') has the largest overlap area with zcta polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 3.645, "row_count": 1, "result": [["48043950500"]]}
{"id": "L2_0072", "question": "Which census_tract in FL (identified by STATEFP = '12') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.231, "row_count": 1, "result": [["12099001402"]]}
{"id": "L2_0073", "question": "How many hospitals in LA (identified by STATEFP = '22') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry);", "elapsed": 0.192, "row_count": 1, "result": [[269]]}
{"id": "L2_0074", "question": "How many hospitals in FL (identified by STATEFP = '12') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry);", "elapsed": 0.194, "row_count": 1, "result": [[381]]}
{"id": "L2_0075", "question": "How many census_tracts in LA (identified by STATEFP = '22') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 3.027, "row_count": 1, "result": [[59]]}
{"id": "L2_0076", "question": "How many schools in LA (identified by STATEFP = '22') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry);", "elapsed": 0.207, "row_count": 1, "result": [[1787]]}
{"id": "L2_0077", "question": "Which census_tract in Florida (identified by STATEFP = '12') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.223, "row_count": 1, "result": [["12099001402"]]}
{"id": "L2_0078", "question": "Which census_tract in LA (identified by STATEFP = '22') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.221, "row_count": 1, "result": [["22051020519"]]}
{"id": "L2_0079", "question": "Which zcta in TX (identified by STATEFP = '48') contains the largest number of hospitals? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.202, "row_count": 1, "result": [["77030"]]}
{"id": "L2_0080", "question": "How many hospitals in TX (identified by STATEFP = '48') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry);", "elapsed": 0.199, "row_count": 1, "result": [[876]]}
{"id": "L2_0081", "question": "How many census_tracts in Miami-Dade County, FL (identified by COUNTYFP = '086' and STATEFP = '12') intersect zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='086' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.239, "row_count": 1, "result": [[707]]}
{"id": "L2_0082", "question": "How many census_tracts in Harris County, TX (identified by COUNTYFP = '201' and STATEFP = '48') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='201' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.398, "row_count": 1, "result": [[180]]}
{"id": "L2_0083", "question": "Which census_tract in Travis County, TX (identified by COUNTYFP = '453' and STATEFP = '48') has the largest overlap area with floodplain polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='453' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 2.532, "row_count": 1, "result": [["48453036300"]]}
{"id": "L2_0084", "question": "How many census_tracts in FL (identified by STATEFP = '12') intersect other census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN census_tracts b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='12' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 0.63, "row_count": 1, "result": [[5160]]}
{"id": "L2_0085", "question": "How many hospitals in TX (identified by STATEFP = '48') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry);", "elapsed": 0.194, "row_count": 1, "result": [[876]]}
{"id": "L2_0086", "question": "How many hospitals in East Baton Rouge County, LA (identified by COUNTYFP = '033' and STATEFP = '22') are located within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN census_tracts b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='22' AND b.COUNTYFP='033' AND ST_IsValid(b.geometry);", "elapsed": 0.032, "row_count": 1, "result": [[21]]}
{"id": "L2_0087", "question": "Which census_tract in FL (identified by STATEFP = '12') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.225, "row_count": 1, "result": [["12099001402"]]}
{"id": "L2_0088", "question": "How many schools in Louisiana (identified by STATEFP = '22') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry);", "elapsed": 2.394, "row_count": 1, "result": [[1555]]}
{"id": "L2_0089", "question": "Which census_tract in Miami-Dade County, FL (identified by COUNTYFP = '086' and STATEFP = '12') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND b.COUNTYFP='086' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.037, "row_count": 1, "result": [["12086003004"]]}
{"id": "L2_0090", "question": "Which zcta in LA (identified by STATEFP = '22') contains the largest number of schools? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.215, "row_count": 1, "result": [["70806"]]}
{"id": "L2_0091", "question": "Which floodplain polygon in TX (identified by STATEFP = '48') contains the largest number of hospitals? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.349, "row_count": 1, "result": [["87641727-0834-4106-afd0-c2944041d29c"]]}
{"id": "L2_0092", "question": "Which floodplain polygon in LA (identified by STATEFP = '22') contains the largest number of schools? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON, a.LAT)) WHERE a.STATEFP = '22' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.317, "row_count": 1, "result": [["ad62c09e-ed3a-4753-93b8-62dbd1e7c3c1"]]}
{"id": "L2_0093", "question": "Which census_tract in Bexar County, TX (identified by COUNTYFP = '029' and STATEFP = '48') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND b.COUNTYFP='029' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.045, "row_count": 1, "result": [["48029181402"]]}
{"id": "L2_0094", "question": "How many hospitals in LA (identified by STATEFP = '22') are located within zcta polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry);", "elapsed": 0.191, "row_count": 1, "result": [[269]]}
{"id": "L2_0095", "question": "How many hospitals in McAllen, TX (identified by CITY = 'MCALLEN' and STATEFP = '48') are located within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN census_tracts b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND UPPER(a.CITY)='MCALLEN' AND ST_IsValid(b.geometry);", "elapsed": 0.235, "row_count": 1, "result": [[7]]}
{"id": "L2_0096", "question": "Which zcta in FL (identified by STATEFP = '12') contains the largest number of schools? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.228, "row_count": 1, "result": [["33012"]]}
{"id": "L2_0097", "question": "Which census_tract in Orleans Parish, LA (identified by COUNTYFP = '071' and STATEFP = '22') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND b.COUNTYFP='071' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.04, "row_count": 1, "result": [["22071009900"]]}
{"id": "L2_0098", "question": "Which census_tract in FL (identified by STATEFP = '12') has the largest overlap area with zcta polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='12' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 2.119, "row_count": 1, "result": [["12097043802"]]}
{"id": "L2_0099", "question": "Which zcta in LA (identified by STATEFP = '22') contains the largest number of hospitals? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.202, "row_count": 1, "result": [["70508"]]}
{"id": "L2_0100", "question": "Which census_tract in Miami-Dade County, FL (identified by COUNTYFP = '086' and STATEFP = '12') has the largest overlap area with zcta polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='086' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.348, "row_count": 1, "result": [["12086011500"]]}
{"id": "L2_0101", "question": "Which census_tract in Dallas, TX (identified by CITY = 'DALLAS' and STATEFP = '48') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND a.CITY='DALLAS' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.221, "row_count": 1, "result": [["48113002200"]]}
{"id": "L2_0102", "question": "Which floodplain polygon in Bexar County, TX (identified by COUNTYFP = '029' and STATEFP = '48') overlaps the largest total census_tract area? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='029' GROUP BY b.GFID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.731, "row_count": 1, "result": [["0a5d9e00-2e1c-41a5-a89c-cdc365e46d03"]]}
{"id": "L2_0103", "question": "How many schools in Corpus Christi, TX (identified by CITY = 'CORPUS CHRISTI' and STATEFP = '48') fall within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND UPPER(a.CITY)='CORPUS CHRISTI' AND ST_IsValid(b.geometry);", "elapsed": 2.367, "row_count": 1, "result": [[119]]}
{"id": "L2_0104", "question": "Which census_tract in Duval County, FL (identified by COUNTYFP = '031' and STATEFP = '12') has the largest overlap area with floodplain polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='031' GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 1.059, "row_count": 1, "result": [["12031017300"]]}
{"id": "L2_0105", "question": "How many hospitals in Tampa, FL (identified by CITY = 'TAMPA' and STATEFP = '12') are located in floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='12' AND UPPER(a.CITY)='TAMPA' AND ST_IsValid(b.geometry);", "elapsed": 2.305, "row_count": 1, "result": [[17]]}
{"id": "L2_0106", "question": "Which ZCTA in Baton Rouge, LA (identified by CITY = 'BATON ROUGE' and STATEFP = '22') contains the largest number of schools? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND UPPER(a.CITY)='BATON ROUGE' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.199, "row_count": 1, "result": [["70806"]]}
{"id": "L2_0107", "question": "How many hospitals in Shreveport, LA (identified by CITY = 'SHREVEPORT' and STATEFP = '22') are located within ZCTA polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='22' AND a.CITY='SHREVEPORT' AND ST_IsValid(b.geometry);", "elapsed": 0.191, "row_count": 1, "result": [[17]]}
{"id": "L2_0108", "question": "Which census_tract in Palm Beach County, FL (identified by COUNTYFP = '099' and STATEFP = '12') overlaps the largest ZCTA area? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='099' GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.121, "row_count": 1, "result": [["12099007917"]]}
{"id": "L2_0109", "question": "How many schools in Louisiana (identified by STATEFP = '22') fall within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN census_tracts b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='22' AND ST_IsValid(b.geometry);", "elapsed": 0.245, "row_count": 1, "result": [[1786]]}
{"id": "L2_0110", "question": "Which census_tract in Collin County, TX (identified by COUNTYFP = '085' and STATEFP = '48') intersects the largest floodplain area? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='085' GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.693, "row_count": 1, "result": [["48085030102"]]}
{"id": "L2_0111", "question": "Which floodplain polygon in Tampa, FL (identified by CITY = 'TAMPA' and STATEFP = '12') contains the largest number of hospitals? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND UPPER(a.CITY)='TAMPA' AND ST_IsValid(b.geometry) GROUP BY b.GFID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 2.336, "row_count": 1, "result": [["ef973673-3efc-44af-a661-585f27a3bc1b"]]}
{"id": "L2_0112", "question": "Which floodplain polygon in Tarrant County, TX (identified by COUNTYFP = '439' and STATEFP = '48') overlaps the largest area of census_tracts? Return its Unique FEMA floodplain polygon identifier.", "sql": "SELECT b.GFID AS floodplain_id FROM floodplain b JOIN census_tracts a ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='439' GROUP BY b.GFID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.989, "row_count": 1, "result": [["92c5c131-27c2-428a-922a-22415dd3470b"]]}
{"id": "L2_0113", "question": "Which census_tract in Orange County, FL (identified by COUNTYFP = '095' and STATEFP = '12') overlaps the largest ZCTA area? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='095' GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.233, "row_count": 1, "result": [["12095016604"]]}
{"id": "L2_0114", "question": "Which census_tract in Lafayette, LA (identified by CITY = 'Lafayette' and STATEFP = '22') contains the largest number of schools? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND a.CITY='LAFAYETTE' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.23, "row_count": 1, "result": [["22055000200"]]}
{"id": "L2_0115", "question": "Which census_tract in Hillsborough County, FL (identified by COUNTYFP = '057' and STATEFP = '12') overlaps the largest floodplain area? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='057' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 2.659, "row_count": 1, "result": [["12057990000"]]}
{"id": "L2_0116", "question": "How many schools in El Paso, TX (identified by CITY = 'EL PASO' and STATEFP = '48') are located in census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN census_tracts b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND a.CITY='EL PASO' AND ST_IsValid(b.geometry);", "elapsed": 0.233, "row_count": 1, "result": [[296]]}
{"id": "L2_0117", "question": "Which census_tract in East Baton Rouge Parish, LA (identified by COUNTYFP = '033' and STATEFP = '22') overlaps the largest ZCTA area? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='22' AND a.COUNTYFP='033' GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.223, "row_count": 1, "result": [["22033004700"]]}
{"id": "L2_0118", "question": "How many census_tracts in Pinellas County, FL (identified by COUNTYFP = '103' and STATEFP = '12') intersect floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='103' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.335, "row_count": 1, "result": [[275]]}
{"id": "L2_0119", "question": "Which census_tract in Galveston County, TX (identified by COUNTYFP = '167' and STATEFP = '48') has the largest overlap area with floodplain polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='167' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 3.082, "row_count": 1, "result": [["48167990100"]]}
{"id": "L2_0120", "question": "How many hospitals in Fort Worth, TX (identified by CITY = 'FORT WORTH' and STATEFP = '48') intersect floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN floodplain b ON ST_Intersects(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND UPPER(a.CITY)='FORT WORTH' AND ST_IsValid(b.geometry);", "elapsed": 2.324, "row_count": 1, "result": [[26]]}
{"id": "L2_0121", "question": "Which census_tract in Williamson County, TX (identified by COUNTYFP = '491' and STATEFP = '48') overlaps the largest ZCTA area? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='491' GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.088, "row_count": 1, "result": [["48491020900"]]}
{"id": "L2_0122", "question": "How many schools in San Antonio, TX (identified by CITY = 'SAN ANTONIO' and STATEFP = '48') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND a.CITY='SAN ANTONIO' AND ST_IsValid(b.geometry);", "elapsed": 2.369, "row_count": 1, "result": [[668]]}
{"id": "L2_0123", "question": "Which census_tract in Leon County, FL (identified by COUNTYFP = '073' and STATEFP = '12') overlaps the largest area with other census_tract polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN census_tracts b ON ST_Overlaps(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='073' AND a.GEOID < b.GEOID GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 1.525, "row_count": 1, "result": [["12073002701"]]}
{"id": "L2_0124", "question": "How many census_tracts in St. Tammany Parish, LA (identified by COUNTYFP = '103' and STATEFP = '22') are located within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP='22' AND a.COUNTYFP='103' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.382, "row_count": 1, "result": [[41]]}
{"id": "L2_0125", "question": "Which census_tract in Galveston, TX (identified by CITY = 'GALVESTON' and STATEFP = '48') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND a.CITY='GALVESTON' AND ST_IsValid(b.geometry) GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.223, "row_count": 1, "result": [["48167724300"]]}
{"id": "L2_0126", "question": "How many hospitals in Plano, TX (identified by CITY = 'PLANO' and STATEFP = '48') intersect ZCTA polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Intersects(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND a.CITY='PLANO' AND ST_IsValid(b.geometry);", "elapsed": 0.192, "row_count": 1, "result": [[18]]}
{"id": "L2_0127", "question": "How many census_tracts in Palm Beach County, FL (identified by COUNTYFP = '099' and STATEFP = '12') contain floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Contains(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='099' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.38, "row_count": 1, "result": [[261]]}
{"id": "L2_0128", "question": "Which census_tract in Dallas County, TX (identified by COUNTYFP = '113' and STATEFP = '48') overlaps the largest total ZCTA area? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='113' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY SUM(ST_Area(ST_Intersection(a.geometry,b.geometry))) DESC LIMIT 1;", "elapsed": 0.391, "row_count": 1, "result": [["48113016903"]]}
{"id": "L2_0129", "question": "How many census_tracts in Cameron Parish, LA (identified by COUNTYFP = '023' and STATEFP = '22') intersect floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry, b.geometry) WHERE a.STATEFP='22' AND a.COUNTYFP='023' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.392, "row_count": 1, "result": [[5]]}
{"id": "L2_0130", "question": "How many hospitals in Orlando, FL (identified by CITY = 'ORLANDO' and STATEFP = '12') are within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='12' AND a.CITY='ORLANDO' AND ST_IsValid(b.geometry);", "elapsed": 2.319, "row_count": 1, "result": [[14]]}
{"id": "L2_0131", "question": "How many census_tracts in Harris County, TX (identified by COUNTYFP = '201' and STATEFP = '48') intersect other census_tract polygons within the same county (excluding self-intersections)?", "sql": "WITH valid_tracts AS (SELECT GEOID, geometry AS geom FROM census_tracts WHERE STATEFP='48' AND COUNTYFP='201' AND ST_IsValid(geometry)) SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM valid_tracts a JOIN valid_tracts b ON ST_Intersects(a.geom, b.geom) WHERE a.GEOID < b.GEOID;", "elapsed": 0.668, "row_count": 1, "result": [[1077]]}
{"id": "L2_0132", "question": "How many census_tracts in Dallas County, TX (identified by COUNTYFP = '113' and STATEFP = '48') intersect other census_tract polygons within the same county (excluding self-intersections)?", "sql": "WITH valid_tracts AS (SELECT GEOID, geometry AS geom FROM census_tracts WHERE STATEFP='48' AND COUNTYFP='113' AND ST_IsValid(geometry)) SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM valid_tracts a JOIN valid_tracts b ON ST_Intersects(a.geom, b.geom) WHERE a.GEOID < b.GEOID;", "elapsed": 0.249, "row_count": 1, "result": [[591]]}
{"id": "L2_0133", "question": "How many census_tracts in Orleans Parish, LA (identified by COUNTYFP = '071' and STATEFP = '22') intersect other census_tract polygons within the same county (excluding self-intersections)?", "sql": "WITH valid_tracts AS (SELECT GEOID, geometry AS geom FROM census_tracts WHERE STATEFP='22' AND COUNTYFP='071' AND ST_IsValid(geometry)) SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM valid_tracts a JOIN valid_tracts b ON ST_Intersects(a.geom,b.geom) WHERE a.GEOID < b.GEOID;", "elapsed": 0.04, "row_count": 1, "result": [[169]]}
{"id": "L2_0134", "question": "Which census_tract in Orange County, FL (identified by COUNTYFP = '095' and STATEFP = '12') contains the most ZCTA polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Contains(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='095' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry) GROUP BY a.GEOID ORDER BY COUNT(DISTINCT b.GEOID) DESC LIMIT 1;", "elapsed": 0.248, "row_count": 1, "result": [["12095017902"]]}
{"id": "L2_0135", "question": "How many census_tracts in Montgomery County, TX (identified by COUNTYFP = '339' and STATEFP = '48') are completely within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry,b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='339' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.405, "row_count": 1, "result": [[1]]}
{"id": "L2_0136", "question": "How many ZCTA polygons intersect census_tracts in East Baton Rouge Parish, LA (identified by COUNTYFP = '033' and STATEFP = '22')?", "sql": "SELECT COUNT(DISTINCT b.GEOID) AS num_zcta FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='22' AND a.COUNTYFP='033';", "elapsed": 0.049, "row_count": 1, "result": [[38]]}
{"id": "L2_0137", "question": "How many schools in Tampa, FL (identified by CITY = 'TAMPA' and STATEFP = '12') lie within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN census_tracts b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='12' AND UPPER(a.CITY)='TAMPA' AND ST_IsValid(b.geometry);", "elapsed": 0.229, "row_count": 1, "result": [[268]]}
{"id": "L2_0138", "question": "Which census_tract in El Paso County, TX (identified by COUNTYFP = '141' and STATEFP = '48') overlaps the largest number of ZCTA polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='141' GROUP BY a.GEOID ORDER BY COUNT(DISTINCT b.GEOID) DESC LIMIT 1;", "elapsed": 0.054, "row_count": 1, "result": [["48141010101"]]}
{"id": "L2_0139", "question": "How many hospitals in Miami, FL (identified by CITY = 'MIAMI' and STATEFP = '12') are located within census_tract polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN census_tracts b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='12' AND UPPER(a.CITY)='MIAMI' AND ST_IsValid(b.geometry);", "elapsed": 0.218, "row_count": 1, "result": [[20]]}
{"id": "L2_0140", "question": "How many schools in Galveston, TX (identified by CITY = 'GALVESTON' and STATEFP = '48') lie within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND UPPER(a.CITY)='GALVESTON' AND ST_IsValid(b.geometry);", "elapsed": 2.355, "row_count": 1, "result": [[20]]}
{"id": "L2_0141", "question": "Which census_tract in Slidell, LA (identified by CITY = 'SLIDELL' and STATEFP = '22') contains the largest number of hospitals? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND a.CITY='SLIDELL' GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.042, "row_count": 1, "result": [["22103041002"]]}
{"id": "L2_0142", "question": "How many census_tracts in Leon County, FL (identified by COUNTYFP = '073' and STATEFP = '12') are within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Within(a.geometry, b.geometry) WHERE a.STATEFP='12' AND a.COUNTYFP='073' AND ST_IsValid(a.geometry) AND ST_IsValid(b.geometry);", "elapsed": 2.333, "row_count": 1, "result": [[2]]}
{"id": "L2_0143", "question": "How many hospitals in Baton Rouge, LA (identified by CITY = 'BATON ROUGE' and STATEFP = '22') are located in ZCTA polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_hospitals FROM hospitals a JOIN zcta b ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='22' AND a.CITY='BATON ROUGE' AND ST_IsValid(b.geometry);", "elapsed": 0.192, "row_count": 1, "result": [[20]]}
{"id": "L2_0144", "question": "How many census_tracts in Travis County, TX (identified by COUNTYFP = '453' and STATEFP = '48') intersect floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.GEOID) AS num_census_tracts FROM census_tracts a JOIN floodplain b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='453';", "elapsed": 0.564, "row_count": 1, "result": [[290]]}
{"id": "L2_0145", "question": "Which census_tract in Tampa, FL (identified by CITY = 'TAMPA' and STATEFP = '12') contains the largest number of schools? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN schools a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND a.CITY='TAMPA' GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.05, "row_count": 1, "result": [["12057010402"]]}
{"id": "L2_0146", "question": "How many schools in Austin, TX (identified by CITY = 'AUSTIN' and STATEFP = '48') are within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND UPPER(a.CITY)='AUSTIN' AND ST_IsValid(b.geometry);", "elapsed": 2.339, "row_count": 1, "result": [[392]]}
{"id": "L2_0147", "question": "Which census_tract in Bexar County, TX (identified by COUNTYFP = '029' and STATEFP = '48') overlaps the largest number of ZCTA polygons? Return its 11-digit GEOID.", "sql": "SELECT a.GEOID AS census_tract_id FROM census_tracts a JOIN zcta b ON ST_Intersects(a.geometry,b.geometry) WHERE a.STATEFP='48' AND a.COUNTYFP='029' GROUP BY a.GEOID ORDER BY COUNT(DISTINCT b.GEOID) DESC LIMIT 1;", "elapsed": 0.328, "row_count": 1, "result": [["48029131802"]]}
{"id": "L2_0148", "question": "How many schools in Austin, TX (identified by CITY = 'AUSTIN' and STATEFP = '48') lie within floodplain polygons?", "sql": "SELECT COUNT(DISTINCT a.UNIQUE_ID) AS num_schools FROM schools a JOIN floodplain b ON ST_Within(ST_Point(a.LON,a.LAT), b.geometry) WHERE a.STATEFP='48' AND UPPER(a.CITY)='AUSTIN' AND ST_IsValid(b.geometry);", "elapsed": 2.319, "row_count": 1, "result": [[392]]}
{"id": "L2_0149", "question": "Which ZCTA in Miami, FL (identified by CITY = 'MIAMI' and STATEFP = '12') contains the largest number of hospitals? Return its 5-digit GEOID as the zcta id.", "sql": "SELECT b.GEOID AS zcta_id FROM zcta b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='12' AND a.CITY='MIAMI' GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.024, "row_count": 1, "result": [["33136"]]}
{"id": "L2_0150", "question": "Which census_tract in Sugar Land, TX (identified by CITY = 'SUGAR LAND' and STATEFP = '48') has the largest number of hospitals within its boundary? Return its 11-digit GEOID.", "sql": "SELECT b.GEOID AS census_tract_id FROM census_tracts b JOIN hospitals a ON ST_Contains(b.geometry, ST_Point(a.LON,a.LAT)) WHERE a.STATEFP='48' AND a.CITY='SUGAR LAND' GROUP BY b.GEOID ORDER BY COUNT(DISTINCT a.UNIQUE_ID) DESC LIMIT 1;", "elapsed": 0.037, "row_count": 1, "result": [["48157673902"]]}
