{"id": "L1_0001", "question": "Which non-null year had the highest total number of NFIP flood claims in Louisiana (STATEFP 22), based on a key-based join between claims and county tables? Return the year.", "sql": "SELECT STRFTIME('%Y', cl.dateOfLoss) AS year FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND cl.dateOfLoss IS NOT NULL GROUP BY year ORDER BY COUNT(*) DESC LIMIT 1;", "elapsed": 0.112, "row_count": 1, "result": [["2005"]]}
{"id": "L1_0002", "question": "Return the average non-null Normalized coastal flood risk score among unique Texas tracts (STATEFP 48) that have NFIP claims after 2000-01-01 and non-null NRI risk scores.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '48' AND dateOfLoss >= DATE '2000-01-01') SELECT AVG(n.CFLD_RISKS) AS avg_coastal_risk FROM claim_tracts t JOIN nri n ON t.GEOID = n.GEOID WHERE n.CFLD_RISKS IS NOT NULL;", "elapsed": 0.019, "row_count": 1, "result": [[32.19418255613956]]}
{"id": "L1_0003", "question": "How many non-null ZIP codes in Florida (STATEFP 12) contain both at least one school and one hospital?", "sql": "SELECT COUNT(DISTINCT s.ZIP) AS num_zip_with_both FROM schools s JOIN hospitals h ON s.ZIP = h.ZIP WHERE s.STATEFP = '12' AND h.STATEFP = '12' AND s.ZIP IS NOT NULL;", "elapsed": 0.006, "row_count": 1, "result": [[269]]}
{"id": "L1_0004", "question": "Which 3 Texas counties (STATEFP 48) have the highest non-null percentage of individuals with zero vulnerability components?", "sql": "SELECT c.NAME AS county_name FROM cre cr JOIN county c ON LEFT(cr.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' AND cr.PRED0_PE IS NOT NULL GROUP BY c.NAME ORDER BY AVG(cr.PRED0_PE) DESC LIMIT 3;", "elapsed": 0.006, "row_count": 3, "result": [["Kent"], ["Sterling"], ["Hartley"]]}
{"id": "L1_0005", "question": "In East Baton Rouge Parish, LA (GEOID prefix 22033), how many NFIP claims occurred in tracts where at least 20% of the population lacks a high-school diploma (non-null value)?", "sql": "SELECT COUNT(*) AS num_claims FROM claims cl JOIN svi s ON cl.GEOID = s.GEOID WHERE cl.GEOID LIKE '22033%' AND s.EP_NOHSDP IS NOT NULL AND s.EP_NOHSDP >= 20;", "elapsed": 0.009, "row_count": 1, "result": [[1610]]}
{"id": "L1_0006", "question": "Which Louisiana census tract (STATEFP 22) has the highest average non-null expected annual loss for buildings from riverine flooding according to NRI data? Return its 11-digit GEOID.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN nri n ON t.GEOID = n.GEOID WHERE t.STATEFP = '22' AND n.RFLD_EALB IS NOT NULL GROUP BY t.GEOID ORDER BY AVG(n.RFLD_EALB) DESC LIMIT 1;", "elapsed": 0.078, "row_count": 1, "result": [["22033004021"]]}
{"id": "L1_0007", "question": "List the top 3 riverine flood risk rating categories in Hidalgo County, Texas (GEOID prefix 48215), ranked by total non-null expected annual population loss (USD).", "sql": "SELECT n.RFLD_RISKR FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.GEOID = '48215' AND n.RFLD_EALP IS NOT NULL GROUP BY n.RFLD_RISKR ORDER BY SUM(n.RFLD_EALP) DESC LIMIT 3;", "elapsed": 0.021, "row_count": 3, "result": [["Relatively High"], ["Relatively Moderate"], ["Relatively Low"]]}
{"id": "L1_0008", "question": "Return the 2nd highest Louisiana county (STATEFP 22) ranked by total non-null payout amount (USD) for building structure damage.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND cl.amountPaidOnBuildingClaim IS NOT NULL GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 1 OFFSET 1;", "elapsed": 0.032, "row_count": 1, "result": [["Jefferson"]]}
{"id": "L1_0009", "question": "Return the average non-null percentage of individuals with zero components of social vulnerability in Florida (STATEFP 12) census tracts that have NFIP claims since 2020-01-01.", "sql": "SELECT AVG(cr.PRED0_PE) AS avg_resilience FROM cre cr JOIN claims cl ON cr.GEOID = cl.GEOID WHERE cl.STATEFP = '12' AND cl.dateOfLoss >= DATE '2020-01-01' AND cr.PRED0_PE IS NOT NULL;", "elapsed": 0.015, "row_count": 1, "result": [[27.916328723332295]]}
{"id": "L1_0010", "question": "List the top 2 Florida census tracts (STATEFP 12) with the highest non-null normalized coastal flood risk scores based on NRI data. Return their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN nri n ON t.GEOID = n.GEOID WHERE t.STATEFP = '12' AND n.CFLD_RISKS IS NOT NULL ORDER BY n.CFLD_RISKS DESC LIMIT 2;", "elapsed": 0.012, "row_count": 2, "result": [["12109020708"], ["12029970201"]]}
{"id": "L1_0011", "question": "In Jefferson Parish, LA (GEOID prefix 22051), how many NFIP claims occurred in tracts where at least 15% of the population is without health insurance?", "sql": "SELECT COUNT(*) AS num_claims FROM claims cl JOIN svi s ON cl.GEOID = s.GEOID WHERE cl.GEOID LIKE '22051%' AND s.EP_UNINSUR >= 15;", "elapsed": 0.012, "row_count": 1, "result": [[19188]]}
{"id": "L1_0012", "question": "Which ZIP code in Texas (STATEFP 48) contains the largest number of schools and hospitals combined? Return the 5-digit ZIP code.", "sql": "SELECT s.ZIP AS zip_code FROM schools s JOIN hospitals h ON s.ZIP = h.ZIP WHERE s.STATEFP = '48' AND h.STATEFP = '48' GROUP BY s.ZIP ORDER BY (COUNT(DISTINCT s.SCHOOL_ID) + COUNT(DISTINCT h.HOSPITAL_ID)) DESC LIMIT 1;", "elapsed": 0.051, "row_count": 1, "result": [["78539"]]}
{"id": "L1_0013", "question": "Return the Louisiana county (STATEFP 22) with the highest number of 'CRITICAL ACCESS' hospitals.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID WHERE h.STATEFP = '22' AND h.TYPE = 'CRITICAL ACCESS' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 1;", "elapsed": 0.004, "row_count": 1, "result": [["Concordia"]]}
{"id": "L1_0014", "question": "In Florida (STATEFP 12), what is the average non-null expected exposure value of buildings to coastal flooding among tracts that have NFIP claims?", "sql": "SELECT AVG(n.CFLD_EXPB) AS avg_building_exposure FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID WHERE cl.STATEFP = '12' AND n.CFLD_EXPB IS NOT NULL;", "elapsed": 0.019, "row_count": 1, "result": [[530198604.3821732]]}
{"id": "L1_0015", "question": "List the top 4 most common coastal flood risk rating categories in St. Bernard Parish, LA (GEOID prefix 22087), ranked by the number of NFIP claims.", "sql": "SELECT n.CFLD_RISKR FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID WHERE cl.GEOID LIKE '22087%' GROUP BY n.CFLD_RISKR ORDER BY COUNT(*) DESC LIMIT 4;", "elapsed": 0.01, "row_count": 2, "result": [["Relatively Low"], ["Relatively High"]]}
{"id": "L1_0016", "question": "What is the average of county-level ratios of water-only census tracts across Florida (STATEFP 12)?", "sql": "SELECT AVG(water_ratio) AS avg_water_tract_ratio FROM (SELECT c.NAME, AVG(CASE WHEN cr.WATER_TRACT = 1 THEN 1 ELSE 0 END) AS water_ratio FROM cre cr JOIN county c ON LEFT(cr.GEOID, 5) = c.GEOID WHERE c.STATEFP = '12' GROUP BY c.NAME);", "elapsed": 0.011, "row_count": 1, "result": [[0.030183211258131823]]}
{"id": "L1_0017", "question": "Which 3 Louisiana counties (STATEFP 22) have the highest total non-null NFIP claim payouts for buildings? Return their county names.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND cl.amountPaidOnBuildingClaim IS NOT NULL GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 3;", "elapsed": 0.032, "row_count": 3, "result": [["Orleans"], ["Jefferson"], ["St. Bernard"]]}
{"id": "L1_0018", "question": "In Texas (STATEFP 48), which ZIP code area has the highest combined number of schools and hospitals? Return the ZIP code.", "sql": "SELECT s.ZIP AS zip_code FROM schools s JOIN hospitals h ON s.ZIP = h.ZIP WHERE s.STATEFP = '48' AND h.STATEFP = '48' GROUP BY s.ZIP ORDER BY (COUNT(DISTINCT s.SCHOOL_ID) + COUNT(DISTINCT h.HOSPITAL_ID)) DESC LIMIT 1;", "elapsed": 0.01, "row_count": 1, "result": [["78539"]]}
{"id": "L1_0019", "question": "In Florida (STATEFP 12), how many hospitals are located in ZIP codes starting with '33'?", "sql": "SELECT COUNT(DISTINCT h.HOSPITAL_ID) AS num_hospitals FROM hospitals h JOIN county c ON LEFT(h.COUNTYFIPS, 5) = c.GEOID WHERE c.STATEFP = '12' AND h.ZIP LIKE '33%';", "elapsed": 0.004, "row_count": 1, "result": [[161]]}
{"id": "L1_0020", "question": "Which 3 Louisiana counties (STATEFP 22) contain the highest number of hospitals? Return their names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON LEFT(h.COUNTYFIPS, 5) = c.GEOID WHERE c.STATEFP = '22' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 3;", "elapsed": 0.004, "row_count": 3, "result": [["East Baton Rouge"], ["Lafayette"], ["Caddo"]]}
{"id": "L1_0021", "question": "Which Louisiana county (STATEFP 22) contains the largest number of census tracts? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM county c JOIN census_tracts t ON LEFT(t.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' GROUP BY c.NAME ORDER BY COUNT(DISTINCT t.GEOID) DESC LIMIT 1;", "elapsed": 0.006, "row_count": 1, "result": [["Orleans"]]}
{"id": "L1_0022", "question": "Which Louisiana county (STATEFP 22) has the largest resilience gap, difference between non-null percentage of individuals with zero components of social vulnerability and non-null percentage of individuals with three plus components of social vulnerability? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM cre cr JOIN county c ON LEFT(cr.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND cr.PRED0_PE IS NOT NULL AND cr.PRED3_PE IS NOT NULL GROUP BY c.NAME ORDER BY AVG(cr.PRED0_PE - cr.PRED3_PE) DESC LIMIT 1;", "elapsed": 0.009, "row_count": 1, "result": [["West Baton Rouge"]]}
{"id": "L1_0023", "question": "Which Louisiana county (STATEFP 22) had the largest number of NFIP flood claims in 2003? Return the county name.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND cl.dateOfLoss >= DATE '2003-01-01' AND cl.dateOfLoss < DATE '2004-01-01' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 1;", "elapsed": 0.01, "row_count": 1, "result": [["Orleans"]]}
{"id": "L1_0024", "question": "Which 3 Texas counties (STATEFP 48) have the largest number of hospitals? Return their county names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON LEFT(h.COUNTYFIPS, 5) = c.GEOID WHERE c.STATEFP = '48' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 3;", "elapsed": 0.003, "row_count": 3, "result": [["Harris"], ["Tarrant"], ["Bexar"]]}
{"id": "L1_0025", "question": "Return the Louisiana county name (STATEFP 22) with the highest average non-null percentage of individuals with one to two components of social vulnerability.", "sql": "SELECT c.NAME AS county_name FROM cre cr JOIN county c ON LEFT(cr.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND cr.PRED12_PE IS NOT NULL GROUP BY c.NAME ORDER BY AVG(cr.PRED12_PE) DESC LIMIT 1;", "elapsed": 0.006, "row_count": 1, "result": [["West Feliciana"]]}
{"id": "L1_0026", "question": "In Texas (STATEFP 48), which ZIP code area has the highest proportion of COLLEGE-type schools relative to total schools and hospitals combined? Return the ZIP code.", "sql": "SELECT s.ZIP AS zip_code FROM schools s JOIN hospitals h ON s.ZIP = h.ZIP WHERE s.STATEFP = '48' AND h.STATEFP = '48' GROUP BY s.ZIP HAVING COUNT(DISTINCT s.SCHOOL_ID) > 0 ORDER BY (SUM(CASE WHEN s.TYPE = 'COLLEGE' THEN 1 ELSE 0 END) * 1.0 / (COUNT(DISTINCT s.SCHOOL_ID) + COUNT(DISTINCT h.HOSPITAL_ID))) DESC LIMIT 1;", "elapsed": 0.077, "row_count": 1, "result": [["78229"]]}
{"id": "L1_0027", "question": "Which Louisiana county (STATEFP 22) has the highest average unemployment? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM svi s JOIN county c ON LEFT(s.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND s.E_UNEMP IS NOT NULL GROUP BY c.NAME ORDER BY AVG(s.E_UNEMP) DESC LIMIT 1;", "elapsed": 0.006, "row_count": 1, "result": [["St. Helena"]]}
{"id": "L1_0028", "question": "Which 3 Florida counties (STATEFP 12) have the highest average non-null riverine flood risk score?", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.STATEFP = '12' AND n.RFLD_RISKS IS NOT NULL GROUP BY c.NAME ORDER BY AVG(n.RFLD_RISKS) DESC LIMIT 3;", "elapsed": 0.005, "row_count": 3, "result": [["Calhoun"], ["Lafayette"], ["Dixie"]]}
{"id": "L1_0029", "question": "Which 5 Texas counties (STATEFP 48) have the highest average non-null estimated population below 150% of the poverty line?", "sql": "SELECT c.NAME AS county_name FROM svi s JOIN county c ON LEFT(s.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' AND s.E_POV150 IS NOT NULL GROUP BY c.NAME ORDER BY AVG(s.E_POV150) DESC LIMIT 5;", "elapsed": 0.006, "row_count": 5, "result": [["Starr"], ["Dimmit"], ["Hidalgo"], ["Maverick"], ["Walker"]]}
{"id": "L1_0030", "question": "Which Florida county (STATEFP 12) has the highest average non-null building exposure to coastal flooding?", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.STATEFP = '12' AND n.CFLD_EXPB IS NOT NULL GROUP BY c.NAME ORDER BY AVG(n.CFLD_EXPB) DESC LIMIT 1;", "elapsed": 0.005, "row_count": 1, "result": [["Monroe"]]}
{"id": "L1_0031", "question": "Average coastal flood risk score among tracts with claims in Texas (identified by STATEFP 48) after 2010-01-01.", "sql": "SELECT AVG(n.CFLD_RISKS) AS avg_coastal_risk FROM nri n JOIN (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '48' AND dateOfLoss >= DATE '2010-01-01') cl ON n.GEOID = cl.GEOID WHERE n.CFLD_RISKS IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[32.45436831840361]]}
{"id": "L1_0032", "question": "Top 2 Florida census tracts (identified by STATEFP 12) with the highest non-null estimated number of households with high housing cost burden. List their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN svi s ON t.GEOID = s.GEOID WHERE t.STATEFP = '12' AND s.E_HBURD IS NOT NULL ORDER BY s.E_HBURD DESC LIMIT 2;", "elapsed": 0.005, "row_count": 2, "result": [["12095017022"], ["12011110354"]]}
{"id": "L1_0033", "question": "Average percentage of individuals with zero components of social vulnerability in Louisiana tracts (identified by STATEFP 22) with claims since 2017-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '22' AND dateOfLoss >= DATE '2017-01-01') SELECT AVG(cr.PRED0_PE) AS avg_resilience FROM cre cr JOIN claim_tracts t ON cr.GEOID = t.GEOID;", "elapsed": 0.012, "row_count": 1, "result": [[31.270158870255955]]}
{"id": "L1_0034", "question": "How many Louisiana census tracts (identified by GEOID starting with 22) with NFIP claims have an estimated number of households with high housing cost burden greater than 1000?", "sql": "SELECT COUNT(*) AS num_high_housing_burden FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '22%') cl ON s.GEOID = cl.GEOID WHERE s.E_HBURD > 1000;", "elapsed": 0.01, "row_count": 1, "result": [[16]]}
{"id": "L1_0035", "question": "Average non-null coastal flood expected annual population loss among tracts with claims in Florida (identified by STATEFP 12) after 2005-01-01.", "sql": "SELECT AVG(CAST(n.CFLD_EALP AS DOUBLE)) AS avg_eal_population FROM nri n JOIN (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='12' AND dateOfLoss >= DATE '2005-01-01') cl ON n.GEOID = cl.GEOID WHERE n.CFLD_EALP IS NOT NULL;", "elapsed": 0.014, "row_count": 1, "result": [[0.00012642065015815664]]}
{"id": "L1_0036", "question": "Top 3 Florida counties (identified by STATEFP 12) with the highest non-null payout amount for building structure damage. List their county names.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '12' AND cl.amountPaidOnBuildingClaim IS NOT NULL GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 3;", "elapsed": 0.029, "row_count": 3, "result": [["Lee"], ["Pinellas"], ["Collier"]]}
{"id": "L1_0037", "question": "Which Texas county (identified by STATEFP = '48') has the highest average difference between non-null percentage of individuals with one-two components of social vulnerability and non-null percentage of individuals with zero components of social vulnerability among its tracts, based on CRE records? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM cre r JOIN county c ON LEFT(r.GEOID,5)=c.GEOID WHERE c.STATEFP='48' AND r.PRED12_PE IS NOT NULL AND r.PRED0_PE IS NOT NULL GROUP BY c.NAME ORDER BY AVG(r.PRED12_PE - r.PRED0_PE) DESC LIMIT 1;", "elapsed": 0.005, "row_count": 1, "result": [["Lipscomb"]]}
{"id": "L1_0038", "question": "Between Texas (STATEFP = '48') and Louisiana (STATEFP = '22'), which state shows a higher average production of non-null estimated percent without health insurance and coastal flood risk score? Return its 2-digit STATEFP code.", "sql": "SELECT LEFT(s.GEOID, 2) AS STATEFP FROM svi s JOIN nri n ON s.GEOID = n.GEOID WHERE LEFT(s.GEOID, 2) IN ('48','22') AND s.EP_UNINSUR IS NOT NULL AND n.CFLD_RISKS IS NOT NULL GROUP BY LEFT(s.GEOID, 2) ORDER BY AVG(s.EP_UNINSUR * n.CFLD_RISKS) DESC LIMIT 1;", "elapsed": 0.009, "row_count": 1, "result": [["48"]]}
{"id": "L1_0039", "question": "Average non-null percentage of population aged 65 and older in Lee, FL (identified by GEOID starting with 12071) tracts with claims.", "sql": "SELECT AVG(s.EP_AGE65) AS avg_elderly_pct FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '12071%') cl ON s.GEOID = cl.GEOID WHERE s.EP_AGE65 IS NOT NULL;", "elapsed": 0.008, "row_count": 1, "result": [[34.92562814070352]]}
{"id": "L1_0040", "question": "Average non-null percentage of population aged 65 and older in Florida tracts (identified by STATEFP 12) with NFIP claims since 2022-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '12' AND dateOfLoss >= DATE '2022-01-01') SELECT AVG(s.EP_AGE65) AS avg_elderly_pct FROM svi s JOIN claim_tracts t ON s.GEOID = t.GEOID WHERE s.EP_AGE65 IS NOT NULL;", "elapsed": 0.011, "row_count": 1, "result": [[24.16898305084746]]}
{"id": "L1_0041", "question": "Lowest riverine flood risk rating category in Dallas County, TX (identified by GEOID starting with 48113), ranked by total NFIP claims.", "sql": "SELECT n.RFLD_RISKR FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID WHERE cl.GEOID LIKE '48113%' GROUP BY n.RFLD_RISKR ORDER BY COUNT(*) ASC LIMIT 1;", "elapsed": 0.008, "row_count": 1, "result": [["Relatively High"]]}
{"id": "L1_0042", "question": "In Hidalgo, TX (identified by GEOID starting with 48215), how many NFIP claims occurred in tracts with NRI riverine risk rating 'Very High'?", "sql": "SELECT COUNT(*) AS num_claims FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID WHERE cl.GEOID LIKE '48215%' AND n.RFLD_RISKR = 'Very High';", "elapsed": 0.007, "row_count": 1, "result": [[0]]}
{"id": "L1_0043", "question": "Average non-null percentage of population without health insurance in Florida (identified by GEOID starting with 12) tracts with claims since 2005-01-01.", "sql": "SELECT AVG(s.EP_UNINSUR) AS avg_uninsured_pct FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '12%' AND dateOfLoss >= DATE '2005-01-01') cl ON s.GEOID = cl.GEOID WHERE s.EP_UNINSUR IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[11.639308548425289]]}
{"id": "L1_0044", "question": "Average non-null estimated number of single-parent households among Louisiana tracts (identified by STATEFP 22) with NFIP claims since 2005-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='22' AND dateOfLoss >= DATE '2005-01-01') SELECT AVG(s.E_SNGPNT) AS avg_single_parent FROM svi s JOIN claim_tracts t ON s.GEOID=t.GEOID WHERE s.E_SNGPNT IS NOT NULL;", "elapsed": 0.014, "row_count": 1, "result": [[108.28337236533957]]}
{"id": "L1_0045", "question": "Top 3 Texas census tracts (identified by STATEFP 48) with the highest non-null NRI riverine expected annual building loss. List their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN nri n ON t.GEOID = n.GEOID WHERE t.STATEFP = '48' AND n.RFLD_EALB IS NOT NULL ORDER BY CAST(n.RFLD_EALB AS DOUBLE) DESC LIMIT 3;", "elapsed": 0.004, "row_count": 3, "result": [["48167724000"], ["48167723900"], ["48361020300"]]}
{"id": "L1_0046", "question": "Which Texas county (STATEFP 48) whose entire area lies west of longitude -97 has the highest total non-null payout amount for building structure damage? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' AND cl.amountPaidOnBuildingClaim IS NOT NULL AND ST_XMax(c.geometry) < -97 GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 1;", "elapsed": 0.09, "row_count": 1, "result": [["Cameron"]]}
{"id": "L1_0047", "question": "Top 3 Louisiana counties (identified by STATEFP 22) with the highest number of hospitals whose names include 'Medical Center'. Return the county names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID WHERE h.STATEFP = '22' AND h.NAME ILIKE '%Medical Center%' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 3;", "elapsed": 0.008, "row_count": 3, "result": [["East Baton Rouge"], ["Orleans"], ["Caddo"]]}
{"id": "L1_0048", "question": "In Travis, TX (identified by GEOID starting with 48453), how many NFIP claims occurred in tracts where at least 10% of the population has limited English proficiency?", "sql": "SELECT COUNT(*) AS num_claims FROM claims cl JOIN svi s ON cl.GEOID = s.GEOID WHERE cl.GEOID LIKE '48453%' AND s.EP_LIMENG >= 10;", "elapsed": 0.008, "row_count": 1, "result": [[225]]}
{"id": "L1_0049", "question": "Top 3 Texas census tracts (identified by STATEFP 48) with the highest positive NRI coastal flood risk scores. List their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN nri n ON t.GEOID = n.GEOID WHERE t.STATEFP = '48' AND n.CFLD_RISKS > 0 ORDER BY n.CFLD_RISKS DESC LIMIT 3;", "elapsed": 0.005, "row_count": 3, "result": [["48061012305"], ["48061012304"], ["48007950400"]]}
{"id": "L1_0050", "question": "Top 2 most common NRI riverine risk rating categories in Duval County, Florida (identified by GEOID starting with 12031), ranked by number of NFIP claims.", "sql": "SELECT n.RFLD_RISKR FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID WHERE cl.GEOID LIKE '12031%' GROUP BY n.RFLD_RISKR ORDER BY COUNT(*) DESC LIMIT 2;", "elapsed": 0.009, "row_count": 2, "result": [["Relatively Moderate"], ["Relatively High"]]}
{"id": "L1_0051", "question": "Average non-null NRI coastal flood expected annual building loss among tracts with claims in Texas (identified by STATEFP 48) after 2010-01-01.", "sql": "SELECT AVG(CAST(n.CFLD_EALB AS DOUBLE)) AS avg_eal_building FROM nri n JOIN (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '48' AND dateOfLoss >= DATE '2010-01-01') cl ON n.GEOID = cl.GEOID WHERE n.CFLD_EALB IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[26269.277961191197]]}
{"id": "L1_0052", "question": "The 5th highest Texas census tract (identified by STATEFP 48) by non-null estimated percentage of households with no vehicle available. List their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN svi s ON t.GEOID = s.GEOID WHERE t.STATEFP = '48' AND s.EP_NOVEH IS NOT NULL ORDER BY s.EP_NOVEH DESC LIMIT 1 OFFSET 4;", "elapsed": 0.005, "row_count": 1, "result": [["48201312400"]]}
{"id": "L1_0053", "question": "Top 5 Texas counties (identified by STATEFP 48) with the largest number of hospitals. List their county names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID WHERE h.STATEFP = '48' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 5;", "elapsed": 0.004, "row_count": 5, "result": [["Harris"], ["Tarrant"], ["Bexar"], ["Dallas"], ["Collin"]]}
{"id": "L1_0054", "question": "Top 5 Louisiana census tracts (identified by STATEFP 22) with the highest average non-null coastal flood risk scores. List their 11-digit GEOIDs.", "sql": "SELECT n.GEOID FROM nri n JOIN census_tracts t ON n.GEOID = t.GEOID WHERE t.STATEFP = '22' AND n.CFLD_RISKS IS NOT NULL GROUP BY n.GEOID ORDER BY AVG(n.CFLD_RISKS) DESC LIMIT 5;", "elapsed": 0.006, "row_count": 5, "result": [["22051027903"], ["22089063100"], ["22089062800"], ["22099021000"], ["22051027904"]]}
{"id": "L1_0055", "question": "Top 3 Louisiana counties (identified by STATEFP 22) with the highest Payout amount for building structure damage. List their county names.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 3;", "elapsed": 0.032, "row_count": 3, "result": [["Orleans"], ["Jefferson"], ["St. Bernard"]]}
{"id": "L1_0056", "question": "Top 3 Texas counties (identified by STATEFP 48) with the highest number of 'GENERAL ACUTE CARE' hospitals. Return their county names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID WHERE h.STATEFP = '48' AND h.TYPE = 'GENERAL ACUTE CARE' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 3;", "elapsed": 0.004, "row_count": 3, "result": [["Harris"], ["Tarrant"], ["Dallas"]]}
{"id": "L1_0057", "question": "Top 5 Louisiana census tracts (identified by STATEFP 22) with the highest non-null percentage of population without a high school diploma. List their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN svi s ON t.GEOID = s.GEOID WHERE t.STATEFP = '22' AND s.EP_NOHSDP IS NOT NULL ORDER BY s.EP_NOHSDP DESC LIMIT 5;", "elapsed": 0.005, "row_count": 5, "result": [["22109001302"], ["22065960400"], ["22075050700"], ["22031950400"], ["22071014500"]]}
{"id": "L1_0058", "question": "Average non-null percentage of individuals with one to two components of social vulnerability in Texas tracts (identified by STATEFP 48) with claims since 2015-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='48' AND dateOfLoss >= DATE '2015-01-01') SELECT AVG(cr.PRED12_PE) AS avg_mid_resilience FROM cre cr JOIN claim_tracts t ON cr.GEOID=t.GEOID WHERE cr.PRED12_PE IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[46.407776273022755]]}
{"id": "L1_0059", "question": "In Cameron, TX (identified by GEOID starting with 48061), how many NFIP claims occurred in tracts with riverine flood risk rating 'Very Low'?", "sql": "SELECT COUNT(*) AS num_claims FROM claims cl JOIN nri n ON cl.GEOID = n.GEOID WHERE cl.GEOID LIKE '48061%' AND n.RFLD_RISKR = 'Very Low';", "elapsed": 0.007, "row_count": 1, "result": [[27]]}
{"id": "L1_0060", "question": "The 4th highest Texas census tract (identified by STATEFP 48) by non-null percentage of population with disabilities. List their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN svi s ON t.GEOID = s.GEOID WHERE t.STATEFP = '48' AND s.EP_DISABL IS NOT NULL ORDER BY s.EP_DISABL DESC LIMIT 1 OFFSET 3;", "elapsed": 0.005, "row_count": 1, "result": [["48289950301"]]}
{"id": "L1_0061", "question": "Which tract in Hidalgo, TX (identified by GEOID starting with 48215) with NFIP claims has the highest non-null margin of error for estimated disabled population? Return its 11-digit GEOID.", "sql": "SELECT s.GEOID AS tract_geoid FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '48215%') cl ON s.GEOID = cl.GEOID WHERE s.M_DISABL IS NOT NULL ORDER BY s.M_DISABL DESC LIMIT 1;", "elapsed": 0.006, "row_count": 1, "result": [["48215023526"]]}
{"id": "L1_0062", "question": "How many Louisiana counties (identified by STATEFP 22) have at least one hospital record?", "sql": "SELECT COUNT(DISTINCT c.GEOID) AS num_counties_with_hospitals FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID WHERE h.STATEFP = '22';", "elapsed": 0.003, "row_count": 1, "result": [[59]]}
{"id": "L1_0063", "question": "Average share of water-only tracts among Florida tracts (STATEFP 12) that have at least one NFIP claim since 2022-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='12' AND dateOfLoss >= DATE '2022-01-01') SELECT AVG(CASE WHEN cr.WATER_TRACT = 1 THEN 1 ELSE 0 END) AS avg_water_fraction FROM cre cr JOIN claim_tracts t ON cr.GEOID = t.GEOID;", "elapsed": 0.015, "row_count": 1, "result": [[0.00033886818027787193]]}
{"id": "L1_0064", "question": "Top 5 Texas counties (STATEFP 48) with the highest average share of water-only tracts according to CRE data. List their county names.", "sql": "SELECT c.NAME AS county_name FROM cre cr JOIN county c ON LEFT(cr.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' GROUP BY c.NAME ORDER BY AVG(CASE WHEN cr.WATER_TRACT = 1 THEN 1 ELSE 0 END) DESC LIMIT 5;", "elapsed": 0.005, "row_count": 5, "result": [["Kenedy"], ["Willacy"], ["Chambers"], ["Calhoun"], ["Kleberg"]]}
{"id": "L1_0065", "question": "How many Louisiana tracts (identified by GEOID starting with 22) with NFIP claims since 2015-01-01 have an estimated population with no Internet access greater than 300?", "sql": "SELECT COUNT(*) AS num_low_internet FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '22%' AND dateOfLoss >= DATE '2015-01-01') cl ON s.GEOID = cl.GEOID WHERE s.E_NOINT > 300;", "elapsed": 0.012, "row_count": 1, "result": [[293]]}
{"id": "L1_0066", "question": "In Texas (identified by GEOID starting with 48), average estimated population below 150% poverty line among tracts with claims since 2000-01-01.", "sql": "SELECT AVG(s.E_POV150) AS avg_poverty FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '48%' AND dateOfLoss >= DATE '2000-01-01') cl ON s.GEOID = cl.GEOID;", "elapsed": 0.011, "row_count": 1, "result": [[1003.8878881251482]]}
{"id": "L1_0067", "question": "Top 3 Texas counties (identified by STATEFP 48) with the highest Payout amount for building structure damage. List their county names.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 3;", "elapsed": 0.03, "row_count": 3, "result": [["Harris"], ["Galveston"], ["Jefferson"]]}
{"id": "L1_0068", "question": "Average non-null population universe used in tract-level resilience estimation among Texas tracts (identified by STATEFP 48) with NFIP claims since 2022-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='48' AND dateOfLoss >= DATE '2022-01-01') SELECT AVG(cr.POPUNI) AS avg_model_population FROM cre cr JOIN claim_tracts t ON cr.GEOID=t.GEOID WHERE cr.POPUNI IS NOT NULL;", "elapsed": 0.011, "row_count": 1, "result": [[4615.327322404371]]}
{"id": "L1_0069", "question": "Top 5 Louisiana tracts (identified by STATEFP 22) with the highest non-null expected annual building loss due to riverine flooding. List their 11-digit GEOIDs.", "sql": "SELECT n.GEOID AS tract_geoid FROM nri n JOIN census_tracts t ON n.GEOID = t.GEOID WHERE t.STATEFP = '22' AND n.RFLD_EALB IS NOT NULL ORDER BY CAST(n.RFLD_EALB AS DOUBLE) DESC LIMIT 5;", "elapsed": 0.004, "row_count": 5, "result": [["22033004021"], ["22105954200"], ["22055001904"], ["22033003807"], ["22033004022"]]}
{"id": "L1_0070", "question": "Top 3 Florida counties (identified by STATEFP 12) with the highest number of hospitals located in ZIP codes starting with '33'. Return their county names.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID WHERE h.STATEFP = '12' AND h.ZIP LIKE '33%' GROUP BY c.NAME ORDER BY COUNT(*) DESC LIMIT 3;", "elapsed": 0.003, "row_count": 3, "result": [["Miami-Dade"], ["Broward"], ["Hillsborough"]]}
{"id": "L1_0071", "question": "Among Louisiana counties (STATEFP 22) north of latitude 31.0, which has the highest non-null average payout per NFIP claim for building contents? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND cl.amountPaidOnContentsClaim IS NOT NULL AND ST_Y(ST_Centroid(c.geometry)) > 31.0 GROUP BY c.NAME ORDER BY AVG(CAST(cl.amountPaidOnContentsClaim AS DOUBLE)) DESC LIMIT 1;", "elapsed": 0.031, "row_count": 1, "result": [["Claiborne"]]}
{"id": "L1_0072", "question": "How many Louisiana tracts (identified by GEOID starting with 22) with NFIP claims have an estimated limited English proficiency population greater than 500?", "sql": "SELECT COUNT(*) AS num_high_limited_english FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '22%') cl ON s.GEOID = cl.GEOID WHERE s.E_LIMENG > 500;", "elapsed": 0.01, "row_count": 1, "result": [[15]]}
{"id": "L1_0073", "question": "Average non-null coastal flood risk score among Texas tracts (identified by STATEFP 48) that have at least one NFIP claim.", "sql": "SELECT AVG(n.CFLD_RISKS) AS avg_coastal_risk FROM nri n JOIN (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '48') cl ON n.GEOID = cl.GEOID WHERE n.CFLD_RISKS IS NOT NULL;", "elapsed": 0.01, "row_count": 1, "result": [[32.27938111092227]]}
{"id": "L1_0074", "question": "In Miami-Dade, FL (identified by GEOID starting with 12086), how many NFIP claims occurred in tracts where at least 20% of households have no vehicle available?", "sql": "SELECT COUNT(*) AS num_claims FROM claims cl JOIN svi s ON cl.GEOID = s.GEOID WHERE cl.GEOID LIKE '12086%' AND s.EP_NOVEH >= 20;", "elapsed": 0.009, "row_count": 1, "result": [[2951]]}
{"id": "L1_0075", "question": "Average non-null estimated percent of minority population in Texas tracts (identified by STATEFP 48) with NFIP claims since 2015-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='48' AND dateOfLoss >= DATE '2015-01-01') SELECT AVG(s.EP_MINRTY) AS avg_minority_pct FROM svi s JOIN claim_tracts t ON s.GEOID=t.GEOID WHERE s.EP_MINRTY IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[57.01335319609967]]}
{"id": "L1_0076", "question": "Top 10 Louisiana counties (identified by STATEFP 22) with the highest total non-null riverine flood expected building exposure. List their county names.", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND n.RFLD_EXPB IS NOT NULL GROUP BY c.NAME ORDER BY SUM(CAST(n.RFLD_EXPB AS DOUBLE)) DESC LIMIT 10;", "elapsed": 0.006, "row_count": 10, "result": [["Jefferson"], ["East Baton Rouge"], ["Livingston"], ["St. Tammany"], ["Orleans"], ["Ascension"], ["Lafayette"], ["Calcasieu"], ["Terrebonne"], ["Lafourche"]]}
{"id": "L1_0077", "question": "Top 3 Florida tracts (identified by STATEFP 12) with the highest non-null coastal flood expected annual building loss. List their 11-digit GEOIDs.", "sql": "SELECT n.GEOID AS tract_geoid FROM nri n JOIN census_tracts t ON n.GEOID = t.GEOID WHERE t.STATEFP = '12' AND n.CFLD_EALB IS NOT NULL ORDER BY CAST(n.CFLD_EALB AS DOUBLE) DESC LIMIT 3;", "elapsed": 0.005, "row_count": 3, "result": [["12109020708"], ["12127082704"], ["12029970201"]]}
{"id": "L1_0078", "question": "In St. Bernard Parish, LA (identified by GEOID starting with 22087), how many NFIP claims occurred in tracts where at least 35% of individuals have three or more components of social vulnerability?", "sql": "SELECT COUNT(*) AS num_claims FROM claims cl JOIN cre cr ON cl.GEOID = cr.GEOID WHERE cl.GEOID LIKE '22087%' AND cr.PRED3_PE >= 35;", "elapsed": 0.008, "row_count": 1, "result": [[1228]]}
{"id": "L1_0079", "question": "Top 10 Florida counties (identified by STATEFP 12) with the highest Payout amount for building structure damage. List their county names.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '12' GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 10;", "elapsed": 0.031, "row_count": 10, "result": [["Lee"], ["Pinellas"], ["Collier"], ["Hillsborough"], ["Sarasota"], ["Miami-Dade"], ["Monroe"], ["Escambia"], ["Pasco"], ["Manatee"]]}
{"id": "L1_0080", "question": "Top 10 Texas counties (identified by STATEFP 48) with the highest total non-null expected building exposure value for coastal flooding. List their county names.", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' AND n.CFLD_EXPB IS NOT NULL GROUP BY c.NAME ORDER BY SUM(CAST(n.CFLD_EXPB AS DOUBLE)) DESC LIMIT 10;", "elapsed": 0.005, "row_count": 10, "result": [["Harris"], ["Galveston"], ["Brazoria"], ["Orange"], ["Nueces"], ["Cameron"], ["Aransas"], ["Matagorda"], ["Calhoun"], ["Chambers"]]}
{"id": "L1_0081", "question": "The 4th highest Florida county (identified by STATEFP 12) by Payout amount for building structure damage. List the county name.", "sql": "SELECT c.NAME AS county_name FROM claims cl JOIN county c ON LEFT(cl.GEOID, 5) = c.GEOID WHERE c.STATEFP = '12' GROUP BY c.NAME ORDER BY SUM(CAST(cl.amountPaidOnBuildingClaim AS DOUBLE)) DESC LIMIT 1 OFFSET 3;", "elapsed": 0.032, "row_count": 1, "result": [["Hillsborough"]]}
{"id": "L1_0082", "question": "Average CRE percentage of individuals with one to two components of social vulnerability in Florida tracts (identified by STATEFP 12) with NFIP claims since 2015-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '12' AND dateOfLoss >= DATE '2015-01-01') SELECT AVG(cr.PRED12_PE) AS avg_mid_resilience FROM cre cr JOIN claim_tracts t ON cr.GEOID = t.GEOID WHERE cr.PRED12_PE IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[46.72292338709677]]}
{"id": "L1_0083", "question": "Top 3 Duval County, FL (identified by GEOID starting with 12031) tracts with NFIP claims ranked by the largest non-null margin of error for percent of youth population aged 17 and younger. List their 11-digit GEOIDs.", "sql": "SELECT s.GEOID AS tract_geoid FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '12031%') cl ON s.GEOID = cl.GEOID WHERE s.MP_AGE17 IS NOT NULL ORDER BY s.MP_AGE17 DESC LIMIT 3;", "elapsed": 0.007, "row_count": 3, "result": [["12031014702"], ["12031016001"], ["12031015927"]]}
{"id": "L1_0084", "question": "Among East Baton Rouge Parish, LA (identified by GEOID starting with 22033) tracts with NFIP claims, which tract has the smallest non-null tract area in square miles? Return its 11-digit GEOID.", "sql": "SELECT s.GEOID AS tract_geoid FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '22033%') cl ON s.GEOID = cl.GEOID WHERE s.AREA_SQMI IS NOT NULL ORDER BY s.AREA_SQMI ASC LIMIT 1;", "elapsed": 0.007, "row_count": 1, "result": [["22033002200"]]}
{"id": "L1_0085", "question": "How many Texas tracts (identified by GEOID starting with 48) with NFIP claims since 2020-01-01 have an estimated number of households with no vehicle available greater than 200?", "sql": "SELECT COUNT(*) AS num_no_vehicle FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '48%' AND dateOfLoss >= DATE '2020-01-01') cl ON s.GEOID = cl.GEOID WHERE s.E_NOVEH > 200;", "elapsed": 0.01, "row_count": 1, "result": [[229]]}
{"id": "L1_0086", "question": "How many Texas tracts (identified by STATEFP 48) have an estimated number of single-parent households greater than 500?", "sql": "SELECT COUNT(*) AS num_single_parent_high FROM census_tracts t JOIN svi s ON t.GEOID = s.GEOID WHERE t.STATEFP = '48' AND s.E_SNGPNT > 500;", "elapsed": 0.005, "row_count": 1, "result": [[44]]}
{"id": "L1_0087", "question": "Top 5 Louisiana counties (identified by STATEFP 22) ranked by total expected population exposure to coastal flooding. List their county names.", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.STATEFP = '22' AND n.CFLD_EXPP IS NOT NULL GROUP BY c.NAME ORDER BY SUM(CAST(n.CFLD_EXPP AS DOUBLE)) DESC LIMIT 5;", "elapsed": 0.005, "row_count": 5, "result": [["Jefferson"], ["Orleans"], ["East Baton Rouge"], ["Ascension"], ["Calcasieu"]]}
{"id": "L1_0088", "question": "Which Florida county (identified by STATEFP 12) has the fewest hospitals? Return its county name.", "sql": "SELECT c.NAME AS county_name FROM hospitals h JOIN county c ON h.COUNTYFIPS = c.GEOID WHERE c.STATEFP = '12' GROUP BY c.NAME ORDER BY COUNT(*) ASC LIMIT 1;", "elapsed": 0.003, "row_count": 1, "result": [["Gulf"]]}
{"id": "L1_0089", "question": "Top 4 Texas census tracts (identified by STATEFP 48) with the highest non-null riverine expected annual building loss. List their 11-digit GEOIDs.", "sql": "SELECT t.GEOID AS tract_geoid FROM census_tracts t JOIN nri n ON t.GEOID = n.GEOID WHERE t.STATEFP = '48' AND n.RFLD_EALB IS NOT NULL ORDER BY CAST(n.RFLD_EALB AS DOUBLE) DESC LIMIT 4;", "elapsed": 0.005, "row_count": 4, "result": [["48167724000"], ["48167723900"], ["48361020300"], ["48201420900"]]}
{"id": "L1_0090", "question": "How many Texas tracts (identified by GEOID starting with 48) with NFIP claims since 2020-01-01 have an estimated number of households with high housing cost burden greater than 800?", "sql": "SELECT COUNT(*) AS num_high_housing_burden FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '48%' AND dateOfLoss >= DATE '2020-01-01') cl ON s.GEOID = cl.GEOID WHERE s.E_HBURD > 800;", "elapsed": 0.011, "row_count": 1, "result": [[182]]}
{"id": "L1_0091", "question": "Average proportion of water-only census tracts (where WATER_TRACT = 1) among Louisiana tracts (STATEFP 22) that have at least one NFIP claim.", "sql": "SELECT AVG(CASE WHEN cr.WATER_TRACT = 1 THEN 1 ELSE 0 END) AS avg_water_tract_ratio FROM cre cr JOIN (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='22') cl ON cr.GEOID = cl.GEOID;", "elapsed": 0.01, "row_count": 1, "result": [[0.0007668711656441718]]}
{"id": "L1_0092", "question": "Top 5 Texas counties (identified by STATEFP 48) ranked by average CRE percentage of individuals with zero components of social vulnerability. List their county names.", "sql": "SELECT c.NAME AS county_name FROM cre cr JOIN county c ON LEFT(cr.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' GROUP BY c.NAME ORDER BY AVG(cr.PRED0_PE) DESC LIMIT 5;", "elapsed": 0.005, "row_count": 5, "result": [["Kent"], ["Sterling"], ["Hartley"], ["Collin"], ["Denton"]]}
{"id": "L1_0093", "question": "Average non-null riverine flood expected annual land loss among Florida tracts (identified by STATEFP 12) with NFIP claims.", "sql": "SELECT AVG(CAST(n.RFLD_EALA AS DOUBLE)) AS avg_land_loss FROM nri n JOIN (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='12') cl ON n.GEOID = cl.GEOID WHERE n.RFLD_EALA IS NOT NULL;", "elapsed": 0.178, "row_count": 1, "result": [[6730.55884630826]]}
{"id": "L1_0094", "question": "Top 3 Louisiana tracts (identified by STATEFP 22) with the highest non-null percent of elderly population (aged 65 and older). List their 11-digit GEOIDs.", "sql": "SELECT s.GEOID AS tract_geoid FROM svi s JOIN census_tracts t ON s.GEOID = t.GEOID WHERE t.STATEFP = '22' AND s.EP_AGE65 IS NOT NULL ORDER BY s.EP_AGE65 DESC LIMIT 3;", "elapsed": 0.045, "row_count": 3, "result": [["22071003800"], ["22017020600"], ["22017025200"]]}
{"id": "L1_0095", "question": "Average non-null percentage of individuals with three plus components of social vulnerability with three or more vulnerability components in Florida tracts (identified by STATEFP 12) with claims since 2010-01-01.", "sql": "WITH claim_tracts AS (SELECT DISTINCT GEOID FROM claims WHERE STATEFP = '12' AND dateOfLoss >= DATE '2010-01-01') SELECT AVG(cr.PRED3_PE) AS avg_vulnerable_pct FROM cre cr JOIN claim_tracts t ON cr.GEOID = t.GEOID WHERE cr.PRED3_PE IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[22.806010211524434]]}
{"id": "L1_0096", "question": "Top 5 Texas counties (identified by STATEFP 48) with the highest average non-null coastal flood expected population exposure. List their county names.", "sql": "SELECT c.NAME AS county_name FROM nri n JOIN county c ON LEFT(n.GEOID, 5) = c.GEOID WHERE c.STATEFP = '48' AND n.CFLD_EXPPE IS NOT NULL GROUP BY c.NAME ORDER BY AVG(CAST(n.CFLD_EXPPE AS DOUBLE)) DESC LIMIT 5;", "elapsed": 0.006, "row_count": 5, "result": [["Orange"], ["Galveston"], ["Brazoria"], ["Chambers"], ["Matagorda"]]}
{"id": "L1_0097", "question": "How many Orleans Parish, LA (identified by GEOID starting with 22071) tracts with NFIP claims have an estimated minority percentage greater than 70?", "sql": "SELECT COUNT(*) AS num_high_minority FROM svi s JOIN (SELECT DISTINCT GEOID FROM claims WHERE GEOID LIKE '22071%') cl ON s.GEOID = cl.GEOID WHERE s.EP_MINRTY > 70;", "elapsed": 0.007, "row_count": 1, "result": [[97]]}
{"id": "L1_0098", "question": "Top 3 Florida tracts (identified by STATEFP 12) with the highest population universe used in tract-level resilience estimation. List their 11-digit GEOIDs.", "sql": "SELECT cr.GEOID AS tract_geoid FROM cre cr JOIN census_tracts t ON cr.GEOID = t.GEOID WHERE t.STATEFP = '12' AND cr.POPUNI IS NOT NULL ORDER BY cr.POPUNI DESC LIMIT 3;", "elapsed": 0.004, "row_count": 3, "result": [["12011010503"], ["12109020605"], ["12057013916"]]}
{"id": "L1_0099", "question": "Average non-null coastal flood expected building exposure for coastal flooding among Texas tracts (identified by STATEFP 48) that experienced NFIP claims since 2015.", "sql": "SELECT AVG(CAST(n.CFLD_EXPB AS DOUBLE)) AS avg_exposure FROM nri n JOIN (SELECT DISTINCT GEOID FROM claims WHERE STATEFP='48' AND dateOfLoss >= DATE '2015-01-01') cl ON n.GEOID = cl.GEOID WHERE n.CFLD_EXPB IS NOT NULL;", "elapsed": 0.013, "row_count": 1, "result": [[83875366.21823588]]}
{"id": "L1_0100", "question": "Top 5 Louisiana tracts (identified by STATEFP 22) with the highest non-null percent of population without health insurance (EP_UNINSUR). List their 11-digit GEOIDs.", "sql": "SELECT s.GEOID AS tract_geoid FROM svi s JOIN census_tracts t ON s.GEOID = t.GEOID WHERE t.STATEFP = '22' AND s.EP_UNINSUR IS NOT NULL ORDER BY s.EP_UNINSUR DESC LIMIT 5;", "elapsed": 0.005, "row_count": 5, "result": [["22033001103"], ["22073010203"], ["22063040700"], ["22033001104"], ["22071002700"]]}
